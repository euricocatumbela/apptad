{"version":3,"sources":["webpack:///./node_modules/@aws-amplify/ui-components/node_modules/@aws-amplify/core/lib-esm/UniversalStorage/index.js","webpack:///./node_modules/@aws-amplify/ui-components/node_modules/@aws-amplify/auth/lib-esm/Errors.js","webpack:///./node_modules/@aws-amplify/ui-components/node_modules/@aws-amplify/auth/lib-esm/OAuth/urlOpener.js","webpack:///./node_modules/@aws-amplify/ui-components/node_modules/@aws-amplify/auth/lib-esm/OAuth/OAuth.js","webpack:///./node_modules/@aws-amplify/ui-components/node_modules/@aws-amplify/core/lib-esm/Util/StringUtils.js","webpack:///./node_modules/@aws-amplify/ui-components/node_modules/@aws-amplify/auth/lib-esm/OAuth/oauthStorage.js","webpack:///./node_modules/@aws-amplify/ui-components/node_modules/@aws-amplify/auth/lib-esm/Auth.js","webpack:///./node_modules/@aws-amplify/ui-components/node_modules/@aws-amplify/auth/lib-esm/urlListener.js","webpack:///./node_modules/@aws-amplify/ui-components/node_modules/amazon-cognito-identity-js/es/utils/cryptoSecureRandomInt.js","webpack:///./node_modules/@aws-amplify/ui-components/node_modules/@aws-amplify/auth/lib-esm/types/Auth.js","webpack:///./node_modules/@aws-amplify/ui-components/dist/esm-es5/auth-types-78df304e.js","webpack:///./node_modules/@aws-amplify/ui-components/node_modules/amazon-cognito-identity-js/es/AuthenticationDetails.js","webpack:///./node_modules/@aws-amplify/ui-components/node_modules/amazon-cognito-identity-js/es/utils/WordArray.js","webpack:///./node_modules/@aws-amplify/ui-components/node_modules/amazon-cognito-identity-js/es/BigInteger.js","webpack:///./node_modules/@aws-amplify/ui-components/node_modules/amazon-cognito-identity-js/es/AuthenticationHelper.js","webpack:///./node_modules/@aws-amplify/ui-components/node_modules/amazon-cognito-identity-js/es/CognitoJwtToken.js","webpack:///./node_modules/@aws-amplify/ui-components/node_modules/amazon-cognito-identity-js/es/CognitoAccessToken.js","webpack:///./node_modules/@aws-amplify/ui-components/node_modules/amazon-cognito-identity-js/es/CognitoIdToken.js","webpack:///./node_modules/@aws-amplify/ui-components/node_modules/amazon-cognito-identity-js/es/CognitoRefreshToken.js","webpack:///./node_modules/@aws-amplify/ui-components/node_modules/amazon-cognito-identity-js/es/CognitoUserSession.js","webpack:///./node_modules/@aws-amplify/ui-components/node_modules/amazon-cognito-identity-js/es/DateHelper.js","webpack:///./node_modules/@aws-amplify/ui-components/node_modules/amazon-cognito-identity-js/es/CognitoUserAttribute.js","webpack:///./node_modules/@aws-amplify/ui-components/node_modules/amazon-cognito-identity-js/es/StorageHelper.js","webpack:///./node_modules/@aws-amplify/ui-components/node_modules/amazon-cognito-identity-js/es/CognitoUser.js","webpack:///./node_modules/@aws-amplify/ui-components/node_modules/amazon-cognito-identity-js/es/UserAgent.js","webpack:///./node_modules/@aws-amplify/ui-components/node_modules/amazon-cognito-identity-js/es/Client.js","webpack:///./node_modules/@aws-amplify/ui-components/node_modules/amazon-cognito-identity-js/es/CognitoUserPool.js","webpack:///./node_modules/@aws-amplify/ui-components/node_modules/amazon-cognito-identity-js/es/CookieStorage.js"],"names":["isBrowser","UniversalStorage","context","this","cookies","store","window","localStorage","Object","create","req","headers","cookie","assign","getAll","defineProperty","prototype","get","entries","length","enumerable","configurable","clear","_this","Array","from","map","_","i","key","forEach","removeItem","getItem","getLocalItem","hasOwnProperty","call","getUniversalItem","index","keys","removeLocalItem","removeUniversalItem","remove","path","setItem","value","setLocalItem","split","pop","setUniversalItem","set","sameSite","secure","location","hostname","_extendStatics","launchUri","url","windowProxy","open","Promise","resolve","reject","__assign","t","s","n","arguments","p","apply","__awaiter","thisArg","_arguments","P","generator","fulfilled","step","next","e","rejected","result","done","then","__generator","body","f","y","g","label","sent","trys","ops","verb","Symbol","iterator","v","op","TypeError","push","__read","o","m","r","ar","error","AMPLIFY_SYMBOL","for","event","data","message","Hub","dispatch","logger","OAuth","_a","config","cognitoClientId","_b","scopes","_urlOpener","urlOpener","_config","_cognitoClientId","isValidScopes","Error","_scopes","isArray","every","scope","oauthSignIn","responseType","domain","redirectSignIn","clientId","provider","customState","Cognito","generatedState","_generateState","state","char","charCodeAt","toString","padStart","join","sessionStorage","private_key","pkce_key","_generateRandom","code_challenge","_generateChallenge","scopesString","URL","redirect_uri","response_type","client_id","identity_provider","code_challenge_method","k","encodeURIComponent","debug","_handleCodeFlow","currentUrl","code","oAuthTokenEndpoint","code_verifier","oAuthTokenBody","access_token","refresh_token","id_token","query","pairings","reduce","accum","_c","undefined","pathname","clientID","redirectUri","ouath_pkce_key","grant_type","fetch","method","json","accessToken","refreshToken","idToken","_handleImplicitFlow","hash","substr","handleAuthResponse","urlParams","error_description","e_1","entry","acc","_validateState","concat","oauth_state","savedState","returnedState","signOut","oAuthLogoutEndpoint","signout_uri","oauth","redirectSignOut","returnTo","logout_uri","oAuth","chars","Math","round","random","_base64URL","string","replace","size","buffer","Uint8Array","crypto","getRandomValues","_bufferToString","CHARSET","byteLength","__extends","d","b","setPrototypeOf","__proto__","__","constructor","AuthError","_super","type","authErrorMessages","log","name","NoUserPoolError","noConfig","AuthErrorStrings","DEFAULT_MSG","missingAuthConfig","emptyUsername","EMPTY_USERNAME","invalidUsername","INVALID_USERNAME","emptyPassword","EMPTY_PASSWORD","emptyCode","EMPTY_CODE","signUpError","SIGN_UP_ERROR","noMFA","NO_MFA","invalidMFA","INVALID_MFA","emptyChallengeResponse","EMPTY_CHALLENGE","noUserSession","NO_USER_SESSION","default","AuthClass","userPool","user","oAuthFlowInProgress","Credentials","wrapRefreshSessionCallback","callback","configure","currentCredentials","bind","currentUserCredentials","listen","payload","_storage","getModuleName","conf","Parser","parseMobilehubConfig","Auth","userPoolId","userPoolWebClientId","cookieStorage","region","identityPoolId","mandatorySignIn","refreshHandlers","identityPoolRegion","clientMetadata","endpoint","storage","_isValidAuthStorage","ssr","StorageHelper","getStorage","_storageSync","userPoolData","UserPoolId","ClientId","Storage","cognitoHostedUIConfig","awsCognito","cognitoAuthParams","_oAuthHandler","usedResponseUrls_1","JS","browserOrNode","href","isNode","urlListener","_handleAuthResponse","signUp","params","restOfAttrs","_i","rejectNoUserPool","username","password","attributes","validationData","email","phone_number","Name","Value","rejectAuthError","SignUpError","attrs_1","ele","err","EmptyPassword","EmptyUsername","confirmSignUp","options","EmptyCode","createCognitoUser","forceAliasCreation","confirmRegistration","resendSignUp","resendConfirmationCode","signIn","usernameOrSignInOpts","pw","InvalidUsername","warn","authDetails","Username","Password","ValidationData","ClientMetadata","signInWithPassword","signInWithoutPassword","authCallbacks","that","onSuccess","session","cred","currentUser","e_2","currentUserPoolUser","getUsername","onFailure","customChallenge","challengeParam","mfaRequired","challengeName","mfaSetup","newPasswordRequired","userAttributes","requiredAttributes","totpRequired","selectMFAType","pendingSignIn","authenticateUser","setAuthenticationFlowType","initiateAuth","getMFAOptions","res","rej","mfaOptions","getPreferredMFA","bypassCache","getUserData","mfaType","_getMfaTypeFromUserData","ret","preferredMFA","PreferredMfaSetting","mfaList","UserMFASettingList","MFAOptions","_getUserData","setPreferredMFA","mfaMethod","userData","smsMfaSettings","totpMfaSettings","currentMFAType","PreferredMfa","Enabled","InvalidMFA","NoMFA","setUserMfaPreference","disableSMS","disableMFA","enableSMS","enableMFA","setupTOTP","associateSoftwareToken","associateSecretCode","secretCode","verifyTotpToken","challengeAnswer","verifySoftwareToken","confirmSignIn","sendMFACode","e_3","completeNewPassword","completeNewPasswordChallenge","e_4","sendCustomChallengeAnswer","challengeResponses","EmptyChallengeResponse","updateUserAttributes","attributeList","userSession","indexOf","attr","updateAttributes","getUserAttributes","verifiedContact","attrs","attributesToObject","unverified","verified","isOAuthInProgress","timeoutId","setTimeout","hostedUISignCallback","clearTimeout","getCurrentUser","getSession","getAccessToken","decodePayload","includes","UserAttributes","attribute","userAttribute","catch","currentAuthenticatedUser","federatedUser","e_5","federatedInfo","e_6","JSON","parse","token","currentSession","NoUserSession","e_7","refreshFederatedToken","verifyUserAttribute","getAttributeVerificationCode","verifyUserAttributeSubmit","verifyAttribute","verifyCurrentUserAttribute","verifyCurrentUserAttributeSubmit","cognitoIdentitySignOut","opts","e_8","isSignedInHostedUI","global","globalSignOut","oAuthSignOutRedirect","oAuthSignOutRedirectOrReject","oAuthSignOutAndResolve","cleanCachedItems","changePassword","oldPassword","newPassword","forgotPassword","inputVerificationCode","forgotPasswordSubmit","confirmPassword","currentUserInfo","source","userAttrs","credentials","e_10","err_1","getCredSource","id","identityId","federatedSignIn","providerOrOptions","response","loggedInUser","identity_id","expires_at","customProvider","stringify","hasCodeOrError","hasTokenOrError","isCustomStateIncluded","err_2","find","IdToken","RefreshToken","AccessToken","test","getIdToken","setSignInUserSession","history","replaceState","splice","match","String","fromCharCode","parseInt","essentialCredentials","accessKeyId","sessionToken","secretAccessKey","authenticated","obj","Pool","authenticationFlowType","noUserPoolErrorHandler","NoConfig","MissingAuthConfig","Amplify","register","msCrypto","cryptoSecureRandomInt","Uint32Array","randomBytes","readInt32LE","CognitoHostedUIIdentityProvider","AuthErrorTypes","isFederatedSignInOptions","isFederatedSignInOptionsCustom","hasCustomState","isCognitoHostedOpts","isUsernamePasswordOpts","AuthState","MfaOption","ChallengeName","AuthFormField","UsernameAlias","AuthenticationDetails","_ref","AuthParameters","authParameters","_proto","getPassword","getValidationData","getAuthParameters","getClientMetadata","dbits","WordArray","words","sigBytes","nBytes","wordArray","hexChars","bite","hexStringify","BigInteger","a","fromString","nbi","inBrowser","navigator","appName","am","x","w","j","c","xl","xh","l","h","floor","DB","DM","DV","FV","pow","F1","F2","rr","vv","BI_RC","int2char","charAt","intAt","nbv","fromInt","nbits","Montgomery","mp","invDigit","mpl","mph","um","mt2","convert","abs","dlShiftTo","divRemTo","compareTo","ZERO","subTo","revert","copyTo","u0","clamp","drShiftTo","mulTo","multiplyTo","sqrTo","squareTo","mi","sh","max","lShiftTo","bs","cbs","bm","ds","rShiftTo","min","q","pm","pt","ts","ms","nsh","ys","y0","yt","d1","d2","ONE","qd","addTo","negate","km","bitLength","mod","equals","add","subtract","multiply","divide","modPow","z","k1","g2","is1","r2","AuthenticationHelper","PoolName","N","hexHash","smallAValue","generateRandomSmallA","getLargeAValue","infoBits","poolName","getSmallAValue","largeAValue","calculateA","hexRandom","generateRandomString","getRandomPassword","randomPassword","getSaltDevices","SaltToHashDevices","getVerifierDevices","verifierDevices","generateHashDevice","deviceGroupKey","_this2","combinedString","hashedString","padHex","verifierDevicesNotPadded","_this3","A","calculateU","B","UHexHash","buf","str","lib","hashHex","hexStr","computehkdf","ikm","salt","infoBitsWordArray","ikmWordArray","saltWordArray","prk","hmac","slice","getPasswordAuthenticationKey","serverBValue","_this4","UValue","usernamePassword","usernamePasswordHash","xValue","calculateS","sValue","hkdf","_this5","gModPowXN","err2","getNewPasswordRequiredChallengeUserAttributePrefix","bigInt","hashStr","CognitoJwtToken","jwtToken","getJwtToken","getExpiration","exp","getIssuedAt","iat","CognitoAccessToken","_CognitoJwtToken","subClass","superClass","_temp","CognitoIdToken","CognitoRefreshToken","getToken","CognitoUserSession","ClockDrift","clockDrift","calculateClockDrift","getRefreshToken","getClockDrift","Date","isValid","adjusted","monthNames","weekNames","DateHelper","getNowString","now","weekDay","getUTCDay","month","getUTCMonth","day","getUTCDate","hours","getUTCHours","minutes","getUTCMinutes","seconds","getUTCSeconds","getUTCFullYear","CognitoUserAttribute","getValue","setValue","getName","setName","toJSON","dataMemory","MemoryStorage","storageWindow","exception","userAgent","CognitoUser","pool","Session","client","signInUserSession","keyPrefix","getClientId","userDataKey","clearCachedUserData","cacheTokens","getSignInUserSession","getAuthenticationFlowType","USERNAME","clientMetaData","jsonReq","AuthFlow","getUserContextData","UserContextData","request","challengeParameters","ChallengeParameters","getCognitoUserSession","AuthenticationResult","authenticateUserPlainUsernamePassword","authenticateUserDefaultAuth","authenticationHelper","getUserPoolId","dateHelper","deviceKey","DEVICE_KEY","errOnAValue","aValue","SRP_A","CHALLENGE_NAME","USER_ID_FOR_SRP","SRP_B","SALT","getCachedDeviceKeyAndPassword","errOnHkdf","dateNow","SECRET_BLOCK","signatureString","PASSWORD_CLAIM_SECRET_BLOCK","TIMESTAMP","PASSWORD_CLAIM_SIGNATURE","jsonReqResp","ChallengeResponses","respondToAuthChallenge","challenge","challengeCallback","errChallenge","dataChallenge","toLowerCase","clearCachedDeviceKeyAndPassword","errAuthenticate","dataAuthenticate","authenticateUserInternal","PASSWORD","authResult","rawRequiredAttributes","userAttributesPrefix","newDeviceMetadata","NewDeviceMetadata","DeviceGroupKey","DeviceKey","errGenHash","deviceSecretVerifierConfig","Salt","PasswordVerifier","DeviceSecretVerifierConfig","DeviceName","errConfirm","dataConfirm","cacheDeviceKeyAndPassword","UserConfirmationNecessary","getDeviceResponse","requiredAttributeData","finalUserAttributes","NEW_PASSWORD","_this6","errAValue","errHkdf","confirmationCode","ConfirmationCode","ForceAliasCreation","answerChallenge","_this7","ANSWER","_this8","SMS_MFA_CODE","mfaTypeSelection","SOFTWARE_TOKEN_MFA_CODE","oldUserPassword","newUserPassword","PreviousPassword","ProposedPassword","DeliveryMedium","AttributeName","softwareTokenMfaSettings","SMSMfaSettings","SoftwareTokenMfaSettings","deleteUser","_this9","clearCachedUser","_this10","createGetUserRequest","promisifyRequest","refreshSessionIfPossible","_this11","refresh","refreshSession","_this12","getUserDataFromCache","isFetchUserDataAndTokenRequired","fetchUserData","_ref$bypassCache","_this13","cacheUserData","deleteAttributes","UserAttributeNames","idTokenKey","accessTokenKey","refreshTokenKey","clockDriftKey","cachedSession","_this14","wrappedCallback","REFRESH_TOKEN","lastUserKey","deviceKeyKey","authenticationResult","clearCachedTokens","randomPasswordKey","deviceGroupKeyKey","attributeName","Code","getDevice","forgetSpecificDevice","forgetDevice","_this15","setDeviceStatusRemembered","DeviceRememberedStatus","setDeviceStatusNotRemembered","listDevices","limit","paginationToken","requestParams","Limit","PaginationToken","_this16","sendMFASelectionAnswer","_this17","_this18","SecretCode","totpCode","friendlyDeviceName","_this19","UserCode","FriendlyDeviceName","errRespond","dataRespond","UserAgent","appendToCognitoUserAgent","content","_wrapNativeSuper","Class","_cache","Map","fn","Function","has","Wrapper","_construct","_getPrototypeOf","writable","_setPrototypeOf","Parent","args","_isNativeReflectConstruct","Reflect","construct","instance","sham","Proxy","getPrototypeOf","CognitoError","_Error","statusCode","Client","fetchOptions","operation","mode","cache","resp","ok","__type","Message","_error","status","ex","CognitoUserPool","AdvancedSecurityDataCollectionFlag","advancedSecurityDataCollectionFlag","cognitoUser","returnData","userConfirmed","UserConfirmed","userSub","UserSub","codeDeliveryDetails","CodeDeliveryDetails","lastAuthUser","AmazonCognitoAdvancedSecurityData","amazonCognitoAdvancedSecurityDataConst","advancedSecurityData","getData","EncodedData","CookieStorage","expires"],"mappings":"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","file":"b34b391e3452b7d1d5099f93e04a10faf7cbea6c-eb7c2a16b543f33a1d19.js","sourcesContent":["import Cookies from 'universal-cookie';\nimport { browserOrNode } from '../JS';\nvar isBrowser = browserOrNode().isBrowser;\n\nvar UniversalStorage =\n/** @class */\nfunction () {\n  function UniversalStorage(context) {\n    if (context === void 0) {\n      context = {};\n    }\n\n    this.cookies = new Cookies();\n    this.store = isBrowser ? window.localStorage : Object.create(null);\n    this.cookies = context.req ? new Cookies(context.req.headers.cookie) : new Cookies();\n    Object.assign(this.store, this.cookies.getAll());\n  }\n\n  Object.defineProperty(UniversalStorage.prototype, \"length\", {\n    get: function get() {\n      return Object.entries(this.store).length;\n    },\n    enumerable: true,\n    configurable: true\n  });\n\n  UniversalStorage.prototype.clear = function () {\n    var _this = this;\n\n    Array.from(new Array(this.length)).map(function (_, i) {\n      return _this.key(i);\n    }).forEach(function (key) {\n      return _this.removeItem(key);\n    });\n  };\n\n  UniversalStorage.prototype.getItem = function (key) {\n    return this.getLocalItem(key);\n  };\n\n  UniversalStorage.prototype.getLocalItem = function (key) {\n    return Object.prototype.hasOwnProperty.call(this.store, key) ? this.store[key] : null;\n  };\n\n  UniversalStorage.prototype.getUniversalItem = function (key) {\n    return this.cookies.get(key);\n  };\n\n  UniversalStorage.prototype.key = function (index) {\n    return Object.keys(this.store)[index];\n  };\n\n  UniversalStorage.prototype.removeItem = function (key) {\n    this.removeLocalItem(key);\n    this.removeUniversalItem(key);\n  };\n\n  UniversalStorage.prototype.removeLocalItem = function (key) {\n    delete this.store[key];\n  };\n\n  UniversalStorage.prototype.removeUniversalItem = function (key) {\n    this.cookies.remove(key, {\n      path: '/'\n    });\n  };\n\n  UniversalStorage.prototype.setItem = function (key, value) {\n    this.setLocalItem(key, value); // keys take the shape:\n    //  1. `${ProviderPrefix}.${userPoolClientId}.${username}.${tokenType}\n    //  2. `${ProviderPrefix}.${userPoolClientId}.LastAuthUser\n\n    var tokenType = key.split('.').pop();\n\n    switch (tokenType) {\n      // LastAuthUser is needed for computing other key names\n      case 'LastAuthUser': // accessToken is required for CognitoUserSession\n\n      case 'accessToken': // Required for CognitoUserSession\n\n      case 'idToken':\n        this.setUniversalItem(key, value);\n      // userData is used when `Auth.currentAuthenticatedUser({ bypassCache: false })`.\n      // Can be persisted to speed up calls to `Auth.currentAuthenticatedUser()`\n      // case 'userData':\n      // refreshToken isn't shared with the server so that the client handles refreshing\n      // case 'refreshToken':\n      // Ignoring clockDrift on the server for now, but needs testing\n      // case 'clockDrift':\n    }\n  };\n\n  UniversalStorage.prototype.setLocalItem = function (key, value) {\n    this.store[key] = value;\n  };\n\n  UniversalStorage.prototype.setUniversalItem = function (key, value) {\n    this.cookies.set(key, value, {\n      path: '/',\n      // `httpOnly` cannot be set via JavaScript: https://developer.mozilla.org/en-US/docs/Web/HTTP/Cookies#JavaScript_access_using_Document.cookie\n      sameSite: true,\n      // Allow unsecure requests to http://localhost:3000/ when in development.\n      secure: window.location.hostname === 'localhost' ? false : true\n    });\n  };\n\n  return UniversalStorage;\n}();\n\nexport { UniversalStorage };","/*\n * Copyright 2019-2020 Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\"). You may not use this file except in compliance with\n * the License. A copy of the License is located at\n *\n *     http://aws.amazon.com/apache2.0/\n *\n * or in the \"license\" file accompanying this file. This file is distributed on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR\n * CONDITIONS OF ANY KIND, either express or implied. See the License for the specific language governing permissions\n * and limitations under the License.\n */\nvar __extends = this && this.__extends || function () {\n  var _extendStatics = function extendStatics(d, b) {\n    _extendStatics = Object.setPrototypeOf || {\n      __proto__: []\n    } instanceof Array && function (d, b) {\n      d.__proto__ = b;\n    } || function (d, b) {\n      for (var p in b) {\n        if (b.hasOwnProperty(p)) d[p] = b[p];\n      }\n    };\n\n    return _extendStatics(d, b);\n  };\n\n  return function (d, b) {\n    _extendStatics(d, b);\n\n    function __() {\n      this.constructor = d;\n    }\n\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n  };\n}();\n\nimport { ConsoleLogger as Logger } from '@aws-amplify/core';\nimport { AuthErrorStrings } from './common/AuthErrorStrings';\nvar logger = new Logger('AuthError');\n\nvar AuthError =\n/** @class */\nfunction (_super) {\n  __extends(AuthError, _super);\n\n  function AuthError(type) {\n    var _this = this;\n\n    var _a = authErrorMessages[type],\n        message = _a.message,\n        log = _a.log;\n    _this = _super.call(this, message) || this; // Hack for making the custom error class work when transpiled to es5\n    // TODO: Delete the following 2 lines after we change the build target to >= es2015\n\n    _this.constructor = AuthError;\n    Object.setPrototypeOf(_this, AuthError.prototype);\n    _this.name = 'AuthError';\n    _this.log = log || message;\n    logger.error(_this.log);\n    return _this;\n  }\n\n  return AuthError;\n}(Error);\n\nexport { AuthError };\n\nvar NoUserPoolError =\n/** @class */\nfunction (_super) {\n  __extends(NoUserPoolError, _super);\n\n  function NoUserPoolError(type) {\n    var _this = _super.call(this, type) || this; // Hack for making the custom error class work when transpiled to es5\n    // TODO: Delete the following 2 lines after we change the build target to >= es2015\n\n\n    _this.constructor = NoUserPoolError;\n    Object.setPrototypeOf(_this, NoUserPoolError.prototype);\n    _this.name = 'NoUserPoolError';\n    return _this;\n  }\n\n  return NoUserPoolError;\n}(AuthError);\n\nexport { NoUserPoolError };\nexport var authErrorMessages = {\n  noConfig: {\n    message: AuthErrorStrings.DEFAULT_MSG,\n    log: \"\\n            Error: Amplify has not been configured correctly.\\n            This error is typically caused by one of the following scenarios:\\n\\n            1. Make sure you're passing the awsconfig object to Amplify.configure() in your app's entry point\\n                See https://aws-amplify.github.io/docs/js/authentication#configure-your-app for more information\\n            \\n            2. There might be multiple conflicting versions of aws-amplify or amplify packages in your node_modules.\\n                Try deleting your node_modules folder and reinstalling the dependencies with `yarn install`\\n        \"\n  },\n  missingAuthConfig: {\n    message: AuthErrorStrings.DEFAULT_MSG,\n    log: \"\\n            Error: Amplify has not been configured correctly. \\n            The configuration object is missing required auth properties. \\n            Did you run `amplify push` after adding auth via `amplify add auth`?\\n            See https://aws-amplify.github.io/docs/js/authentication#amplify-project-setup for more information\\n        \"\n  },\n  emptyUsername: {\n    message: AuthErrorStrings.EMPTY_USERNAME\n  },\n  // TODO: should include a list of valid sign-in types\n  invalidUsername: {\n    message: AuthErrorStrings.INVALID_USERNAME\n  },\n  emptyPassword: {\n    message: AuthErrorStrings.EMPTY_PASSWORD\n  },\n  emptyCode: {\n    message: AuthErrorStrings.EMPTY_CODE\n  },\n  signUpError: {\n    message: AuthErrorStrings.SIGN_UP_ERROR,\n    log: 'The first parameter should either be non-null string or object'\n  },\n  noMFA: {\n    message: AuthErrorStrings.NO_MFA\n  },\n  invalidMFA: {\n    message: AuthErrorStrings.INVALID_MFA\n  },\n  emptyChallengeResponse: {\n    message: AuthErrorStrings.EMPTY_CHALLENGE\n  },\n  noUserSession: {\n    message: AuthErrorStrings.NO_USER_SESSION\n  },\n  default: {\n    message: AuthErrorStrings.DEFAULT_MSG\n  }\n};","/*\n * Copyright 2017-2017 Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\"). You may not use this file except in compliance with\n * the License. A copy of the License is located at\n *\n *     http://aws.amazon.com/apache2.0/\n *\n * or in the \"license\" file accompanying this file. This file is distributed on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR\n * CONDITIONS OF ANY KIND, either express or implied. See the License for the specific language governing permissions\n * and limitations under the License.\n */\nvar SELF = '_self';\nexport var launchUri = function launchUri(url) {\n  var windowProxy = window.open(url, SELF);\n\n  if (windowProxy) {\n    return Promise.resolve(windowProxy);\n  } else {\n    return Promise.reject();\n  }\n};","/*\n * Copyright 2017-2017 Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\"). You may not use this file except in compliance with\n * the License. A copy of the License is located at\n *\n *     http://aws.amazon.com/apache2.0/\n *\n * or in the \"license\" file accompanying this file. This file is distributed on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR\n * CONDITIONS OF ANY KIND, either express or implied. See the License for the specific language governing permissions\n * and limitations under the License.\n */\nvar __assign = this && this.__assign || function () {\n  __assign = Object.assign || function (t) {\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\n      s = arguments[i];\n\n      for (var p in s) {\n        if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\n      }\n    }\n\n    return t;\n  };\n\n  return __assign.apply(this, arguments);\n};\n\nvar __awaiter = this && this.__awaiter || function (thisArg, _arguments, P, generator) {\n  function adopt(value) {\n    return value instanceof P ? value : new P(function (resolve) {\n      resolve(value);\n    });\n  }\n\n  return new (P || (P = Promise))(function (resolve, reject) {\n    function fulfilled(value) {\n      try {\n        step(generator.next(value));\n      } catch (e) {\n        reject(e);\n      }\n    }\n\n    function rejected(value) {\n      try {\n        step(generator[\"throw\"](value));\n      } catch (e) {\n        reject(e);\n      }\n    }\n\n    function step(result) {\n      result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected);\n    }\n\n    step((generator = generator.apply(thisArg, _arguments || [])).next());\n  });\n};\n\nvar __generator = this && this.__generator || function (thisArg, body) {\n  var _ = {\n    label: 0,\n    sent: function sent() {\n      if (t[0] & 1) throw t[1];\n      return t[1];\n    },\n    trys: [],\n    ops: []\n  },\n      f,\n      y,\n      t,\n      g;\n  return g = {\n    next: verb(0),\n    \"throw\": verb(1),\n    \"return\": verb(2)\n  }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function () {\n    return this;\n  }), g;\n\n  function verb(n) {\n    return function (v) {\n      return step([n, v]);\n    };\n  }\n\n  function step(op) {\n    if (f) throw new TypeError(\"Generator is already executing.\");\n\n    while (_) {\n      try {\n        if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\n        if (y = 0, t) op = [op[0] & 2, t.value];\n\n        switch (op[0]) {\n          case 0:\n          case 1:\n            t = op;\n            break;\n\n          case 4:\n            _.label++;\n            return {\n              value: op[1],\n              done: false\n            };\n\n          case 5:\n            _.label++;\n            y = op[1];\n            op = [0];\n            continue;\n\n          case 7:\n            op = _.ops.pop();\n\n            _.trys.pop();\n\n            continue;\n\n          default:\n            if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) {\n              _ = 0;\n              continue;\n            }\n\n            if (op[0] === 3 && (!t || op[1] > t[0] && op[1] < t[3])) {\n              _.label = op[1];\n              break;\n            }\n\n            if (op[0] === 6 && _.label < t[1]) {\n              _.label = t[1];\n              t = op;\n              break;\n            }\n\n            if (t && _.label < t[2]) {\n              _.label = t[2];\n\n              _.ops.push(op);\n\n              break;\n            }\n\n            if (t[2]) _.ops.pop();\n\n            _.trys.pop();\n\n            continue;\n        }\n\n        op = body.call(thisArg, _);\n      } catch (e) {\n        op = [6, e];\n        y = 0;\n      } finally {\n        f = t = 0;\n      }\n    }\n\n    if (op[0] & 5) throw op[1];\n    return {\n      value: op[0] ? op[1] : void 0,\n      done: true\n    };\n  }\n};\n\nvar __read = this && this.__read || function (o, n) {\n  var m = typeof Symbol === \"function\" && o[Symbol.iterator];\n  if (!m) return o;\n  var i = m.call(o),\n      r,\n      ar = [],\n      e;\n\n  try {\n    while ((n === void 0 || n-- > 0) && !(r = i.next()).done) {\n      ar.push(r.value);\n    }\n  } catch (error) {\n    e = {\n      error: error\n    };\n  } finally {\n    try {\n      if (r && !r.done && (m = i[\"return\"])) m.call(i);\n    } finally {\n      if (e) throw e.error;\n    }\n  }\n\n  return ar;\n};\n\nimport { parse } from 'url'; // Used for OAuth parsing of Cognito Hosted UI\n\nimport { launchUri } from './urlOpener';\nimport * as oAuthStorage from './oauthStorage';\nimport { isCognitoHostedOpts, CognitoHostedUIIdentityProvider } from '../types/Auth';\nimport { ConsoleLogger as Logger, Hub, urlSafeEncode } from '@aws-amplify/core';\nimport sha256 from 'crypto-js/sha256';\nimport Base64 from 'crypto-js/enc-base64';\nvar AMPLIFY_SYMBOL = typeof Symbol !== 'undefined' && typeof Symbol.for === 'function' ? Symbol.for('amplify_default') : '@@amplify_default';\n\nvar dispatchAuthEvent = function dispatchAuthEvent(event, data, message) {\n  Hub.dispatch('auth', {\n    event: event,\n    data: data,\n    message: message\n  }, 'Auth', AMPLIFY_SYMBOL);\n};\n\nvar logger = new Logger('OAuth');\n\nvar OAuth =\n/** @class */\nfunction () {\n  function OAuth(_a) {\n    var config = _a.config,\n        cognitoClientId = _a.cognitoClientId,\n        _b = _a.scopes,\n        scopes = _b === void 0 ? [] : _b;\n    this._urlOpener = config.urlOpener || launchUri;\n    this._config = config;\n    this._cognitoClientId = cognitoClientId;\n    if (!this.isValidScopes(scopes)) throw Error('scopes must be a String Array');\n    this._scopes = scopes;\n  }\n\n  OAuth.prototype.isValidScopes = function (scopes) {\n    return Array.isArray(scopes) && scopes.every(function (scope) {\n      return typeof scope === 'string';\n    });\n  };\n\n  OAuth.prototype.oauthSignIn = function (responseType, domain, redirectSignIn, clientId, provider, customState) {\n    if (responseType === void 0) {\n      responseType = 'code';\n    }\n\n    if (provider === void 0) {\n      provider = CognitoHostedUIIdentityProvider.Cognito;\n    }\n\n    var generatedState = this._generateState(32);\n    /* encodeURIComponent is not URL safe, use urlSafeEncode instead. Cognito\n    single-encodes/decodes url on first sign in and double-encodes/decodes url\n    when user already signed in. Using encodeURIComponent, Base32, Base64 add\n    characters % or = which on further encoding becomes unsafe. '=' create issue\n    for parsing query params.\n    Refer: https://github.com/aws-amplify/amplify-js/issues/5218 */\n\n\n    var state = customState ? generatedState + \"-\" + urlSafeEncode(customState) : generatedState;\n    oAuthStorage.setState(state);\n\n    var pkce_key = this._generateRandom(128);\n\n    oAuthStorage.setPKCE(pkce_key);\n\n    var code_challenge = this._generateChallenge(pkce_key);\n\n    var code_challenge_method = 'S256';\n\n    var scopesString = this._scopes.join(' ');\n\n    var queryString = Object.entries(__assign(__assign({\n      redirect_uri: redirectSignIn,\n      response_type: responseType,\n      client_id: clientId,\n      identity_provider: provider,\n      scope: scopesString,\n      state: state\n    }, responseType === 'code' ? {\n      code_challenge: code_challenge\n    } : {}), responseType === 'code' ? {\n      code_challenge_method: code_challenge_method\n    } : {})).map(function (_a) {\n      var _b = __read(_a, 2),\n          k = _b[0],\n          v = _b[1];\n\n      return encodeURIComponent(k) + \"=\" + encodeURIComponent(v);\n    }).join('&');\n    var URL = \"https://\" + domain + \"/oauth2/authorize?\" + queryString;\n    logger.debug(\"Redirecting to \" + URL);\n\n    this._urlOpener(URL, redirectSignIn);\n  };\n\n  OAuth.prototype._handleCodeFlow = function (currentUrl) {\n    return __awaiter(this, void 0, void 0, function () {\n      var code, oAuthTokenEndpoint, client_id, redirect_uri, code_verifier, oAuthTokenBody, body, _a, access_token, refresh_token, id_token, error;\n\n      return __generator(this, function (_b) {\n        switch (_b.label) {\n          case 0:\n            code = (parse(currentUrl).query || '').split('&').map(function (pairings) {\n              return pairings.split('=');\n            }).reduce(function (accum, _a) {\n              var _b;\n\n              var _c = __read(_a, 2),\n                  k = _c[0],\n                  v = _c[1];\n\n              return __assign(__assign({}, accum), (_b = {}, _b[k] = v, _b));\n            }, {\n              code: undefined\n            }).code;\n\n            if (!code || parse(currentUrl).pathname !== parse(this._config.redirectSignIn).pathname) {\n              return [2\n              /*return*/\n              ];\n            }\n\n            oAuthTokenEndpoint = 'https://' + this._config.domain + '/oauth2/token';\n            dispatchAuthEvent('codeFlow', {}, \"Retrieving tokens from \" + oAuthTokenEndpoint);\n            client_id = isCognitoHostedOpts(this._config) ? this._cognitoClientId : this._config.clientID;\n            redirect_uri = isCognitoHostedOpts(this._config) ? this._config.redirectSignIn : this._config.redirectUri;\n            code_verifier = oAuthStorage.getPKCE();\n            oAuthTokenBody = __assign({\n              grant_type: 'authorization_code',\n              code: code,\n              client_id: client_id,\n              redirect_uri: redirect_uri\n            }, code_verifier ? {\n              code_verifier: code_verifier\n            } : {});\n            logger.debug(\"Calling token endpoint: \" + oAuthTokenEndpoint + \" with\", oAuthTokenBody);\n            body = Object.entries(oAuthTokenBody).map(function (_a) {\n              var _b = __read(_a, 2),\n                  k = _b[0],\n                  v = _b[1];\n\n              return encodeURIComponent(k) + \"=\" + encodeURIComponent(v);\n            }).join('&');\n            return [4\n            /*yield*/\n            , fetch(oAuthTokenEndpoint, {\n              method: 'POST',\n              headers: {\n                'Content-Type': 'application/x-www-form-urlencoded'\n              },\n              body: body\n            })];\n\n          case 1:\n            return [4\n            /*yield*/\n            , _b.sent().json()];\n\n          case 2:\n            _a = _b.sent(), access_token = _a.access_token, refresh_token = _a.refresh_token, id_token = _a.id_token, error = _a.error;\n\n            if (error) {\n              throw new Error(error);\n            }\n\n            return [2\n            /*return*/\n            , {\n              accessToken: access_token,\n              refreshToken: refresh_token,\n              idToken: id_token\n            }];\n        }\n      });\n    });\n  };\n\n  OAuth.prototype._handleImplicitFlow = function (currentUrl) {\n    return __awaiter(this, void 0, void 0, function () {\n      var _a, id_token, access_token;\n\n      return __generator(this, function (_b) {\n        _a = (parse(currentUrl).hash || '#').substr(1) // Remove # from returned code\n        .split('&').map(function (pairings) {\n          return pairings.split('=');\n        }).reduce(function (accum, _a) {\n          var _b;\n\n          var _c = __read(_a, 2),\n              k = _c[0],\n              v = _c[1];\n\n          return __assign(__assign({}, accum), (_b = {}, _b[k] = v, _b));\n        }, {\n          id_token: undefined,\n          access_token: undefined\n        }), id_token = _a.id_token, access_token = _a.access_token;\n        dispatchAuthEvent('implicitFlow', {}, \"Got tokens from \" + currentUrl);\n        logger.debug(\"Retrieving implicit tokens from \" + currentUrl + \" with\");\n        return [2\n        /*return*/\n        , {\n          accessToken: access_token,\n          idToken: id_token,\n          refreshToken: null\n        }];\n      });\n    });\n  };\n\n  OAuth.prototype.handleAuthResponse = function (currentUrl) {\n    return __awaiter(this, void 0, void 0, function () {\n      var urlParams, error, error_description, state, _a, _b, e_1;\n\n      return __generator(this, function (_c) {\n        switch (_c.label) {\n          case 0:\n            _c.trys.push([0, 5,, 6]);\n\n            urlParams = currentUrl ? __assign(__assign({}, (parse(currentUrl).hash || '#').substr(1).split('&').map(function (entry) {\n              return entry.split('=');\n            }).reduce(function (acc, _a) {\n              var _b = __read(_a, 2),\n                  k = _b[0],\n                  v = _b[1];\n\n              return acc[k] = v, acc;\n            }, {})), (parse(currentUrl).query || '').split('&').map(function (entry) {\n              return entry.split('=');\n            }).reduce(function (acc, _a) {\n              var _b = __read(_a, 2),\n                  k = _b[0],\n                  v = _b[1];\n\n              return acc[k] = v, acc;\n            }, {})) : {};\n            error = urlParams.error, error_description = urlParams.error_description;\n\n            if (error) {\n              throw new Error(error_description);\n            }\n\n            state = this._validateState(urlParams);\n            logger.debug(\"Starting \" + this._config.responseType + \" flow with \" + currentUrl);\n            if (!(this._config.responseType === 'code')) return [3\n            /*break*/\n            , 2];\n            _a = [{}];\n            return [4\n            /*yield*/\n            , this._handleCodeFlow(currentUrl)];\n\n          case 1:\n            return [2\n            /*return*/\n            , __assign.apply(void 0, [__assign.apply(void 0, _a.concat([_c.sent()])), {\n              state: state\n            }])];\n\n          case 2:\n            _b = [{}];\n            return [4\n            /*yield*/\n            , this._handleImplicitFlow(currentUrl)];\n\n          case 3:\n            return [2\n            /*return*/\n            , __assign.apply(void 0, [__assign.apply(void 0, _b.concat([_c.sent()])), {\n              state: state\n            }])];\n\n          case 4:\n            return [3\n            /*break*/\n            , 6];\n\n          case 5:\n            e_1 = _c.sent();\n            logger.error(\"Error handling auth response.\", e_1);\n            throw e_1;\n\n          case 6:\n            return [2\n            /*return*/\n            ];\n        }\n      });\n    });\n  };\n\n  OAuth.prototype._validateState = function (urlParams) {\n    if (!urlParams) {\n      return;\n    }\n\n    var savedState = oAuthStorage.getState();\n    var returnedState = urlParams.state; // This is because savedState only exists if the flow was initiated by Amplify\n\n    if (savedState && savedState !== returnedState) {\n      throw new Error('Invalid state in OAuth flow');\n    }\n\n    return returnedState;\n  };\n\n  OAuth.prototype.signOut = function () {\n    return __awaiter(this, void 0, void 0, function () {\n      var oAuthLogoutEndpoint, client_id, signout_uri;\n      return __generator(this, function (_a) {\n        oAuthLogoutEndpoint = 'https://' + this._config.domain + '/logout?';\n        client_id = isCognitoHostedOpts(this._config) ? this._cognitoClientId : this._config.oauth.clientID;\n        signout_uri = isCognitoHostedOpts(this._config) ? this._config.redirectSignOut : this._config.returnTo;\n        oAuthLogoutEndpoint += Object.entries({\n          client_id: client_id,\n          logout_uri: encodeURIComponent(signout_uri)\n        }).map(function (_a) {\n          var _b = __read(_a, 2),\n              k = _b[0],\n              v = _b[1];\n\n          return k + \"=\" + v;\n        }).join('&');\n        dispatchAuthEvent('oAuthSignOut', {\n          oAuth: 'signOut'\n        }, \"Signing out from \" + oAuthLogoutEndpoint);\n        logger.debug(\"Signing out from \" + oAuthLogoutEndpoint);\n        return [2\n        /*return*/\n        , this._urlOpener(oAuthLogoutEndpoint)];\n      });\n    });\n  };\n\n  OAuth.prototype._generateState = function (length) {\n    var result = '';\n    var i = length;\n    var chars = '0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ';\n\n    for (; i > 0; --i) {\n      result += chars[Math.round(Math.random() * (chars.length - 1))];\n    }\n\n    return result;\n  };\n\n  OAuth.prototype._generateChallenge = function (code) {\n    return this._base64URL(sha256(code));\n  };\n\n  OAuth.prototype._base64URL = function (string) {\n    return string.toString(Base64).replace(/=/g, '').replace(/\\+/g, '-').replace(/\\//g, '_');\n  };\n\n  OAuth.prototype._generateRandom = function (size) {\n    var CHARSET = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~';\n    var buffer = new Uint8Array(size);\n\n    if (typeof window !== 'undefined' && !!window.crypto) {\n      window.crypto.getRandomValues(buffer);\n    } else {\n      for (var i = 0; i < size; i += 1) {\n        buffer[i] = Math.random() * CHARSET.length | 0;\n      }\n    }\n\n    return this._bufferToString(buffer);\n  };\n\n  OAuth.prototype._bufferToString = function (buffer) {\n    var CHARSET = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789';\n    var state = [];\n\n    for (var i = 0; i < buffer.byteLength; i += 1) {\n      var index = buffer[i] % CHARSET.length;\n      state.push(CHARSET[index]);\n    }\n\n    return state.join('');\n  };\n\n  return OAuth;\n}();\n\nexport default OAuth;","export function urlSafeEncode(str) {\n  return str.split('').map(function (char) {\n    return char.charCodeAt(0).toString(16).padStart(2, '0');\n  }).join('');\n}\nexport function urlSafeDecode(hex) {\n  return hex.match(/.{2}/g).map(function (char) {\n    return String.fromCharCode(parseInt(char, 16));\n  }).join('');\n}","/*\n * Copyright 2017-2017 Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\"). You may not use this file except in compliance with\n * the License. A copy of the License is located at\n *\n *     http://aws.amazon.com/apache2.0/\n *\n * or in the \"license\" file accompanying this file. This file is distributed on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR\n * CONDITIONS OF ANY KIND, either express or implied. See the License for the specific language governing permissions\n * and limitations under the License.\n */\nexport var setState = function setState(state) {\n  window.sessionStorage.setItem('oauth_state', state);\n};\nexport var getState = function getState() {\n  var oauth_state = window.sessionStorage.getItem('oauth_state');\n  window.sessionStorage.removeItem('oauth_state');\n  return oauth_state;\n};\nexport var setPKCE = function setPKCE(private_key) {\n  window.sessionStorage.setItem('ouath_pkce_key', private_key);\n};\nexport var getPKCE = function getPKCE() {\n  var ouath_pkce_key = window.sessionStorage.getItem('ouath_pkce_key');\n  window.sessionStorage.removeItem('ouath_pkce_key');\n  return ouath_pkce_key;\n};\nexport var clearAll = function clearAll() {\n  window.sessionStorage.removeItem('ouath_pkce_key');\n  window.sessionStorage.removeItem('oauth_state');\n};","/*\n * Copyright 2017-2019 Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\"). You may not use this file except in compliance with\n * the License. A copy of the License is located at\n *\n *\t http://aws.amazon.com/apache2.0/\n *\n * or in the \"license\" file accompanying this file. This file is distributed on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR\n * CONDITIONS OF ANY KIND, either express or implied. See the License for the specific language governing permissions\n * and limitations under the License.\n */\nvar __assign = this && this.__assign || function () {\n  __assign = Object.assign || function (t) {\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\n      s = arguments[i];\n\n      for (var p in s) {\n        if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\n      }\n    }\n\n    return t;\n  };\n\n  return __assign.apply(this, arguments);\n};\n\nvar __awaiter = this && this.__awaiter || function (thisArg, _arguments, P, generator) {\n  function adopt(value) {\n    return value instanceof P ? value : new P(function (resolve) {\n      resolve(value);\n    });\n  }\n\n  return new (P || (P = Promise))(function (resolve, reject) {\n    function fulfilled(value) {\n      try {\n        step(generator.next(value));\n      } catch (e) {\n        reject(e);\n      }\n    }\n\n    function rejected(value) {\n      try {\n        step(generator[\"throw\"](value));\n      } catch (e) {\n        reject(e);\n      }\n    }\n\n    function step(result) {\n      result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected);\n    }\n\n    step((generator = generator.apply(thisArg, _arguments || [])).next());\n  });\n};\n\nvar __generator = this && this.__generator || function (thisArg, body) {\n  var _ = {\n    label: 0,\n    sent: function sent() {\n      if (t[0] & 1) throw t[1];\n      return t[1];\n    },\n    trys: [],\n    ops: []\n  },\n      f,\n      y,\n      t,\n      g;\n  return g = {\n    next: verb(0),\n    \"throw\": verb(1),\n    \"return\": verb(2)\n  }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function () {\n    return this;\n  }), g;\n\n  function verb(n) {\n    return function (v) {\n      return step([n, v]);\n    };\n  }\n\n  function step(op) {\n    if (f) throw new TypeError(\"Generator is already executing.\");\n\n    while (_) {\n      try {\n        if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\n        if (y = 0, t) op = [op[0] & 2, t.value];\n\n        switch (op[0]) {\n          case 0:\n          case 1:\n            t = op;\n            break;\n\n          case 4:\n            _.label++;\n            return {\n              value: op[1],\n              done: false\n            };\n\n          case 5:\n            _.label++;\n            y = op[1];\n            op = [0];\n            continue;\n\n          case 7:\n            op = _.ops.pop();\n\n            _.trys.pop();\n\n            continue;\n\n          default:\n            if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) {\n              _ = 0;\n              continue;\n            }\n\n            if (op[0] === 3 && (!t || op[1] > t[0] && op[1] < t[3])) {\n              _.label = op[1];\n              break;\n            }\n\n            if (op[0] === 6 && _.label < t[1]) {\n              _.label = t[1];\n              t = op;\n              break;\n            }\n\n            if (t && _.label < t[2]) {\n              _.label = t[2];\n\n              _.ops.push(op);\n\n              break;\n            }\n\n            if (t[2]) _.ops.pop();\n\n            _.trys.pop();\n\n            continue;\n        }\n\n        op = body.call(thisArg, _);\n      } catch (e) {\n        op = [6, e];\n        y = 0;\n      } finally {\n        f = t = 0;\n      }\n    }\n\n    if (op[0] & 5) throw op[1];\n    return {\n      value: op[0] ? op[1] : void 0,\n      done: true\n    };\n  }\n};\n\nvar __read = this && this.__read || function (o, n) {\n  var m = typeof Symbol === \"function\" && o[Symbol.iterator];\n  if (!m) return o;\n  var i = m.call(o),\n      r,\n      ar = [],\n      e;\n\n  try {\n    while ((n === void 0 || n-- > 0) && !(r = i.next()).done) {\n      ar.push(r.value);\n    }\n  } catch (error) {\n    e = {\n      error: error\n    };\n  } finally {\n    try {\n      if (r && !r.done && (m = i[\"return\"])) m.call(i);\n    } finally {\n      if (e) throw e.error;\n    }\n  }\n\n  return ar;\n};\n\nimport { isUsernamePasswordOpts, isCognitoHostedOpts, isFederatedSignInOptions, isFederatedSignInOptionsCustom, hasCustomState } from './types';\nimport { Amplify, ConsoleLogger as Logger, Credentials, Hub, StorageHelper, Parser, JS, UniversalStorage, urlSafeDecode } from '@aws-amplify/core';\nimport { CookieStorage, CognitoUserPool, AuthenticationDetails, CognitoUser, CognitoUserSession, CognitoUserAttribute, CognitoIdToken, CognitoRefreshToken, CognitoAccessToken } from 'amazon-cognito-identity-js';\nimport { parse } from 'url';\nimport OAuth from './OAuth/OAuth';\nimport { default as urlListener } from './urlListener';\nimport { AuthError, NoUserPoolError } from './Errors';\nimport { AuthErrorTypes, CognitoHostedUIIdentityProvider } from './types/Auth';\nvar logger = new Logger('AuthClass');\nvar USER_ADMIN_SCOPE = 'aws.cognito.signin.user.admin'; // 10 sec, following this guide https://www.nngroup.com/articles/response-times-3-important-limits/\n\nvar OAUTH_FLOW_MS_TIMEOUT = 10 * 1000;\nvar AMPLIFY_SYMBOL = typeof Symbol !== 'undefined' && typeof Symbol.for === 'function' ? Symbol.for('amplify_default') : '@@amplify_default';\n\nvar dispatchAuthEvent = function dispatchAuthEvent(event, data, message) {\n  Hub.dispatch('auth', {\n    event: event,\n    data: data,\n    message: message\n  }, 'Auth', AMPLIFY_SYMBOL);\n};\n/**\n * Provide authentication steps\n */\n\n\nvar AuthClass =\n/** @class */\nfunction () {\n  /**\n   * Initialize Auth with AWS configurations\n   * @param {Object} config - Configuration of the Auth\n   */\n  function AuthClass(config) {\n    var _this = this;\n\n    this.userPool = null;\n    this.user = null;\n    this.oAuthFlowInProgress = false;\n    this.Credentials = Credentials;\n\n    this.wrapRefreshSessionCallback = function (callback) {\n      var wrapped = function wrapped(error, data) {\n        if (data) {\n          dispatchAuthEvent('tokenRefresh', undefined, \"New token retrieved\");\n        } else {\n          dispatchAuthEvent('tokenRefresh_failure', error, \"Failed to retrieve new token\");\n        }\n\n        return callback(error, data);\n      };\n\n      return wrapped;\n    }; // prettier-ignore\n\n\n    this.configure(config);\n    this.currentCredentials = this.currentCredentials.bind(this);\n    this.currentUserCredentials = this.currentUserCredentials.bind(this);\n    Hub.listen('auth', function (_a) {\n      var payload = _a.payload;\n      var event = payload.event;\n\n      switch (event) {\n        case 'signIn':\n          _this._storage.setItem('amplify-signin-with-hostedUI', 'false');\n\n          break;\n\n        case 'signOut':\n          _this._storage.removeItem('amplify-signin-with-hostedUI');\n\n          break;\n\n        case 'cognitoHostedUI':\n          _this._storage.setItem('amplify-signin-with-hostedUI', 'true');\n\n          break;\n      }\n    });\n  }\n\n  AuthClass.prototype.getModuleName = function () {\n    return 'Auth';\n  };\n\n  AuthClass.prototype.configure = function (config) {\n    var _this = this;\n\n    if (!config) return this._config || {};\n    logger.debug('configure Auth');\n    var conf = Object.assign({}, this._config, Parser.parseMobilehubConfig(config).Auth, config);\n    this._config = conf;\n    var _a = this._config,\n        userPoolId = _a.userPoolId,\n        userPoolWebClientId = _a.userPoolWebClientId,\n        cookieStorage = _a.cookieStorage,\n        oauth = _a.oauth,\n        region = _a.region,\n        identityPoolId = _a.identityPoolId,\n        mandatorySignIn = _a.mandatorySignIn,\n        refreshHandlers = _a.refreshHandlers,\n        identityPoolRegion = _a.identityPoolRegion,\n        clientMetadata = _a.clientMetadata,\n        endpoint = _a.endpoint;\n\n    if (!this._config.storage) {\n      // backward compatability\n      if (cookieStorage) this._storage = new CookieStorage(cookieStorage);else {\n        this._storage = config.ssr ? new UniversalStorage() : new StorageHelper().getStorage();\n      }\n    } else {\n      if (!this._isValidAuthStorage(this._config.storage)) {\n        logger.error('The storage in the Auth config is not valid!');\n        throw new Error('Empty storage object');\n      }\n\n      this._storage = this._config.storage;\n    }\n\n    this._storageSync = Promise.resolve();\n\n    if (typeof this._storage['sync'] === 'function') {\n      this._storageSync = this._storage['sync']();\n    }\n\n    if (userPoolId) {\n      var userPoolData = {\n        UserPoolId: userPoolId,\n        ClientId: userPoolWebClientId,\n        endpoint: endpoint\n      };\n      userPoolData.Storage = this._storage;\n      this.userPool = new CognitoUserPool(userPoolData, this.wrapRefreshSessionCallback);\n    }\n\n    this.Credentials.configure({\n      mandatorySignIn: mandatorySignIn,\n      region: identityPoolRegion || region,\n      userPoolId: userPoolId,\n      identityPoolId: identityPoolId,\n      refreshHandlers: refreshHandlers,\n      storage: this._storage\n    }); // initiailize cognitoauth client if hosted ui options provided\n    // to keep backward compatibility:\n\n    var cognitoHostedUIConfig = oauth ? isCognitoHostedOpts(this._config.oauth) ? oauth : oauth.awsCognito : undefined;\n\n    if (cognitoHostedUIConfig) {\n      var cognitoAuthParams = Object.assign({\n        cognitoClientId: userPoolWebClientId,\n        UserPoolId: userPoolId,\n        domain: cognitoHostedUIConfig['domain'],\n        scopes: cognitoHostedUIConfig['scope'],\n        redirectSignIn: cognitoHostedUIConfig['redirectSignIn'],\n        redirectSignOut: cognitoHostedUIConfig['redirectSignOut'],\n        responseType: cognitoHostedUIConfig['responseType'],\n        Storage: this._storage,\n        urlOpener: cognitoHostedUIConfig['urlOpener'],\n        clientMetadata: clientMetadata\n      }, cognitoHostedUIConfig['options']);\n      this._oAuthHandler = new OAuth({\n        scopes: cognitoAuthParams.scopes,\n        config: cognitoAuthParams,\n        cognitoClientId: cognitoAuthParams.cognitoClientId\n      }); // **NOTE** - Remove this in a future major release as it is a breaking change\n      // Prevents _handleAuthResponse from being called multiple times in Expo\n      // See https://github.com/aws-amplify/amplify-js/issues/4388\n\n      var usedResponseUrls_1 = {};\n      urlListener(function (_a) {\n        var url = _a.url;\n\n        if (usedResponseUrls_1[url]) {\n          return;\n        }\n\n        usedResponseUrls_1[url] = true;\n\n        _this._handleAuthResponse(url);\n      });\n    }\n\n    dispatchAuthEvent('configured', null, \"The Auth category has been configured successfully\");\n    return this._config;\n  };\n  /**\n   * Sign up with username, password and other attributes like phone, email\n   * @param {String | object} params - The user attributes used for signin\n   * @param {String[]} restOfAttrs - for the backward compatability\n   * @return - A promise resolves callback data if success\n   */\n\n\n  AuthClass.prototype.signUp = function (params) {\n    var _this = this;\n\n    var restOfAttrs = [];\n\n    for (var _i = 1; _i < arguments.length; _i++) {\n      restOfAttrs[_i - 1] = arguments[_i];\n    }\n\n    if (!this.userPool) {\n      return this.rejectNoUserPool();\n    }\n\n    var username = null;\n    var password = null;\n    var attributes = [];\n    var validationData = null;\n    var clientMetadata;\n\n    if (params && typeof params === 'string') {\n      username = params;\n      password = restOfAttrs ? restOfAttrs[0] : null;\n      var email = restOfAttrs ? restOfAttrs[1] : null;\n      var phone_number = restOfAttrs ? restOfAttrs[2] : null;\n      if (email) attributes.push({\n        Name: 'email',\n        Value: email\n      });\n      if (phone_number) attributes.push({\n        Name: 'phone_number',\n        Value: phone_number\n      });\n    } else if (params && typeof params === 'object') {\n      username = params['username'];\n      password = params['password'];\n\n      if (params && params.clientMetadata) {\n        clientMetadata = params.clientMetadata;\n      } else if (this._config.clientMetadata) {\n        clientMetadata = this._config.clientMetadata;\n      }\n\n      var attrs_1 = params['attributes'];\n\n      if (attrs_1) {\n        Object.keys(attrs_1).map(function (key) {\n          var ele = {\n            Name: key,\n            Value: attrs_1[key]\n          };\n          attributes.push(ele);\n        });\n      }\n\n      validationData = params['validationData'] || null;\n    } else {\n      return this.rejectAuthError(AuthErrorTypes.SignUpError);\n    }\n\n    if (!username) {\n      return this.rejectAuthError(AuthErrorTypes.EmptyUsername);\n    }\n\n    if (!password) {\n      return this.rejectAuthError(AuthErrorTypes.EmptyPassword);\n    }\n\n    logger.debug('signUp attrs:', attributes);\n    logger.debug('signUp validation data:', validationData);\n    return new Promise(function (resolve, reject) {\n      _this.userPool.signUp(username, password, attributes, validationData, function (err, data) {\n        if (err) {\n          dispatchAuthEvent('signUp_failure', err, username + \" failed to signup\");\n          reject(err);\n        } else {\n          dispatchAuthEvent('signUp', data, username + \" has signed up successfully\");\n          resolve(data);\n        }\n      }, clientMetadata);\n    });\n  };\n  /**\n   * Send the verfication code to confirm sign up\n   * @param {String} username - The username to be confirmed\n   * @param {String} code - The verification code\n   * @param {ConfirmSignUpOptions} options - other options for confirm signup\n   * @return - A promise resolves callback data if success\n   */\n\n\n  AuthClass.prototype.confirmSignUp = function (username, code, options) {\n    if (!this.userPool) {\n      return this.rejectNoUserPool();\n    }\n\n    if (!username) {\n      return this.rejectAuthError(AuthErrorTypes.EmptyUsername);\n    }\n\n    if (!code) {\n      return this.rejectAuthError(AuthErrorTypes.EmptyCode);\n    }\n\n    var user = this.createCognitoUser(username);\n    var forceAliasCreation = options && typeof options.forceAliasCreation === 'boolean' ? options.forceAliasCreation : true;\n    var clientMetadata;\n\n    if (options && options.clientMetadata) {\n      clientMetadata = options.clientMetadata;\n    } else if (this._config.clientMetadata) {\n      clientMetadata = this._config.clientMetadata;\n    }\n\n    return new Promise(function (resolve, reject) {\n      user.confirmRegistration(code, forceAliasCreation, function (err, data) {\n        if (err) {\n          reject(err);\n        } else {\n          resolve(data);\n        }\n      }, clientMetadata);\n    });\n  };\n  /**\n   * Resend the verification code\n   * @param {String} username - The username to be confirmed\n   * @param {ClientMetadata} clientMetadata - Metadata to be passed to Cognito Lambda triggers\n   * @return - A promise resolves code delivery details if successful\n   */\n\n\n  AuthClass.prototype.resendSignUp = function (username, clientMetadata) {\n    if (clientMetadata === void 0) {\n      clientMetadata = this._config.clientMetadata;\n    }\n\n    if (!this.userPool) {\n      return this.rejectNoUserPool();\n    }\n\n    if (!username) {\n      return this.rejectAuthError(AuthErrorTypes.EmptyUsername);\n    }\n\n    var user = this.createCognitoUser(username);\n    return new Promise(function (resolve, reject) {\n      user.resendConfirmationCode(function (err, data) {\n        if (err) {\n          reject(err);\n        } else {\n          resolve(data);\n        }\n      }, clientMetadata);\n    });\n  };\n  /**\n   * Sign in\n   * @param {String | SignInOpts} usernameOrSignInOpts - The username to be signed in or the sign in options\n   * @param {String} password - The password of the username\n   * @return - A promise resolves the CognitoUser\n   */\n\n\n  AuthClass.prototype.signIn = function (usernameOrSignInOpts, pw, clientMetadata) {\n    if (clientMetadata === void 0) {\n      clientMetadata = this._config.clientMetadata;\n    }\n\n    if (!this.userPool) {\n      return this.rejectNoUserPool();\n    }\n\n    var username = null;\n    var password = null;\n    var validationData = {}; // for backward compatibility\n\n    if (typeof usernameOrSignInOpts === 'string') {\n      username = usernameOrSignInOpts;\n      password = pw;\n    } else if (isUsernamePasswordOpts(usernameOrSignInOpts)) {\n      if (typeof pw !== 'undefined') {\n        logger.warn('The password should be defined under the first parameter object!');\n      }\n\n      username = usernameOrSignInOpts.username;\n      password = usernameOrSignInOpts.password;\n      validationData = usernameOrSignInOpts.validationData;\n    } else {\n      return this.rejectAuthError(AuthErrorTypes.InvalidUsername);\n    }\n\n    if (!username) {\n      return this.rejectAuthError(AuthErrorTypes.EmptyUsername);\n    }\n\n    var authDetails = new AuthenticationDetails({\n      Username: username,\n      Password: password,\n      ValidationData: validationData,\n      ClientMetadata: clientMetadata\n    });\n\n    if (password) {\n      return this.signInWithPassword(authDetails);\n    } else {\n      return this.signInWithoutPassword(authDetails);\n    }\n  };\n  /**\n   * Return an object with the authentication callbacks\n   * @param {CognitoUser} user - the cognito user object\n   * @param {} resolve - function called when resolving the current step\n   * @param {} reject - function called when rejecting the current step\n   * @return - an object with the callback methods for user authentication\n   */\n\n\n  AuthClass.prototype.authCallbacks = function (user, resolve, reject) {\n    var _this = this;\n\n    var that = this;\n    return {\n      onSuccess: function onSuccess(session) {\n        return __awaiter(_this, void 0, void 0, function () {\n          var cred, e_1, currentUser, e_2;\n          return __generator(this, function (_a) {\n            switch (_a.label) {\n              case 0:\n                logger.debug(session);\n                delete user['challengeName'];\n                delete user['challengeParam'];\n                _a.label = 1;\n\n              case 1:\n                _a.trys.push([1, 4, 5, 9]);\n\n                return [4\n                /*yield*/\n                , this.Credentials.clear()];\n\n              case 2:\n                _a.sent();\n\n                return [4\n                /*yield*/\n                , this.Credentials.set(session, 'session')];\n\n              case 3:\n                cred = _a.sent();\n                logger.debug('succeed to get cognito credentials', cred);\n                return [3\n                /*break*/\n                , 9];\n\n              case 4:\n                e_1 = _a.sent();\n                logger.debug('cannot get cognito credentials', e_1);\n                return [3\n                /*break*/\n                , 9];\n\n              case 5:\n                _a.trys.push([5, 7,, 8]);\n\n                return [4\n                /*yield*/\n                , this.currentUserPoolUser()];\n\n              case 6:\n                currentUser = _a.sent();\n                that.user = currentUser;\n                dispatchAuthEvent('signIn', currentUser, \"A user \" + user.getUsername() + \" has been signed in\");\n                resolve(currentUser);\n                return [3\n                /*break*/\n                , 8];\n\n              case 7:\n                e_2 = _a.sent();\n                logger.error('Failed to get the signed in user', e_2);\n                reject(e_2);\n                return [3\n                /*break*/\n                , 8];\n\n              case 8:\n                return [7\n                /*endfinally*/\n                ];\n\n              case 9:\n                return [2\n                /*return*/\n                ];\n            }\n          });\n        });\n      },\n      onFailure: function onFailure(err) {\n        logger.debug('signIn failure', err);\n        dispatchAuthEvent('signIn_failure', err, user.getUsername() + \" failed to signin\");\n        reject(err);\n      },\n      customChallenge: function customChallenge(challengeParam) {\n        logger.debug('signIn custom challenge answer required');\n        user['challengeName'] = 'CUSTOM_CHALLENGE';\n        user['challengeParam'] = challengeParam;\n        resolve(user);\n      },\n      mfaRequired: function mfaRequired(challengeName, challengeParam) {\n        logger.debug('signIn MFA required');\n        user['challengeName'] = challengeName;\n        user['challengeParam'] = challengeParam;\n        resolve(user);\n      },\n      mfaSetup: function mfaSetup(challengeName, challengeParam) {\n        logger.debug('signIn mfa setup', challengeName);\n        user['challengeName'] = challengeName;\n        user['challengeParam'] = challengeParam;\n        resolve(user);\n      },\n      newPasswordRequired: function newPasswordRequired(userAttributes, requiredAttributes) {\n        logger.debug('signIn new password');\n        user['challengeName'] = 'NEW_PASSWORD_REQUIRED';\n        user['challengeParam'] = {\n          userAttributes: userAttributes,\n          requiredAttributes: requiredAttributes\n        };\n        resolve(user);\n      },\n      totpRequired: function totpRequired(challengeName, challengeParam) {\n        logger.debug('signIn totpRequired');\n        user['challengeName'] = challengeName;\n        user['challengeParam'] = challengeParam;\n        resolve(user);\n      },\n      selectMFAType: function selectMFAType(challengeName, challengeParam) {\n        logger.debug('signIn selectMFAType', challengeName);\n        user['challengeName'] = challengeName;\n        user['challengeParam'] = challengeParam;\n        resolve(user);\n      }\n    };\n  };\n  /**\n   * Sign in with a password\n   * @private\n   * @param {AuthenticationDetails} authDetails - the user sign in data\n   * @return - A promise resolves the CognitoUser object if success or mfa required\n   */\n\n\n  AuthClass.prototype.signInWithPassword = function (authDetails) {\n    var _this = this;\n\n    if (this.pendingSignIn) {\n      throw new Error('Pending sign-in attempt already in progress');\n    }\n\n    var user = this.createCognitoUser(authDetails.getUsername());\n    this.pendingSignIn = new Promise(function (resolve, reject) {\n      user.authenticateUser(authDetails, _this.authCallbacks(user, function (value) {\n        _this.pendingSignIn = null;\n        resolve(value);\n      }, function (error) {\n        _this.pendingSignIn = null;\n        reject(error);\n      }));\n    });\n    return this.pendingSignIn;\n  };\n  /**\n   * Sign in without a password\n   * @private\n   * @param {AuthenticationDetails} authDetails - the user sign in data\n   * @return - A promise resolves the CognitoUser object if success or mfa required\n   */\n\n\n  AuthClass.prototype.signInWithoutPassword = function (authDetails) {\n    var _this = this;\n\n    var user = this.createCognitoUser(authDetails.getUsername());\n    user.setAuthenticationFlowType('CUSTOM_AUTH');\n    return new Promise(function (resolve, reject) {\n      user.initiateAuth(authDetails, _this.authCallbacks(user, resolve, reject));\n    });\n  };\n  /**\n   * get user current preferred mfa option\n   * this method doesn't work with totp, we need to deprecate it.\n   * @deprecated\n   * @param {CognitoUser} user - the current user\n   * @return - A promise resolves the current preferred mfa option if success\n   */\n\n\n  AuthClass.prototype.getMFAOptions = function (user) {\n    return new Promise(function (res, rej) {\n      user.getMFAOptions(function (err, mfaOptions) {\n        if (err) {\n          logger.debug('get MFA Options failed', err);\n          rej(err);\n          return;\n        }\n\n        logger.debug('get MFA options success', mfaOptions);\n        res(mfaOptions);\n        return;\n      });\n    });\n  };\n  /**\n   * get preferred mfa method\n   * @param {CognitoUser} user - the current cognito user\n   * @param {GetPreferredMFAOpts} params - options for getting the current user preferred MFA\n   */\n\n\n  AuthClass.prototype.getPreferredMFA = function (user, params) {\n    var that = this;\n    return new Promise(function (res, rej) {\n      var bypassCache = params ? params.bypassCache : false;\n      user.getUserData(function (err, data) {\n        if (err) {\n          logger.debug('getting preferred mfa failed', err);\n          rej(err);\n          return;\n        }\n\n        var mfaType = that._getMfaTypeFromUserData(data);\n\n        if (!mfaType) {\n          rej('invalid MFA Type');\n          return;\n        } else {\n          res(mfaType);\n          return;\n        }\n      }, {\n        bypassCache: bypassCache\n      });\n    });\n  };\n\n  AuthClass.prototype._getMfaTypeFromUserData = function (data) {\n    var ret = null;\n    var preferredMFA = data.PreferredMfaSetting; // if the user has used Auth.setPreferredMFA() to setup the mfa type\n    // then the \"PreferredMfaSetting\" would exist in the response\n\n    if (preferredMFA) {\n      ret = preferredMFA;\n    } else {\n      // if mfaList exists but empty, then its noMFA\n      var mfaList = data.UserMFASettingList;\n\n      if (!mfaList) {\n        // if SMS was enabled by using Auth.enableSMS(),\n        // the response would contain MFAOptions\n        // as for now Cognito only supports for SMS, so we will say it is 'SMS_MFA'\n        // if it does not exist, then it should be NOMFA\n        var MFAOptions = data.MFAOptions;\n\n        if (MFAOptions) {\n          ret = 'SMS_MFA';\n        } else {\n          ret = 'NOMFA';\n        }\n      } else if (mfaList.length === 0) {\n        ret = 'NOMFA';\n      } else {\n        logger.debug('invalid case for getPreferredMFA', data);\n      }\n    }\n\n    return ret;\n  };\n\n  AuthClass.prototype._getUserData = function (user, params) {\n    return new Promise(function (res, rej) {\n      user.getUserData(function (err, data) {\n        if (err) {\n          logger.debug('getting user data failed', err);\n          rej(err);\n          return;\n        } else {\n          res(data);\n          return;\n        }\n      }, params);\n    });\n  };\n  /**\n   * set preferred MFA method\n   * @param {CognitoUser} user - the current Cognito user\n   * @param {string} mfaMethod - preferred mfa method\n   * @return - A promise resolve if success\n   */\n\n\n  AuthClass.prototype.setPreferredMFA = function (user, mfaMethod) {\n    return __awaiter(this, void 0, void 0, function () {\n      var userData, smsMfaSettings, totpMfaSettings, _a, mfaList, currentMFAType, that;\n\n      return __generator(this, function (_b) {\n        switch (_b.label) {\n          case 0:\n            return [4\n            /*yield*/\n            , this._getUserData(user, {\n              bypassCache: true\n            })];\n\n          case 1:\n            userData = _b.sent();\n            smsMfaSettings = null;\n            totpMfaSettings = null;\n            _a = mfaMethod;\n\n            switch (_a) {\n              case 'TOTP' || 'SOFTWARE_TOKEN_MFA':\n                return [3\n                /*break*/\n                , 2];\n\n              case 'SMS' || 'SMS_MFA':\n                return [3\n                /*break*/\n                , 3];\n\n              case 'NOMFA':\n                return [3\n                /*break*/\n                , 4];\n            }\n\n            return [3\n            /*break*/\n            , 6];\n\n          case 2:\n            totpMfaSettings = {\n              PreferredMfa: true,\n              Enabled: true\n            };\n            return [3\n            /*break*/\n            , 7];\n\n          case 3:\n            smsMfaSettings = {\n              PreferredMfa: true,\n              Enabled: true\n            };\n            return [3\n            /*break*/\n            , 7];\n\n          case 4:\n            mfaList = userData['UserMFASettingList'];\n            return [4\n            /*yield*/\n            , this._getMfaTypeFromUserData(userData)];\n\n          case 5:\n            currentMFAType = _b.sent();\n\n            if (currentMFAType === 'NOMFA') {\n              return [2\n              /*return*/\n              , Promise.resolve('No change for mfa type')];\n            } else if (currentMFAType === 'SMS_MFA') {\n              smsMfaSettings = {\n                PreferredMfa: false,\n                Enabled: false\n              };\n            } else if (currentMFAType === 'SOFTWARE_TOKEN_MFA') {\n              totpMfaSettings = {\n                PreferredMfa: false,\n                Enabled: false\n              };\n            } else {\n              return [2\n              /*return*/\n              , this.rejectAuthError(AuthErrorTypes.InvalidMFA)];\n            } // if there is a UserMFASettingList in the response\n            // we need to disable every mfa type in that list\n\n\n            if (mfaList && mfaList.length !== 0) {\n              // to disable SMS or TOTP if exists in that list\n              mfaList.forEach(function (mfaType) {\n                if (mfaType === 'SMS_MFA') {\n                  smsMfaSettings = {\n                    PreferredMfa: false,\n                    Enabled: false\n                  };\n                } else if (mfaType === 'SOFTWARE_TOKEN_MFA') {\n                  totpMfaSettings = {\n                    PreferredMfa: false,\n                    Enabled: false\n                  };\n                }\n              });\n            }\n\n            return [3\n            /*break*/\n            , 7];\n\n          case 6:\n            logger.debug('no validmfa method provided');\n            return [2\n            /*return*/\n            , this.rejectAuthError(AuthErrorTypes.NoMFA)];\n\n          case 7:\n            that = this;\n            return [2\n            /*return*/\n            , new Promise(function (res, rej) {\n              user.setUserMfaPreference(smsMfaSettings, totpMfaSettings, function (err, result) {\n                if (err) {\n                  logger.debug('Set user mfa preference error', err);\n                  return rej(err);\n                }\n\n                logger.debug('Set user mfa success', result);\n                logger.debug('Caching the latest user data into local'); // cache the latest result into user data\n\n                user.getUserData(function (err, data) {\n                  if (err) {\n                    logger.debug('getting user data failed', err);\n                    return rej(err);\n                  } else {\n                    return res(result);\n                  }\n                }, {\n                  bypassCache: true\n                });\n              });\n            })];\n        }\n      });\n    });\n  };\n  /**\n   * diable SMS\n   * @deprecated\n   * @param {CognitoUser} user - the current user\n   * @return - A promise resolves is success\n   */\n\n\n  AuthClass.prototype.disableSMS = function (user) {\n    return new Promise(function (res, rej) {\n      user.disableMFA(function (err, data) {\n        if (err) {\n          logger.debug('disable mfa failed', err);\n          rej(err);\n          return;\n        }\n\n        logger.debug('disable mfa succeed', data);\n        res(data);\n        return;\n      });\n    });\n  };\n  /**\n   * enable SMS\n   * @deprecated\n   * @param {CognitoUser} user - the current user\n   * @return - A promise resolves is success\n   */\n\n\n  AuthClass.prototype.enableSMS = function (user) {\n    return new Promise(function (res, rej) {\n      user.enableMFA(function (err, data) {\n        if (err) {\n          logger.debug('enable mfa failed', err);\n          rej(err);\n          return;\n        }\n\n        logger.debug('enable mfa succeed', data);\n        res(data);\n        return;\n      });\n    });\n  };\n  /**\n   * Setup TOTP\n   * @param {CognitoUser} user - the current user\n   * @return - A promise resolves with the secret code if success\n   */\n\n\n  AuthClass.prototype.setupTOTP = function (user) {\n    return new Promise(function (res, rej) {\n      user.associateSoftwareToken({\n        onFailure: function onFailure(err) {\n          logger.debug('associateSoftwareToken failed', err);\n          rej(err);\n          return;\n        },\n        associateSecretCode: function associateSecretCode(secretCode) {\n          logger.debug('associateSoftwareToken sucess', secretCode);\n          res(secretCode);\n          return;\n        }\n      });\n    });\n  };\n  /**\n   * verify TOTP setup\n   * @param {CognitoUser} user - the current user\n   * @param {string} challengeAnswer - challenge answer\n   * @return - A promise resolves is success\n   */\n\n\n  AuthClass.prototype.verifyTotpToken = function (user, challengeAnswer) {\n    logger.debug('verfication totp token', user, challengeAnswer);\n    return new Promise(function (res, rej) {\n      user.verifySoftwareToken(challengeAnswer, 'My TOTP device', {\n        onFailure: function onFailure(err) {\n          logger.debug('verifyTotpToken failed', err);\n          rej(err);\n          return;\n        },\n        onSuccess: function onSuccess(data) {\n          dispatchAuthEvent('signIn', user, \"A user \" + user.getUsername() + \" has been signed in\");\n          logger.debug('verifyTotpToken success', data);\n          res(data);\n          return;\n        }\n      });\n    });\n  };\n  /**\n   * Send MFA code to confirm sign in\n   * @param {Object} user - The CognitoUser object\n   * @param {String} code - The confirmation code\n   */\n\n\n  AuthClass.prototype.confirmSignIn = function (user, code, mfaType, clientMetadata) {\n    var _this = this;\n\n    if (clientMetadata === void 0) {\n      clientMetadata = this._config.clientMetadata;\n    }\n\n    if (!code) {\n      return this.rejectAuthError(AuthErrorTypes.EmptyCode);\n    }\n\n    var that = this;\n    return new Promise(function (resolve, reject) {\n      user.sendMFACode(code, {\n        onSuccess: function onSuccess(session) {\n          return __awaiter(_this, void 0, void 0, function () {\n            var cred, e_3;\n            return __generator(this, function (_a) {\n              switch (_a.label) {\n                case 0:\n                  logger.debug(session);\n                  _a.label = 1;\n\n                case 1:\n                  _a.trys.push([1, 4, 5, 6]);\n\n                  return [4\n                  /*yield*/\n                  , this.Credentials.clear()];\n\n                case 2:\n                  _a.sent();\n\n                  return [4\n                  /*yield*/\n                  , this.Credentials.set(session, 'session')];\n\n                case 3:\n                  cred = _a.sent();\n                  logger.debug('succeed to get cognito credentials', cred);\n                  return [3\n                  /*break*/\n                  , 6];\n\n                case 4:\n                  e_3 = _a.sent();\n                  logger.debug('cannot get cognito credentials', e_3);\n                  return [3\n                  /*break*/\n                  , 6];\n\n                case 5:\n                  that.user = user;\n                  dispatchAuthEvent('signIn', user, \"A user \" + user.getUsername() + \" has been signed in\");\n                  resolve(user);\n                  return [7\n                  /*endfinally*/\n                  ];\n\n                case 6:\n                  return [2\n                  /*return*/\n                  ];\n              }\n            });\n          });\n        },\n        onFailure: function onFailure(err) {\n          logger.debug('confirm signIn failure', err);\n          reject(err);\n        }\n      }, mfaType, clientMetadata);\n    });\n  };\n\n  AuthClass.prototype.completeNewPassword = function (user, password, requiredAttributes, clientMetadata) {\n    var _this = this;\n\n    if (requiredAttributes === void 0) {\n      requiredAttributes = {};\n    }\n\n    if (clientMetadata === void 0) {\n      clientMetadata = this._config.clientMetadata;\n    }\n\n    if (!password) {\n      return this.rejectAuthError(AuthErrorTypes.EmptyPassword);\n    }\n\n    var that = this;\n    return new Promise(function (resolve, reject) {\n      user.completeNewPasswordChallenge(password, requiredAttributes, {\n        onSuccess: function onSuccess(session) {\n          return __awaiter(_this, void 0, void 0, function () {\n            var cred, e_4;\n            return __generator(this, function (_a) {\n              switch (_a.label) {\n                case 0:\n                  logger.debug(session);\n                  _a.label = 1;\n\n                case 1:\n                  _a.trys.push([1, 4, 5, 6]);\n\n                  return [4\n                  /*yield*/\n                  , this.Credentials.clear()];\n\n                case 2:\n                  _a.sent();\n\n                  return [4\n                  /*yield*/\n                  , this.Credentials.set(session, 'session')];\n\n                case 3:\n                  cred = _a.sent();\n                  logger.debug('succeed to get cognito credentials', cred);\n                  return [3\n                  /*break*/\n                  , 6];\n\n                case 4:\n                  e_4 = _a.sent();\n                  logger.debug('cannot get cognito credentials', e_4);\n                  return [3\n                  /*break*/\n                  , 6];\n\n                case 5:\n                  that.user = user;\n                  dispatchAuthEvent('signIn', user, \"A user \" + user.getUsername() + \" has been signed in\");\n                  resolve(user);\n                  return [7\n                  /*endfinally*/\n                  ];\n\n                case 6:\n                  return [2\n                  /*return*/\n                  ];\n              }\n            });\n          });\n        },\n        onFailure: function onFailure(err) {\n          logger.debug('completeNewPassword failure', err);\n          dispatchAuthEvent('completeNewPassword_failure', err, _this.user + \" failed to complete the new password flow\");\n          reject(err);\n        },\n        mfaRequired: function mfaRequired(challengeName, challengeParam) {\n          logger.debug('signIn MFA required');\n          user['challengeName'] = challengeName;\n          user['challengeParam'] = challengeParam;\n          resolve(user);\n        },\n        mfaSetup: function mfaSetup(challengeName, challengeParam) {\n          logger.debug('signIn mfa setup', challengeName);\n          user['challengeName'] = challengeName;\n          user['challengeParam'] = challengeParam;\n          resolve(user);\n        },\n        totpRequired: function totpRequired(challengeName, challengeParam) {\n          logger.debug('signIn mfa setup', challengeName);\n          user['challengeName'] = challengeName;\n          user['challengeParam'] = challengeParam;\n          resolve(user);\n        }\n      }, clientMetadata);\n    });\n  };\n  /**\n   * Send the answer to a custom challenge\n   * @param {CognitoUser} user - The CognitoUser object\n   * @param {String} challengeResponses - The confirmation code\n   */\n\n\n  AuthClass.prototype.sendCustomChallengeAnswer = function (user, challengeResponses, clientMetadata) {\n    var _this = this;\n\n    if (clientMetadata === void 0) {\n      clientMetadata = this._config.clientMetadata;\n    }\n\n    if (!this.userPool) {\n      return this.rejectNoUserPool();\n    }\n\n    if (!challengeResponses) {\n      return this.rejectAuthError(AuthErrorTypes.EmptyChallengeResponse);\n    }\n\n    var that = this;\n    return new Promise(function (resolve, reject) {\n      user.sendCustomChallengeAnswer(challengeResponses, _this.authCallbacks(user, resolve, reject), clientMetadata);\n    });\n  };\n  /**\n   * Update an authenticated users' attributes\n   * @param {CognitoUser} - The currently logged in user object\n   * @return {Promise}\n   **/\n\n\n  AuthClass.prototype.updateUserAttributes = function (user, attributes, clientMetadata) {\n    if (clientMetadata === void 0) {\n      clientMetadata = this._config.clientMetadata;\n    }\n\n    var attributeList = [];\n    var that = this;\n    return new Promise(function (resolve, reject) {\n      that.userSession(user).then(function (session) {\n        for (var key in attributes) {\n          if (key !== 'sub' && key.indexOf('_verified') < 0) {\n            var attr = {\n              Name: key,\n              Value: attributes[key]\n            };\n            attributeList.push(attr);\n          }\n        }\n\n        user.updateAttributes(attributeList, function (err, result) {\n          if (err) {\n            return reject(err);\n          } else {\n            return resolve(result);\n          }\n        }, clientMetadata);\n      });\n    });\n  };\n  /**\n   * Return user attributes\n   * @param {Object} user - The CognitoUser object\n   * @return - A promise resolves to user attributes if success\n   */\n\n\n  AuthClass.prototype.userAttributes = function (user) {\n    var _this = this;\n\n    return new Promise(function (resolve, reject) {\n      _this.userSession(user).then(function (session) {\n        user.getUserAttributes(function (err, attributes) {\n          if (err) {\n            reject(err);\n          } else {\n            resolve(attributes);\n          }\n        });\n      });\n    });\n  };\n\n  AuthClass.prototype.verifiedContact = function (user) {\n    var that = this;\n    return this.userAttributes(user).then(function (attributes) {\n      var attrs = that.attributesToObject(attributes);\n      var unverified = {};\n      var verified = {};\n\n      if (attrs['email']) {\n        if (attrs['email_verified']) {\n          verified['email'] = attrs['email'];\n        } else {\n          unverified['email'] = attrs['email'];\n        }\n      }\n\n      if (attrs['phone_number']) {\n        if (attrs['phone_number_verified']) {\n          verified['phone_number'] = attrs['phone_number'];\n        } else {\n          unverified['phone_number'] = attrs['phone_number'];\n        }\n      }\n\n      return {\n        verified: verified,\n        unverified: unverified\n      };\n    });\n  };\n  /**\n   * Get current authenticated user\n   * @return - A promise resolves to current authenticated CognitoUser if success\n   */\n\n\n  AuthClass.prototype.currentUserPoolUser = function (params) {\n    var _this = this;\n\n    if (!this.userPool) {\n      return this.rejectNoUserPool();\n    }\n\n    return new Promise(function (res, rej) {\n      _this._storageSync.then(function () {\n        return __awaiter(_this, void 0, void 0, function () {\n          var user;\n\n          var _this = this;\n\n          return __generator(this, function (_a) {\n            switch (_a.label) {\n              case 0:\n                if (!this.isOAuthInProgress()) return [3\n                /*break*/\n                , 2];\n                logger.debug('OAuth signIn in progress, waiting for resolution...');\n                return [4\n                /*yield*/\n                , new Promise(function (res) {\n                  var timeoutId = setTimeout(function () {\n                    logger.debug('OAuth signIn in progress timeout');\n                    Hub.remove('auth', hostedUISignCallback);\n                    res();\n                  }, OAUTH_FLOW_MS_TIMEOUT);\n                  Hub.listen('auth', hostedUISignCallback);\n\n                  function hostedUISignCallback(_a) {\n                    var payload = _a.payload;\n                    var event = payload.event;\n\n                    if (event === 'cognitoHostedUI' || event === 'cognitoHostedUI_failure') {\n                      logger.debug(\"OAuth signIn resolved: \" + event);\n                      clearTimeout(timeoutId);\n                      Hub.remove('auth', hostedUISignCallback);\n                      res();\n                    }\n                  }\n                })];\n\n              case 1:\n                _a.sent();\n\n                _a.label = 2;\n\n              case 2:\n                user = this.userPool.getCurrentUser();\n\n                if (!user) {\n                  logger.debug('Failed to get user from user pool');\n                  rej('No current user');\n                  return [2\n                  /*return*/\n                  ];\n                } // refresh the session if the session expired.\n\n\n                user.getSession(function (err, session) {\n                  return __awaiter(_this, void 0, void 0, function () {\n                    var bypassCache, _a, scope;\n\n                    var _this = this;\n\n                    return __generator(this, function (_b) {\n                      switch (_b.label) {\n                        case 0:\n                          if (err) {\n                            logger.debug('Failed to get the user session', err);\n                            rej(err);\n                            return [2\n                            /*return*/\n                            ];\n                          }\n\n                          bypassCache = params ? params.bypassCache : false;\n                          if (!bypassCache) return [3\n                          /*break*/\n                          , 2];\n                          return [4\n                          /*yield*/\n                          , this.Credentials.clear()];\n\n                        case 1:\n                          _b.sent();\n\n                          _b.label = 2;\n\n                        case 2:\n                          _a = session.getAccessToken().decodePayload().scope, scope = _a === void 0 ? '' : _a;\n\n                          if (scope.split(' ').includes(USER_ADMIN_SCOPE)) {\n                            user.getUserData(function (err, data) {\n                              if (err) {\n                                logger.debug('getting user data failed', err); // Make sure the user is still valid\n\n                                if (err.message === 'User is disabled.' || err.message === 'User does not exist.' || err.message === 'Access Token has been revoked' // Session revoked by another app\n                                ) {\n                                    rej(err);\n                                  } else {\n                                  // the error may also be thrown when lack of permissions to get user info etc\n                                  // in that case we just bypass the error\n                                  res(user);\n                                }\n\n                                return;\n                              }\n\n                              var preferredMFA = data.PreferredMfaSetting || 'NOMFA';\n                              var attributeList = [];\n\n                              for (var i = 0; i < data.UserAttributes.length; i++) {\n                                var attribute = {\n                                  Name: data.UserAttributes[i].Name,\n                                  Value: data.UserAttributes[i].Value\n                                };\n                                var userAttribute = new CognitoUserAttribute(attribute);\n                                attributeList.push(userAttribute);\n                              }\n\n                              var attributes = _this.attributesToObject(attributeList);\n\n                              Object.assign(user, {\n                                attributes: attributes,\n                                preferredMFA: preferredMFA\n                              });\n                              return res(user);\n                            }, {\n                              bypassCache: bypassCache\n                            });\n                          } else {\n                            logger.debug(\"Unable to get the user data because the \" + USER_ADMIN_SCOPE + \" \" + \"is not in the scopes of the access token\");\n                            return [2\n                            /*return*/\n                            , res(user)];\n                          }\n\n                          return [2\n                          /*return*/\n                          ];\n                      }\n                    });\n                  });\n                });\n                return [2\n                /*return*/\n                ];\n            }\n          });\n        });\n      }).catch(function (e) {\n        logger.debug('Failed to sync cache info into memory', e);\n        return rej(e);\n      });\n    });\n  };\n\n  AuthClass.prototype.isOAuthInProgress = function () {\n    return this.oAuthFlowInProgress;\n  };\n  /**\n   * Get current authenticated user\n   * @param {CurrentUserOpts} - options for getting the current user\n   * @return - A promise resolves to current authenticated CognitoUser if success\n   */\n\n\n  AuthClass.prototype.currentAuthenticatedUser = function (params) {\n    return __awaiter(this, void 0, void 0, function () {\n      var federatedUser, e_5, federatedInfo, user, e_6;\n      return __generator(this, function (_a) {\n        switch (_a.label) {\n          case 0:\n            logger.debug('getting current authenticated user');\n            federatedUser = null;\n            _a.label = 1;\n\n          case 1:\n            _a.trys.push([1, 3,, 4]);\n\n            return [4\n            /*yield*/\n            , this._storageSync];\n\n          case 2:\n            _a.sent();\n\n            return [3\n            /*break*/\n            , 4];\n\n          case 3:\n            e_5 = _a.sent();\n            logger.debug('Failed to sync cache info into memory', e_5);\n            throw e_5;\n\n          case 4:\n            try {\n              federatedInfo = JSON.parse(this._storage.getItem('aws-amplify-federatedInfo'));\n\n              if (federatedInfo) {\n                federatedUser = __assign(__assign({}, federatedInfo.user), {\n                  token: federatedInfo.token\n                });\n              }\n            } catch (e) {\n              logger.debug('cannot load federated user from auth storage');\n            }\n\n            if (!federatedUser) return [3\n            /*break*/\n            , 5];\n            this.user = federatedUser;\n            logger.debug('get current authenticated federated user', this.user);\n            return [2\n            /*return*/\n            , this.user];\n\n          case 5:\n            logger.debug('get current authenticated userpool user');\n            user = null;\n            _a.label = 6;\n\n          case 6:\n            _a.trys.push([6, 8,, 9]);\n\n            return [4\n            /*yield*/\n            , this.currentUserPoolUser(params)];\n\n          case 7:\n            user = _a.sent();\n            return [3\n            /*break*/\n            , 9];\n\n          case 8:\n            e_6 = _a.sent();\n\n            if (e_6 === 'No userPool') {\n              logger.error('Cannot get the current user because the user pool is missing. ' + 'Please make sure the Auth module is configured with a valid Cognito User Pool ID');\n            }\n\n            logger.debug('The user is not authenticated by the error', e_6);\n            return [2\n            /*return*/\n            , Promise.reject('The user is not authenticated')];\n\n          case 9:\n            this.user = user;\n            return [2\n            /*return*/\n            , this.user];\n        }\n      });\n    });\n  };\n  /**\n   * Get current user's session\n   * @return - A promise resolves to session object if success\n   */\n\n\n  AuthClass.prototype.currentSession = function () {\n    var that = this;\n    logger.debug('Getting current session'); // Purposely not calling the reject method here because we don't need a console error\n\n    if (!this.userPool) {\n      return Promise.reject();\n    }\n\n    return new Promise(function (res, rej) {\n      that.currentUserPoolUser().then(function (user) {\n        that.userSession(user).then(function (session) {\n          res(session);\n          return;\n        }).catch(function (e) {\n          logger.debug('Failed to get the current session', e);\n          rej(e);\n          return;\n        });\n      }).catch(function (e) {\n        logger.debug('Failed to get the current user', e);\n        rej(e);\n        return;\n      });\n    });\n  };\n  /**\n   * Get the corresponding user session\n   * @param {Object} user - The CognitoUser object\n   * @return - A promise resolves to the session\n   */\n\n\n  AuthClass.prototype.userSession = function (user) {\n    if (!user) {\n      logger.debug('the user is null');\n      return this.rejectAuthError(AuthErrorTypes.NoUserSession);\n    }\n\n    return new Promise(function (resolve, reject) {\n      logger.debug('Getting the session from this user:', user);\n      user.getSession(function (err, session) {\n        if (err) {\n          logger.debug('Failed to get the session from user', user);\n          reject(err);\n          return;\n        } else {\n          logger.debug('Succeed to get the user session', session);\n          resolve(session);\n          return;\n        }\n      });\n    });\n  };\n  /**\n   * Get authenticated credentials of current user.\n   * @return - A promise resolves to be current user's credentials\n   */\n\n\n  AuthClass.prototype.currentUserCredentials = function () {\n    return __awaiter(this, void 0, void 0, function () {\n      var e_7, federatedInfo;\n\n      var _this = this;\n\n      return __generator(this, function (_a) {\n        switch (_a.label) {\n          case 0:\n            logger.debug('Getting current user credentials');\n            _a.label = 1;\n\n          case 1:\n            _a.trys.push([1, 3,, 4]);\n\n            return [4\n            /*yield*/\n            , this._storageSync];\n\n          case 2:\n            _a.sent();\n\n            return [3\n            /*break*/\n            , 4];\n\n          case 3:\n            e_7 = _a.sent();\n            logger.debug('Failed to sync cache info into memory', e_7);\n            throw e_7;\n\n          case 4:\n            federatedInfo = null;\n\n            try {\n              federatedInfo = JSON.parse(this._storage.getItem('aws-amplify-federatedInfo'));\n            } catch (e) {\n              logger.debug('failed to get or parse item aws-amplify-federatedInfo', e);\n            }\n\n            if (federatedInfo) {\n              // refresh the jwt token here if necessary\n              return [2\n              /*return*/\n              , this.Credentials.refreshFederatedToken(federatedInfo)];\n            } else {\n              return [2\n              /*return*/\n              , this.currentSession().then(function (session) {\n                logger.debug('getting session success', session);\n                return _this.Credentials.set(session, 'session');\n              }).catch(function (error) {\n                logger.debug('getting session failed', error);\n                return _this.Credentials.set(null, 'guest');\n              })];\n            }\n\n            return [2\n            /*return*/\n            ];\n        }\n      });\n    });\n  };\n\n  AuthClass.prototype.currentCredentials = function () {\n    logger.debug('getting current credentials');\n    return this.Credentials.get();\n  };\n  /**\n   * Initiate an attribute confirmation request\n   * @param {Object} user - The CognitoUser\n   * @param {Object} attr - The attributes to be verified\n   * @return - A promise resolves to callback data if success\n   */\n\n\n  AuthClass.prototype.verifyUserAttribute = function (user, attr, clientMetadata) {\n    if (clientMetadata === void 0) {\n      clientMetadata = this._config.clientMetadata;\n    }\n\n    return new Promise(function (resolve, reject) {\n      user.getAttributeVerificationCode(attr, {\n        onSuccess: function onSuccess() {\n          return resolve();\n        },\n        onFailure: function onFailure(err) {\n          return reject(err);\n        }\n      }, clientMetadata);\n    });\n  };\n  /**\n   * Confirm an attribute using a confirmation code\n   * @param {Object} user - The CognitoUser\n   * @param {Object} attr - The attribute to be verified\n   * @param {String} code - The confirmation code\n   * @return - A promise resolves to callback data if success\n   */\n\n\n  AuthClass.prototype.verifyUserAttributeSubmit = function (user, attr, code) {\n    if (!code) {\n      return this.rejectAuthError(AuthErrorTypes.EmptyCode);\n    }\n\n    return new Promise(function (resolve, reject) {\n      user.verifyAttribute(attr, code, {\n        onSuccess: function onSuccess(data) {\n          resolve(data);\n          return;\n        },\n        onFailure: function onFailure(err) {\n          reject(err);\n          return;\n        }\n      });\n    });\n  };\n\n  AuthClass.prototype.verifyCurrentUserAttribute = function (attr) {\n    var that = this;\n    return that.currentUserPoolUser().then(function (user) {\n      return that.verifyUserAttribute(user, attr);\n    });\n  };\n  /**\n   * Confirm current user's attribute using a confirmation code\n   * @param {Object} attr - The attribute to be verified\n   * @param {String} code - The confirmation code\n   * @return - A promise resolves to callback data if success\n   */\n\n\n  AuthClass.prototype.verifyCurrentUserAttributeSubmit = function (attr, code) {\n    var that = this;\n    return that.currentUserPoolUser().then(function (user) {\n      return that.verifyUserAttributeSubmit(user, attr, code);\n    });\n  };\n\n  AuthClass.prototype.cognitoIdentitySignOut = function (opts, user) {\n    return __awaiter(this, void 0, void 0, function () {\n      var e_8, isSignedInHostedUI;\n\n      var _this = this;\n\n      return __generator(this, function (_a) {\n        switch (_a.label) {\n          case 0:\n            _a.trys.push([0, 2,, 3]);\n\n            return [4\n            /*yield*/\n            , this._storageSync];\n\n          case 1:\n            _a.sent();\n\n            return [3\n            /*break*/\n            , 3];\n\n          case 2:\n            e_8 = _a.sent();\n            logger.debug('Failed to sync cache info into memory', e_8);\n            throw e_8;\n\n          case 3:\n            isSignedInHostedUI = this._oAuthHandler && this._storage.getItem('amplify-signin-with-hostedUI') === 'true';\n            return [2\n            /*return*/\n            , new Promise(function (res, rej) {\n              if (opts && opts.global) {\n                logger.debug('user global sign out', user); // in order to use global signout\n                // we must validate the user as an authenticated user by using getSession\n\n                user.getSession(function (err, result) {\n                  if (err) {\n                    logger.debug('failed to get the user session', err);\n                    return rej(err);\n                  }\n\n                  user.globalSignOut({\n                    onSuccess: function onSuccess(data) {\n                      logger.debug('global sign out success');\n\n                      if (isSignedInHostedUI) {\n                        _this.oAuthSignOutRedirect(res, rej);\n                      } else {\n                        return res();\n                      }\n                    },\n                    onFailure: function onFailure(err) {\n                      logger.debug('global sign out failed', err);\n                      return rej(err);\n                    }\n                  });\n                });\n              } else {\n                logger.debug('user sign out', user);\n                user.signOut();\n\n                if (isSignedInHostedUI) {\n                  _this.oAuthSignOutRedirect(res, rej);\n                } else {\n                  return res();\n                }\n              }\n            })];\n        }\n      });\n    });\n  };\n\n  AuthClass.prototype.oAuthSignOutRedirect = function (resolve, reject) {\n    var isBrowser = JS.browserOrNode().isBrowser;\n\n    if (isBrowser) {\n      this.oAuthSignOutRedirectOrReject(reject);\n    } else {\n      this.oAuthSignOutAndResolve(resolve);\n    }\n  };\n\n  AuthClass.prototype.oAuthSignOutAndResolve = function (resolve) {\n    this._oAuthHandler.signOut();\n\n    resolve();\n  };\n\n  AuthClass.prototype.oAuthSignOutRedirectOrReject = function (reject) {\n    this._oAuthHandler.signOut(); // this method redirects url\n    // App should be redirected to another url otherwise it will reject\n\n\n    setTimeout(function () {\n      return reject('Signout timeout fail');\n    }, 3000);\n  };\n  /**\n   * Sign out method\n   * @\n   * @return - A promise resolved if success\n   */\n\n\n  AuthClass.prototype.signOut = function (opts) {\n    return __awaiter(this, void 0, void 0, function () {\n      var e_9, user;\n      return __generator(this, function (_a) {\n        switch (_a.label) {\n          case 0:\n            _a.trys.push([0, 2,, 3]);\n\n            return [4\n            /*yield*/\n            , this.cleanCachedItems()];\n\n          case 1:\n            _a.sent();\n\n            return [3\n            /*break*/\n            , 3];\n\n          case 2:\n            e_9 = _a.sent();\n            logger.debug('failed to clear cached items');\n            return [3\n            /*break*/\n            , 3];\n\n          case 3:\n            if (!this.userPool) return [3\n            /*break*/\n            , 7];\n            user = this.userPool.getCurrentUser();\n            if (!user) return [3\n            /*break*/\n            , 5];\n            return [4\n            /*yield*/\n            , this.cognitoIdentitySignOut(opts, user)];\n\n          case 4:\n            _a.sent();\n\n            return [3\n            /*break*/\n            , 6];\n\n          case 5:\n            logger.debug('no current Cognito user');\n            _a.label = 6;\n\n          case 6:\n            return [3\n            /*break*/\n            , 8];\n\n          case 7:\n            logger.debug('no Congito User pool');\n            _a.label = 8;\n\n          case 8:\n            /**\n             * Note for future refactor - no reliable way to get username with\n             * Cognito User Pools vs Identity when federating with Social Providers\n             * This is why we need a well structured session object that can be inspected\n             * and information passed back in the message below for Hub dispatch\n             */\n            dispatchAuthEvent('signOut', this.user, \"A user has been signed out\");\n            this.user = null;\n            return [2\n            /*return*/\n            ];\n        }\n      });\n    });\n  };\n\n  AuthClass.prototype.cleanCachedItems = function () {\n    return __awaiter(this, void 0, void 0, function () {\n      return __generator(this, function (_a) {\n        switch (_a.label) {\n          case 0:\n            // clear cognito cached item\n            return [4\n            /*yield*/\n            , this.Credentials.clear()];\n\n          case 1:\n            // clear cognito cached item\n            _a.sent();\n\n            return [2\n            /*return*/\n            ];\n        }\n      });\n    });\n  };\n  /**\n   * Change a password for an authenticated user\n   * @param {Object} user - The CognitoUser object\n   * @param {String} oldPassword - the current password\n   * @param {String} newPassword - the requested new password\n   * @return - A promise resolves if success\n   */\n\n\n  AuthClass.prototype.changePassword = function (user, oldPassword, newPassword, clientMetadata) {\n    var _this = this;\n\n    if (clientMetadata === void 0) {\n      clientMetadata = this._config.clientMetadata;\n    }\n\n    return new Promise(function (resolve, reject) {\n      _this.userSession(user).then(function (session) {\n        user.changePassword(oldPassword, newPassword, function (err, data) {\n          if (err) {\n            logger.debug('change password failure', err);\n            return reject(err);\n          } else {\n            return resolve(data);\n          }\n        }, clientMetadata);\n      });\n    });\n  };\n  /**\n   * Initiate a forgot password request\n   * @param {String} username - the username to change password\n   * @return - A promise resolves if success\n   */\n\n\n  AuthClass.prototype.forgotPassword = function (username, clientMetadata) {\n    if (clientMetadata === void 0) {\n      clientMetadata = this._config.clientMetadata;\n    }\n\n    if (!this.userPool) {\n      return this.rejectNoUserPool();\n    }\n\n    if (!username) {\n      return this.rejectAuthError(AuthErrorTypes.EmptyUsername);\n    }\n\n    var user = this.createCognitoUser(username);\n    return new Promise(function (resolve, reject) {\n      user.forgotPassword({\n        onSuccess: function onSuccess() {\n          resolve();\n          return;\n        },\n        onFailure: function onFailure(err) {\n          logger.debug('forgot password failure', err);\n          dispatchAuthEvent('forgotPassword_failure', err, username + \" forgotPassword failed\");\n          reject(err);\n          return;\n        },\n        inputVerificationCode: function inputVerificationCode(data) {\n          dispatchAuthEvent('forgotPassword', user, username + \" has initiated forgot password flow\");\n          resolve(data);\n          return;\n        }\n      }, clientMetadata);\n    });\n  };\n  /**\n   * Confirm a new password using a confirmation Code\n   * @param {String} username - The username\n   * @param {String} code - The confirmation code\n   * @param {String} password - The new password\n   * @return - A promise that resolves if success\n   */\n\n\n  AuthClass.prototype.forgotPasswordSubmit = function (username, code, password, clientMetadata) {\n    if (clientMetadata === void 0) {\n      clientMetadata = this._config.clientMetadata;\n    }\n\n    if (!this.userPool) {\n      return this.rejectNoUserPool();\n    }\n\n    if (!username) {\n      return this.rejectAuthError(AuthErrorTypes.EmptyUsername);\n    }\n\n    if (!code) {\n      return this.rejectAuthError(AuthErrorTypes.EmptyCode);\n    }\n\n    if (!password) {\n      return this.rejectAuthError(AuthErrorTypes.EmptyPassword);\n    }\n\n    var user = this.createCognitoUser(username);\n    return new Promise(function (resolve, reject) {\n      user.confirmPassword(code, password, {\n        onSuccess: function onSuccess() {\n          dispatchAuthEvent('forgotPasswordSubmit', user, username + \" forgotPasswordSubmit successful\");\n          resolve();\n          return;\n        },\n        onFailure: function onFailure(err) {\n          dispatchAuthEvent('forgotPasswordSubmit_failure', err, username + \" forgotPasswordSubmit failed\");\n          reject(err);\n          return;\n        }\n      }, clientMetadata);\n    });\n  };\n  /**\n   * Get user information\n   * @async\n   * @return {Object }- current User's information\n   */\n\n\n  AuthClass.prototype.currentUserInfo = function () {\n    return __awaiter(this, void 0, void 0, function () {\n      var source, user, attributes, userAttrs, credentials, e_10, info, err_1, user;\n      return __generator(this, function (_a) {\n        switch (_a.label) {\n          case 0:\n            source = this.Credentials.getCredSource();\n            if (!(!source || source === 'aws' || source === 'userPool')) return [3\n            /*break*/\n            , 9];\n            return [4\n            /*yield*/\n            , this.currentUserPoolUser().catch(function (err) {\n              return logger.debug(err);\n            })];\n\n          case 1:\n            user = _a.sent();\n\n            if (!user) {\n              return [2\n              /*return*/\n              , null];\n            }\n\n            _a.label = 2;\n\n          case 2:\n            _a.trys.push([2, 8,, 9]);\n\n            return [4\n            /*yield*/\n            , this.userAttributes(user)];\n\n          case 3:\n            attributes = _a.sent();\n            userAttrs = this.attributesToObject(attributes);\n            credentials = null;\n            _a.label = 4;\n\n          case 4:\n            _a.trys.push([4, 6,, 7]);\n\n            return [4\n            /*yield*/\n            , this.currentCredentials()];\n\n          case 5:\n            credentials = _a.sent();\n            return [3\n            /*break*/\n            , 7];\n\n          case 6:\n            e_10 = _a.sent();\n            logger.debug('Failed to retrieve credentials while getting current user info', e_10);\n            return [3\n            /*break*/\n            , 7];\n\n          case 7:\n            info = {\n              id: credentials ? credentials.identityId : undefined,\n              username: user.getUsername(),\n              attributes: userAttrs\n            };\n            return [2\n            /*return*/\n            , info];\n\n          case 8:\n            err_1 = _a.sent();\n            logger.debug('currentUserInfo error', err_1);\n            return [2\n            /*return*/\n            , {}];\n\n          case 9:\n            if (source === 'federated') {\n              user = this.user;\n              return [2\n              /*return*/\n              , user ? user : {}];\n            }\n\n            return [2\n            /*return*/\n            ];\n        }\n      });\n    });\n  };\n\n  AuthClass.prototype.federatedSignIn = function (providerOrOptions, response, user) {\n    return __awaiter(this, void 0, void 0, function () {\n      var options, provider, customState, client_id, redirect_uri, provider, loggedInUser, token, identity_id, expires_at, credentials, currentUser;\n      return __generator(this, function (_a) {\n        switch (_a.label) {\n          case 0:\n            if (!this._config.identityPoolId && !this._config.userPoolId) {\n              throw new Error(\"Federation requires either a User Pool or Identity Pool in config\");\n            } // Ensure backwards compatability\n\n\n            if (typeof providerOrOptions === 'undefined') {\n              if (this._config.identityPoolId && !this._config.userPoolId) {\n                throw new Error(\"Federation with Identity Pools requires tokens passed as arguments\");\n              }\n            }\n\n            if (!(isFederatedSignInOptions(providerOrOptions) || isFederatedSignInOptionsCustom(providerOrOptions) || hasCustomState(providerOrOptions) || typeof providerOrOptions === 'undefined')) return [3\n            /*break*/\n            , 1];\n            options = providerOrOptions || {\n              provider: CognitoHostedUIIdentityProvider.Cognito\n            };\n            provider = isFederatedSignInOptions(options) ? options.provider : options.customProvider;\n            customState = isFederatedSignInOptions(options) ? options.customState : options.customState;\n\n            if (this._config.userPoolId) {\n              client_id = isCognitoHostedOpts(this._config.oauth) ? this._config.userPoolWebClientId : this._config.oauth.clientID;\n              redirect_uri = isCognitoHostedOpts(this._config.oauth) ? this._config.oauth.redirectSignIn : this._config.oauth.redirectUri;\n\n              this._oAuthHandler.oauthSignIn(this._config.oauth.responseType, this._config.oauth.domain, redirect_uri, client_id, provider, customState);\n            }\n\n            return [3\n            /*break*/\n            , 4];\n\n          case 1:\n            provider = providerOrOptions; // To check if the user is already logged in\n\n            try {\n              loggedInUser = JSON.stringify(JSON.parse(this._storage.getItem('aws-amplify-federatedInfo')).user);\n\n              if (loggedInUser) {\n                logger.warn(\"There is already a signed in user: \" + loggedInUser + \" in your app.\\n\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\tYou should not call Auth.federatedSignIn method again as it may cause unexpected behavior.\");\n              }\n            } catch (e) {}\n\n            token = response.token, identity_id = response.identity_id, expires_at = response.expires_at;\n            return [4\n            /*yield*/\n            , this.Credentials.set({\n              provider: provider,\n              token: token,\n              identity_id: identity_id,\n              user: user,\n              expires_at: expires_at\n            }, 'federation')];\n\n          case 2:\n            credentials = _a.sent();\n            return [4\n            /*yield*/\n            , this.currentAuthenticatedUser()];\n\n          case 3:\n            currentUser = _a.sent();\n            dispatchAuthEvent('signIn', currentUser, \"A user \" + currentUser.username + \" has been signed in\");\n            logger.debug('federated sign in credentials', credentials);\n            return [2\n            /*return*/\n            , credentials];\n\n          case 4:\n            return [2\n            /*return*/\n            ];\n        }\n      });\n    });\n  };\n  /**\n   * Used to complete the OAuth flow with or without the Cognito Hosted UI\n   * @param {String} URL - optional parameter for customers to pass in the response URL\n   */\n\n\n  AuthClass.prototype._handleAuthResponse = function (URL) {\n    return __awaiter(this, void 0, void 0, function () {\n      var currentUrl, hasCodeOrError, hasTokenOrError, _a, accessToken, idToken, refreshToken, state, session, credentials, isCustomStateIncluded, currentUser, customState, err_2;\n\n      return __generator(this, function (_b) {\n        switch (_b.label) {\n          case 0:\n            if (this.oAuthFlowInProgress) {\n              logger.debug(\"Skipping URL \" + URL + \" current flow in progress\");\n              return [2\n              /*return*/\n              ];\n            }\n\n            _b.label = 1;\n\n          case 1:\n            _b.trys.push([1,, 8, 9]);\n\n            this.oAuthFlowInProgress = true;\n\n            if (!this._config.userPoolId) {\n              throw new Error(\"OAuth responses require a User Pool defined in config\");\n            }\n\n            dispatchAuthEvent('parsingCallbackUrl', {\n              url: URL\n            }, \"The callback url is being parsed\");\n            currentUrl = URL || (JS.browserOrNode().isBrowser ? window.location.href : '');\n            hasCodeOrError = !!(parse(currentUrl).query || '').split('&').map(function (entry) {\n              return entry.split('=');\n            }).find(function (_a) {\n              var _b = __read(_a, 1),\n                  k = _b[0];\n\n              return k === 'code' || k === 'error';\n            });\n            hasTokenOrError = !!(parse(currentUrl).hash || '#').substr(1).split('&').map(function (entry) {\n              return entry.split('=');\n            }).find(function (_a) {\n              var _b = __read(_a, 1),\n                  k = _b[0];\n\n              return k === 'access_token' || k === 'error';\n            });\n            if (!(hasCodeOrError || hasTokenOrError)) return [3\n            /*break*/\n            , 7];\n\n            this._storage.setItem('amplify-redirected-from-hosted-ui', 'true');\n\n            _b.label = 2;\n\n          case 2:\n            _b.trys.push([2, 6,, 7]);\n\n            return [4\n            /*yield*/\n            , this._oAuthHandler.handleAuthResponse(currentUrl)];\n\n          case 3:\n            _a = _b.sent(), accessToken = _a.accessToken, idToken = _a.idToken, refreshToken = _a.refreshToken, state = _a.state;\n            session = new CognitoUserSession({\n              IdToken: new CognitoIdToken({\n                IdToken: idToken\n              }),\n              RefreshToken: new CognitoRefreshToken({\n                RefreshToken: refreshToken\n              }),\n              AccessToken: new CognitoAccessToken({\n                AccessToken: accessToken\n              })\n            });\n            credentials = void 0;\n            if (!this._config.identityPoolId) return [3\n            /*break*/\n            , 5];\n            return [4\n            /*yield*/\n            , this.Credentials.set(session, 'session')];\n\n          case 4:\n            credentials = _b.sent();\n            logger.debug('AWS credentials', credentials);\n            _b.label = 5;\n\n          case 5:\n            isCustomStateIncluded = /-/.test(state);\n            currentUser = this.createCognitoUser(session.getIdToken().decodePayload()['cognito:username']); // This calls cacheTokens() in Cognito SDK\n\n            currentUser.setSignInUserSession(session);\n\n            if (window && typeof window.history !== 'undefined') {\n              window.history.replaceState({}, null, this._config.oauth.redirectSignIn);\n            }\n\n            dispatchAuthEvent('signIn', currentUser, \"A user \" + currentUser.getUsername() + \" has been signed in\");\n            dispatchAuthEvent('cognitoHostedUI', currentUser, \"A user \" + currentUser.getUsername() + \" has been signed in via Cognito Hosted UI\");\n\n            if (isCustomStateIncluded) {\n              customState = state.split('-').splice(1).join('-');\n              dispatchAuthEvent('customOAuthState', urlSafeDecode(customState), \"State for user \" + currentUser.getUsername());\n            } //#endregion\n\n\n            return [2\n            /*return*/\n            , credentials];\n\n          case 6:\n            err_2 = _b.sent();\n            logger.debug('Error in cognito hosted auth response', err_2);\n            dispatchAuthEvent('signIn_failure', err_2, \"The OAuth response flow failed\");\n            dispatchAuthEvent('cognitoHostedUI_failure', err_2, \"A failure occurred when returning to the Cognito Hosted UI\");\n            dispatchAuthEvent('customState_failure', err_2, \"A failure occurred when returning state\");\n            return [3\n            /*break*/\n            , 7];\n\n          case 7:\n            return [3\n            /*break*/\n            , 9];\n\n          case 8:\n            this.oAuthFlowInProgress = false;\n            return [7\n            /*endfinally*/\n            ];\n\n          case 9:\n            return [2\n            /*return*/\n            ];\n        }\n      });\n    });\n  };\n  /**\n   * Compact version of credentials\n   * @param {Object} credentials\n   * @return {Object} - Credentials\n   */\n\n\n  AuthClass.prototype.essentialCredentials = function (credentials) {\n    return {\n      accessKeyId: credentials.accessKeyId,\n      sessionToken: credentials.sessionToken,\n      secretAccessKey: credentials.secretAccessKey,\n      identityId: credentials.identityId,\n      authenticated: credentials.authenticated\n    };\n  };\n\n  AuthClass.prototype.attributesToObject = function (attributes) {\n    var obj = {};\n\n    if (attributes) {\n      attributes.map(function (attribute) {\n        if (attribute.Name === 'email_verified' || attribute.Name === 'phone_number_verified') {\n          obj[attribute.Name] = attribute.Value === 'true' || attribute.Value === true;\n        } else {\n          obj[attribute.Name] = attribute.Value;\n        }\n      });\n    }\n\n    return obj;\n  };\n\n  AuthClass.prototype.createCognitoUser = function (username) {\n    var userData = {\n      Username: username,\n      Pool: this.userPool\n    };\n    userData.Storage = this._storage;\n    var authenticationFlowType = this._config.authenticationFlowType;\n    var user = new CognitoUser(userData);\n\n    if (authenticationFlowType) {\n      user.setAuthenticationFlowType(authenticationFlowType);\n    }\n\n    return user;\n  };\n\n  AuthClass.prototype._isValidAuthStorage = function (obj) {\n    // We need to check if the obj has the functions of Storage\n    return !!obj && typeof obj.getItem === 'function' && typeof obj.setItem === 'function' && typeof obj.removeItem === 'function' && typeof obj.clear === 'function';\n  };\n\n  AuthClass.prototype.noUserPoolErrorHandler = function (config) {\n    if (config) {\n      if (!config.userPoolId || !config.identityPoolId) {\n        return AuthErrorTypes.MissingAuthConfig;\n      }\n    }\n\n    return AuthErrorTypes.NoConfig;\n  };\n\n  AuthClass.prototype.rejectAuthError = function (type) {\n    return Promise.reject(new AuthError(type));\n  };\n\n  AuthClass.prototype.rejectNoUserPool = function () {\n    var type = this.noUserPoolErrorHandler(this._config);\n    return Promise.reject(new NoUserPoolError(type));\n  };\n\n  return AuthClass;\n}();\n\nexport { AuthClass };\nexport var Auth = new AuthClass(null);\nAmplify.register(Auth);","/*\n * Copyright 2017-2019 Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\"). You may not use this file except in compliance with\n * the License. A copy of the License is located at\n *\n *     http://aws.amazon.com/apache2.0/\n *\n * or in the \"license\" file accompanying this file. This file is distributed on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR\n * CONDITIONS OF ANY KIND, either express or implied. See the License for the specific language governing permissions\n * and limitations under the License.\n */\nimport { JS } from '@aws-amplify/core';\nexport default (function (callback) {\n  if (JS.browserOrNode().isBrowser && window.location) {\n    var url = window.location.href;\n    callback({\n      url: url\n    });\n  } else if (JS.browserOrNode().isNode) {\n    // continue building on ssr\n    (function () {}); // noop\n\n  } else {\n    throw new Error('Not supported');\n  }\n});","var crypto; // Native crypto from window (Browser)\n\nif (typeof window !== 'undefined' && window.crypto) {\n  crypto = window.crypto;\n} // Native (experimental IE 11) crypto from window (Browser)\n\n\nif (!crypto && typeof window !== 'undefined' && window.msCrypto) {\n  crypto = window.msCrypto;\n} // Native crypto from global (NodeJS)\n\n\nif (!crypto && typeof global !== 'undefined' && global.crypto) {\n  crypto = global.crypto;\n} // Native crypto import via require (NodeJS)\n\n\nif (!crypto && typeof require === 'function') {\n  try {\n    crypto = require('crypto');\n  } catch (err) {}\n}\n/*\n * Cryptographically secure pseudorandom number generator\n * As Math.random() is cryptographically not safe to use\n */\n\n\nexport default function cryptoSecureRandomInt() {\n  if (crypto) {\n    // Use getRandomValues method (Browser)\n    if (typeof crypto.getRandomValues === 'function') {\n      try {\n        return crypto.getRandomValues(new Uint32Array(1))[0];\n      } catch (err) {}\n    } // Use randomBytes method (NodeJS)\n\n\n    if (typeof crypto.randomBytes === 'function') {\n      try {\n        return crypto.randomBytes(4).readInt32LE();\n      } catch (err) {}\n    }\n  }\n\n  throw new Error('Native crypto module could not be used to get secure random number.');\n}","/*\n * Copyright 2017-2017 Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\"). You may not use this file except in compliance with\n * the License. A copy of the License is located at\n *\n *     http://aws.amazon.com/apache2.0/\n *\n * or in the \"license\" file accompanying this file. This file is distributed on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR\n * CONDITIONS OF ANY KIND, either express or implied. See the License for the specific language governing permissions\n * and limitations under the License.\n */\nexport var CognitoHostedUIIdentityProvider;\n\n(function (CognitoHostedUIIdentityProvider) {\n  CognitoHostedUIIdentityProvider[\"Cognito\"] = \"COGNITO\";\n  CognitoHostedUIIdentityProvider[\"Google\"] = \"Google\";\n  CognitoHostedUIIdentityProvider[\"Facebook\"] = \"Facebook\";\n  CognitoHostedUIIdentityProvider[\"Amazon\"] = \"LoginWithAmazon\";\n  CognitoHostedUIIdentityProvider[\"Apple\"] = \"SignInWithApple\";\n})(CognitoHostedUIIdentityProvider || (CognitoHostedUIIdentityProvider = {}));\n\nexport function isFederatedSignInOptions(obj) {\n  var keys = ['provider'];\n  return obj && !!keys.find(function (k) {\n    return obj.hasOwnProperty(k);\n  });\n}\nexport function isFederatedSignInOptionsCustom(obj) {\n  var keys = ['customProvider'];\n  return obj && !!keys.find(function (k) {\n    return obj.hasOwnProperty(k);\n  });\n}\nexport function hasCustomState(obj) {\n  var keys = ['customState'];\n  return obj && !!keys.find(function (k) {\n    return obj.hasOwnProperty(k);\n  });\n}\nexport function isCognitoHostedOpts(oauth) {\n  return oauth.redirectSignIn !== undefined;\n}\nexport var AuthErrorTypes;\n\n(function (AuthErrorTypes) {\n  AuthErrorTypes[\"NoConfig\"] = \"noConfig\";\n  AuthErrorTypes[\"MissingAuthConfig\"] = \"missingAuthConfig\";\n  AuthErrorTypes[\"EmptyUsername\"] = \"emptyUsername\";\n  AuthErrorTypes[\"InvalidUsername\"] = \"invalidUsername\";\n  AuthErrorTypes[\"EmptyPassword\"] = \"emptyPassword\";\n  AuthErrorTypes[\"EmptyCode\"] = \"emptyCode\";\n  AuthErrorTypes[\"SignUpError\"] = \"signUpError\";\n  AuthErrorTypes[\"NoMFA\"] = \"noMFA\";\n  AuthErrorTypes[\"InvalidMFA\"] = \"invalidMFA\";\n  AuthErrorTypes[\"EmptyChallengeResponse\"] = \"emptyChallengeResponse\";\n  AuthErrorTypes[\"NoUserSession\"] = \"noUserSession\";\n  AuthErrorTypes[\"Default\"] = \"default\";\n})(AuthErrorTypes || (AuthErrorTypes = {}));\n\nexport function isUsernamePasswordOpts(obj) {\n  return !!obj.username;\n}","// TODO: Move these values to or extract them from the Cognito Provider in the Auth category for Auth V2\nvar AuthState;\n\n(function (AuthState) {\n  AuthState[\"SignUp\"] = \"signup\";\n  AuthState[\"SignOut\"] = \"signout\";\n  AuthState[\"SignIn\"] = \"signin\";\n  AuthState[\"Loading\"] = \"loading\";\n  AuthState[\"SignedOut\"] = \"signedout\";\n  AuthState[\"SignedIn\"] = \"signedin\";\n  AuthState[\"SigningUp\"] = \"signingup\";\n  AuthState[\"ConfirmSignUp\"] = \"confirmSignUp\";\n  AuthState[\"confirmingSignUpCustomFlow\"] = \"confirmsignupcustomflow\";\n  AuthState[\"ConfirmSignIn\"] = \"confirmSignIn\";\n  AuthState[\"confirmingSignInCustomFlow\"] = \"confirmingsignincustomflow\";\n  AuthState[\"VerifyingAttributes\"] = \"verifyingattributes\";\n  AuthState[\"ForgotPassword\"] = \"forgotpassword\";\n  AuthState[\"ResetPassword\"] = \"resettingpassword\";\n  AuthState[\"SettingMFA\"] = \"settingMFA\";\n  AuthState[\"TOTPSetup\"] = \"TOTPSetup\";\n  AuthState[\"CustomConfirmSignIn\"] = \"customConfirmSignIn\";\n  AuthState[\"VerifyContact\"] = \"verifyContact\";\n})(AuthState || (AuthState = {}));\n\nvar MfaOption;\n\n(function (MfaOption) {\n  MfaOption[\"TOTP\"] = \"TOTP\";\n  MfaOption[\"SMS\"] = \"SMS\";\n  MfaOption[\"NOMFA\"] = \"NOMFA\";\n})(MfaOption || (MfaOption = {}));\n\nvar ChallengeName;\n\n(function (ChallengeName) {\n  ChallengeName[\"SoftwareTokenMFA\"] = \"SOFTWARE_TOKEN_MFA\";\n  ChallengeName[\"SMSMFA\"] = \"SMS_MFA\";\n  ChallengeName[\"NewPasswordRequired\"] = \"NEW_PASSWORD_REQUIRED\";\n  ChallengeName[\"MFASetup\"] = \"MFA_SETUP\";\n  ChallengeName[\"CustomChallenge\"] = \"CUSTOM_CHALLENGE\";\n})(ChallengeName || (ChallengeName = {}));\n\nvar AuthFormField;\n\n(function (AuthFormField) {\n  AuthFormField[\"Password\"] = \"password\";\n})(AuthFormField || (AuthFormField = {}));\n\nvar UsernameAlias;\n\n(function (UsernameAlias) {\n  UsernameAlias[\"username\"] = \"username\";\n  UsernameAlias[\"email\"] = \"email\";\n  UsernameAlias[\"phone_number\"] = \"phone_number\";\n})(UsernameAlias || (UsernameAlias = {}));\n\nexport { AuthState as A, ChallengeName as C, MfaOption as M, UsernameAlias as U, AuthFormField as a };","/*!\n * Copyright 2016 Amazon.com,\n * Inc. or its affiliates. All Rights Reserved.\n *\n * Licensed under the Amazon Software License (the \"License\").\n * You may not use this file except in compliance with the\n * License. A copy of the License is located at\n *\n *     http://aws.amazon.com/asl/\n *\n * or in the \"license\" file accompanying this file. This file is\n * distributed on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR\n * CONDITIONS OF ANY KIND, express or implied. See the License\n * for the specific language governing permissions and\n * limitations under the License.\n */\n\n/** @class */\nvar AuthenticationDetails = /*#__PURE__*/function () {\n  /**\n   * Constructs a new AuthenticationDetails object\n   * @param {object=} data Creation options.\n   * @param {string} data.Username User being authenticated.\n   * @param {string} data.Password Plain-text password to authenticate with.\n   * @param {(AttributeArg[])?} data.ValidationData Application extra metadata.\n   * @param {(AttributeArg[])?} data.AuthParamaters Authentication paramaters for custom auth.\n   */\n  function AuthenticationDetails(data) {\n    var _ref = data || {},\n        ValidationData = _ref.ValidationData,\n        Username = _ref.Username,\n        Password = _ref.Password,\n        AuthParameters = _ref.AuthParameters,\n        ClientMetadata = _ref.ClientMetadata;\n\n    this.validationData = ValidationData || {};\n    this.authParameters = AuthParameters || {};\n    this.clientMetadata = ClientMetadata || {};\n    this.username = Username;\n    this.password = Password;\n  }\n  /**\n   * @returns {string} the record's username\n   */\n\n\n  var _proto = AuthenticationDetails.prototype;\n\n  _proto.getUsername = function getUsername() {\n    return this.username;\n  }\n  /**\n   * @returns {string} the record's password\n   */\n  ;\n\n  _proto.getPassword = function getPassword() {\n    return this.password;\n  }\n  /**\n   * @returns {Array} the record's validationData\n   */\n  ;\n\n  _proto.getValidationData = function getValidationData() {\n    return this.validationData;\n  }\n  /**\n   * @returns {Array} the record's authParameters\n   */\n  ;\n\n  _proto.getAuthParameters = function getAuthParameters() {\n    return this.authParameters;\n  }\n  /**\n   * @returns {ClientMetadata} the clientMetadata for a Lambda trigger\n   */\n  ;\n\n  _proto.getClientMetadata = function getClientMetadata() {\n    return this.clientMetadata;\n  };\n\n  return AuthenticationDetails;\n}();\n\nexport { AuthenticationDetails as default };","import cryptoSecureRandomInt from './cryptoSecureRandomInt';\n/**\n * Hex encoding strategy.\n * Converts a word array to a hex string.\n * @param {WordArray} wordArray The word array.\n * @return {string} The hex string.\n * @static\n */\n\nfunction hexStringify(wordArray) {\n  // Shortcuts\n  var words = wordArray.words;\n  var sigBytes = wordArray.sigBytes; // Convert\n\n  var hexChars = [];\n\n  for (var i = 0; i < sigBytes; i++) {\n    var bite = words[i >>> 2] >>> 24 - i % 4 * 8 & 0xff;\n    hexChars.push((bite >>> 4).toString(16));\n    hexChars.push((bite & 0x0f).toString(16));\n  }\n\n  return hexChars.join('');\n}\n\nvar WordArray = /*#__PURE__*/function () {\n  function WordArray(words, sigBytes) {\n    words = this.words = words || [];\n\n    if (sigBytes != undefined) {\n      this.sigBytes = sigBytes;\n    } else {\n      this.sigBytes = words.length * 4;\n    }\n  }\n\n  var _proto = WordArray.prototype;\n\n  _proto.random = function random(nBytes) {\n    var words = [];\n\n    for (var i = 0; i < nBytes; i += 4) {\n      words.push(cryptoSecureRandomInt());\n    }\n\n    return new WordArray(words, nBytes);\n  };\n\n  _proto.toString = function toString() {\n    return hexStringify(this);\n  };\n\n  return WordArray;\n}();\n\nexport { WordArray as default };","// A small implementation of BigInteger based on http://www-cs-students.stanford.edu/~tjw/jsbn/\n//\n// All public methods have been removed except the following:\n//   new BigInteger(a, b) (only radix 2, 4, 8, 16 and 32 supported)\n//   toString (only radix 2, 4, 8, 16 and 32 supported)\n//   negate\n//   abs\n//   compareTo\n//   bitLength\n//   mod\n//   equals\n//   add\n//   subtract\n//   multiply\n//   divide\n//   modPow\nexport default BigInteger;\n/*\n * Copyright (c) 2003-2005  Tom Wu\n * All Rights Reserved.\n *\n * Permission is hereby granted, free of charge, to any person obtaining\n * a copy of this software and associated documentation files (the\n * \"Software\"), to deal in the Software without restriction, including\n * without limitation the rights to use, copy, modify, merge, publish,\n * distribute, sublicense, and/or sell copies of the Software, and to\n * permit persons to whom the Software is furnished to do so, subject to\n * the following conditions:\n *\n * The above copyright notice and this permission notice shall be\n * included in all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS-IS\" AND WITHOUT WARRANTY OF ANY KIND,\n * EXPRESS, IMPLIED OR OTHERWISE, INCLUDING WITHOUT LIMITATION, ANY\n * WARRANTY OF MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE.\n *\n * IN NO EVENT SHALL TOM WU BE LIABLE FOR ANY SPECIAL, INCIDENTAL,\n * INDIRECT OR CONSEQUENTIAL DAMAGES OF ANY KIND, OR ANY DAMAGES WHATSOEVER\n * RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER OR NOT ADVISED OF\n * THE POSSIBILITY OF DAMAGE, AND ON ANY THEORY OF LIABILITY, ARISING OUT\n * OF OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.\n *\n * In addition, the following condition applies:\n *\n * All redistributions must retain an intact copy of this copyright notice\n * and disclaimer.\n */\n// (public) Constructor\n\nfunction BigInteger(a, b) {\n  if (a != null) this.fromString(a, b);\n} // return new, unset BigInteger\n\n\nfunction nbi() {\n  return new BigInteger(null);\n} // Bits per digit\n\n\nvar dbits; // JavaScript engine analysis\n\nvar canary = 0xdeadbeefcafe;\nvar j_lm = (canary & 0xffffff) == 0xefcafe; // am: Compute w_j += (x*this_i), propagate carries,\n// c is initial carry, returns final carry.\n// c < 3*dvalue, x < 2*dvalue, this_i < dvalue\n// We need to select the fastest one that works in this environment.\n// am1: use a single mult and divide to get the high bits,\n// max digit bits should be 26 because\n// max internal value = 2*dvalue^2-2*dvalue (< 2^53)\n\nfunction am1(i, x, w, j, c, n) {\n  while (--n >= 0) {\n    var v = x * this[i++] + w[j] + c;\n    c = Math.floor(v / 0x4000000);\n    w[j++] = v & 0x3ffffff;\n  }\n\n  return c;\n} // am2 avoids a big mult-and-extract completely.\n// Max digit bits should be <= 30 because we do bitwise ops\n// on values up to 2*hdvalue^2-hdvalue-1 (< 2^31)\n\n\nfunction am2(i, x, w, j, c, n) {\n  var xl = x & 0x7fff,\n      xh = x >> 15;\n\n  while (--n >= 0) {\n    var l = this[i] & 0x7fff;\n    var h = this[i++] >> 15;\n    var m = xh * l + h * xl;\n    l = xl * l + ((m & 0x7fff) << 15) + w[j] + (c & 0x3fffffff);\n    c = (l >>> 30) + (m >>> 15) + xh * h + (c >>> 30);\n    w[j++] = l & 0x3fffffff;\n  }\n\n  return c;\n} // Alternately, set max digit bits to 28 since some\n// browsers slow down when dealing with 32-bit numbers.\n\n\nfunction am3(i, x, w, j, c, n) {\n  var xl = x & 0x3fff,\n      xh = x >> 14;\n\n  while (--n >= 0) {\n    var l = this[i] & 0x3fff;\n    var h = this[i++] >> 14;\n    var m = xh * l + h * xl;\n    l = xl * l + ((m & 0x3fff) << 14) + w[j] + c;\n    c = (l >> 28) + (m >> 14) + xh * h;\n    w[j++] = l & 0xfffffff;\n  }\n\n  return c;\n}\n\nvar inBrowser = typeof navigator !== 'undefined';\n\nif (inBrowser && j_lm && navigator.appName == 'Microsoft Internet Explorer') {\n  BigInteger.prototype.am = am2;\n  dbits = 30;\n} else if (inBrowser && j_lm && navigator.appName != 'Netscape') {\n  BigInteger.prototype.am = am1;\n  dbits = 26;\n} else {\n  // Mozilla/Netscape seems to prefer am3\n  BigInteger.prototype.am = am3;\n  dbits = 28;\n}\n\nBigInteger.prototype.DB = dbits;\nBigInteger.prototype.DM = (1 << dbits) - 1;\nBigInteger.prototype.DV = 1 << dbits;\nvar BI_FP = 52;\nBigInteger.prototype.FV = Math.pow(2, BI_FP);\nBigInteger.prototype.F1 = BI_FP - dbits;\nBigInteger.prototype.F2 = 2 * dbits - BI_FP; // Digit conversions\n\nvar BI_RM = '0123456789abcdefghijklmnopqrstuvwxyz';\nvar BI_RC = new Array();\nvar rr, vv;\nrr = '0'.charCodeAt(0);\n\nfor (vv = 0; vv <= 9; ++vv) {\n  BI_RC[rr++] = vv;\n}\n\nrr = 'a'.charCodeAt(0);\n\nfor (vv = 10; vv < 36; ++vv) {\n  BI_RC[rr++] = vv;\n}\n\nrr = 'A'.charCodeAt(0);\n\nfor (vv = 10; vv < 36; ++vv) {\n  BI_RC[rr++] = vv;\n}\n\nfunction int2char(n) {\n  return BI_RM.charAt(n);\n}\n\nfunction intAt(s, i) {\n  var c = BI_RC[s.charCodeAt(i)];\n  return c == null ? -1 : c;\n} // (protected) copy this to r\n\n\nfunction bnpCopyTo(r) {\n  for (var i = this.t - 1; i >= 0; --i) {\n    r[i] = this[i];\n  }\n\n  r.t = this.t;\n  r.s = this.s;\n} // (protected) set from integer value x, -DV <= x < DV\n\n\nfunction bnpFromInt(x) {\n  this.t = 1;\n  this.s = x < 0 ? -1 : 0;\n  if (x > 0) this[0] = x;else if (x < -1) this[0] = x + this.DV;else this.t = 0;\n} // return bigint initialized to value\n\n\nfunction nbv(i) {\n  var r = nbi();\n  r.fromInt(i);\n  return r;\n} // (protected) set from string and radix\n\n\nfunction bnpFromString(s, b) {\n  var k;\n  if (b == 16) k = 4;else if (b == 8) k = 3;else if (b == 2) k = 1;else if (b == 32) k = 5;else if (b == 4) k = 2;else throw new Error('Only radix 2, 4, 8, 16, 32 are supported');\n  this.t = 0;\n  this.s = 0;\n  var i = s.length,\n      mi = false,\n      sh = 0;\n\n  while (--i >= 0) {\n    var x = intAt(s, i);\n\n    if (x < 0) {\n      if (s.charAt(i) == '-') mi = true;\n      continue;\n    }\n\n    mi = false;\n    if (sh == 0) this[this.t++] = x;else if (sh + k > this.DB) {\n      this[this.t - 1] |= (x & (1 << this.DB - sh) - 1) << sh;\n      this[this.t++] = x >> this.DB - sh;\n    } else this[this.t - 1] |= x << sh;\n    sh += k;\n    if (sh >= this.DB) sh -= this.DB;\n  }\n\n  this.clamp();\n  if (mi) BigInteger.ZERO.subTo(this, this);\n} // (protected) clamp off excess high words\n\n\nfunction bnpClamp() {\n  var c = this.s & this.DM;\n\n  while (this.t > 0 && this[this.t - 1] == c) {\n    --this.t;\n  }\n} // (public) return string representation in given radix\n\n\nfunction bnToString(b) {\n  if (this.s < 0) return '-' + this.negate().toString(b);\n  var k;\n  if (b == 16) k = 4;else if (b == 8) k = 3;else if (b == 2) k = 1;else if (b == 32) k = 5;else if (b == 4) k = 2;else throw new Error('Only radix 2, 4, 8, 16, 32 are supported');\n  var km = (1 << k) - 1,\n      d,\n      m = false,\n      r = '',\n      i = this.t;\n  var p = this.DB - i * this.DB % k;\n\n  if (i-- > 0) {\n    if (p < this.DB && (d = this[i] >> p) > 0) {\n      m = true;\n      r = int2char(d);\n    }\n\n    while (i >= 0) {\n      if (p < k) {\n        d = (this[i] & (1 << p) - 1) << k - p;\n        d |= this[--i] >> (p += this.DB - k);\n      } else {\n        d = this[i] >> (p -= k) & km;\n\n        if (p <= 0) {\n          p += this.DB;\n          --i;\n        }\n      }\n\n      if (d > 0) m = true;\n      if (m) r += int2char(d);\n    }\n  }\n\n  return m ? r : '0';\n} // (public) -this\n\n\nfunction bnNegate() {\n  var r = nbi();\n  BigInteger.ZERO.subTo(this, r);\n  return r;\n} // (public) |this|\n\n\nfunction bnAbs() {\n  return this.s < 0 ? this.negate() : this;\n} // (public) return + if this > a, - if this < a, 0 if equal\n\n\nfunction bnCompareTo(a) {\n  var r = this.s - a.s;\n  if (r != 0) return r;\n  var i = this.t;\n  r = i - a.t;\n  if (r != 0) return this.s < 0 ? -r : r;\n\n  while (--i >= 0) {\n    if ((r = this[i] - a[i]) != 0) return r;\n  }\n\n  return 0;\n} // returns bit length of the integer x\n\n\nfunction nbits(x) {\n  var r = 1,\n      t;\n\n  if ((t = x >>> 16) != 0) {\n    x = t;\n    r += 16;\n  }\n\n  if ((t = x >> 8) != 0) {\n    x = t;\n    r += 8;\n  }\n\n  if ((t = x >> 4) != 0) {\n    x = t;\n    r += 4;\n  }\n\n  if ((t = x >> 2) != 0) {\n    x = t;\n    r += 2;\n  }\n\n  if ((t = x >> 1) != 0) {\n    x = t;\n    r += 1;\n  }\n\n  return r;\n} // (public) return the number of bits in \"this\"\n\n\nfunction bnBitLength() {\n  if (this.t <= 0) return 0;\n  return this.DB * (this.t - 1) + nbits(this[this.t - 1] ^ this.s & this.DM);\n} // (protected) r = this << n*DB\n\n\nfunction bnpDLShiftTo(n, r) {\n  var i;\n\n  for (i = this.t - 1; i >= 0; --i) {\n    r[i + n] = this[i];\n  }\n\n  for (i = n - 1; i >= 0; --i) {\n    r[i] = 0;\n  }\n\n  r.t = this.t + n;\n  r.s = this.s;\n} // (protected) r = this >> n*DB\n\n\nfunction bnpDRShiftTo(n, r) {\n  for (var i = n; i < this.t; ++i) {\n    r[i - n] = this[i];\n  }\n\n  r.t = Math.max(this.t - n, 0);\n  r.s = this.s;\n} // (protected) r = this << n\n\n\nfunction bnpLShiftTo(n, r) {\n  var bs = n % this.DB;\n  var cbs = this.DB - bs;\n  var bm = (1 << cbs) - 1;\n  var ds = Math.floor(n / this.DB),\n      c = this.s << bs & this.DM,\n      i;\n\n  for (i = this.t - 1; i >= 0; --i) {\n    r[i + ds + 1] = this[i] >> cbs | c;\n    c = (this[i] & bm) << bs;\n  }\n\n  for (i = ds - 1; i >= 0; --i) {\n    r[i] = 0;\n  }\n\n  r[ds] = c;\n  r.t = this.t + ds + 1;\n  r.s = this.s;\n  r.clamp();\n} // (protected) r = this >> n\n\n\nfunction bnpRShiftTo(n, r) {\n  r.s = this.s;\n  var ds = Math.floor(n / this.DB);\n\n  if (ds >= this.t) {\n    r.t = 0;\n    return;\n  }\n\n  var bs = n % this.DB;\n  var cbs = this.DB - bs;\n  var bm = (1 << bs) - 1;\n  r[0] = this[ds] >> bs;\n\n  for (var i = ds + 1; i < this.t; ++i) {\n    r[i - ds - 1] |= (this[i] & bm) << cbs;\n    r[i - ds] = this[i] >> bs;\n  }\n\n  if (bs > 0) r[this.t - ds - 1] |= (this.s & bm) << cbs;\n  r.t = this.t - ds;\n  r.clamp();\n} // (protected) r = this - a\n\n\nfunction bnpSubTo(a, r) {\n  var i = 0,\n      c = 0,\n      m = Math.min(a.t, this.t);\n\n  while (i < m) {\n    c += this[i] - a[i];\n    r[i++] = c & this.DM;\n    c >>= this.DB;\n  }\n\n  if (a.t < this.t) {\n    c -= a.s;\n\n    while (i < this.t) {\n      c += this[i];\n      r[i++] = c & this.DM;\n      c >>= this.DB;\n    }\n\n    c += this.s;\n  } else {\n    c += this.s;\n\n    while (i < a.t) {\n      c -= a[i];\n      r[i++] = c & this.DM;\n      c >>= this.DB;\n    }\n\n    c -= a.s;\n  }\n\n  r.s = c < 0 ? -1 : 0;\n  if (c < -1) r[i++] = this.DV + c;else if (c > 0) r[i++] = c;\n  r.t = i;\n  r.clamp();\n} // (protected) r = this * a, r != this,a (HAC 14.12)\n// \"this\" should be the larger one if appropriate.\n\n\nfunction bnpMultiplyTo(a, r) {\n  var x = this.abs(),\n      y = a.abs();\n  var i = x.t;\n  r.t = i + y.t;\n\n  while (--i >= 0) {\n    r[i] = 0;\n  }\n\n  for (i = 0; i < y.t; ++i) {\n    r[i + x.t] = x.am(0, y[i], r, i, 0, x.t);\n  }\n\n  r.s = 0;\n  r.clamp();\n  if (this.s != a.s) BigInteger.ZERO.subTo(r, r);\n} // (protected) r = this^2, r != this (HAC 14.16)\n\n\nfunction bnpSquareTo(r) {\n  var x = this.abs();\n  var i = r.t = 2 * x.t;\n\n  while (--i >= 0) {\n    r[i] = 0;\n  }\n\n  for (i = 0; i < x.t - 1; ++i) {\n    var c = x.am(i, x[i], r, 2 * i, 0, 1);\n\n    if ((r[i + x.t] += x.am(i + 1, 2 * x[i], r, 2 * i + 1, c, x.t - i - 1)) >= x.DV) {\n      r[i + x.t] -= x.DV;\n      r[i + x.t + 1] = 1;\n    }\n  }\n\n  if (r.t > 0) r[r.t - 1] += x.am(i, x[i], r, 2 * i, 0, 1);\n  r.s = 0;\n  r.clamp();\n} // (protected) divide this by m, quotient and remainder to q, r (HAC 14.20)\n// r != q, this != m.  q or r may be null.\n\n\nfunction bnpDivRemTo(m, q, r) {\n  var pm = m.abs();\n  if (pm.t <= 0) return;\n  var pt = this.abs();\n\n  if (pt.t < pm.t) {\n    if (q != null) q.fromInt(0);\n    if (r != null) this.copyTo(r);\n    return;\n  }\n\n  if (r == null) r = nbi();\n  var y = nbi(),\n      ts = this.s,\n      ms = m.s;\n  var nsh = this.DB - nbits(pm[pm.t - 1]); // normalize modulus\n\n  if (nsh > 0) {\n    pm.lShiftTo(nsh, y);\n    pt.lShiftTo(nsh, r);\n  } else {\n    pm.copyTo(y);\n    pt.copyTo(r);\n  }\n\n  var ys = y.t;\n  var y0 = y[ys - 1];\n  if (y0 == 0) return;\n  var yt = y0 * (1 << this.F1) + (ys > 1 ? y[ys - 2] >> this.F2 : 0);\n  var d1 = this.FV / yt,\n      d2 = (1 << this.F1) / yt,\n      e = 1 << this.F2;\n  var i = r.t,\n      j = i - ys,\n      t = q == null ? nbi() : q;\n  y.dlShiftTo(j, t);\n\n  if (r.compareTo(t) >= 0) {\n    r[r.t++] = 1;\n    r.subTo(t, r);\n  }\n\n  BigInteger.ONE.dlShiftTo(ys, t);\n  t.subTo(y, y); // \"negative\" y so we can replace sub with am later\n\n  while (y.t < ys) {\n    y[y.t++] = 0;\n  }\n\n  while (--j >= 0) {\n    // Estimate quotient digit\n    var qd = r[--i] == y0 ? this.DM : Math.floor(r[i] * d1 + (r[i - 1] + e) * d2);\n\n    if ((r[i] += y.am(0, qd, r, j, 0, ys)) < qd) {\n      // Try it out\n      y.dlShiftTo(j, t);\n      r.subTo(t, r);\n\n      while (r[i] < --qd) {\n        r.subTo(t, r);\n      }\n    }\n  }\n\n  if (q != null) {\n    r.drShiftTo(ys, q);\n    if (ts != ms) BigInteger.ZERO.subTo(q, q);\n  }\n\n  r.t = ys;\n  r.clamp();\n  if (nsh > 0) r.rShiftTo(nsh, r); // Denormalize remainder\n\n  if (ts < 0) BigInteger.ZERO.subTo(r, r);\n} // (public) this mod a\n\n\nfunction bnMod(a) {\n  var r = nbi();\n  this.abs().divRemTo(a, null, r);\n  if (this.s < 0 && r.compareTo(BigInteger.ZERO) > 0) a.subTo(r, r);\n  return r;\n} // (protected) return \"-1/this % 2^DB\"; useful for Mont. reduction\n// justification:\n//         xy == 1 (mod m)\n//         xy =  1+km\n//   xy(2-xy) = (1+km)(1-km)\n// x[y(2-xy)] = 1-k^2m^2\n// x[y(2-xy)] == 1 (mod m^2)\n// if y is 1/x mod m, then y(2-xy) is 1/x mod m^2\n// should reduce x and y(2-xy) by m^2 at each step to keep size bounded.\n// JS multiply \"overflows\" differently from C/C++, so care is needed here.\n\n\nfunction bnpInvDigit() {\n  if (this.t < 1) return 0;\n  var x = this[0];\n  if ((x & 1) == 0) return 0;\n  var y = x & 3; // y == 1/x mod 2^2\n\n  y = y * (2 - (x & 0xf) * y) & 0xf; // y == 1/x mod 2^4\n\n  y = y * (2 - (x & 0xff) * y) & 0xff; // y == 1/x mod 2^8\n\n  y = y * (2 - ((x & 0xffff) * y & 0xffff)) & 0xffff; // y == 1/x mod 2^16\n  // last step - calculate inverse mod DV directly;\n  // assumes 16 < DB <= 32 and assumes ability to handle 48-bit ints\n\n  y = y * (2 - x * y % this.DV) % this.DV; // y == 1/x mod 2^dbits\n  // we really want the negative inverse, and -DV < y < DV\n\n  return y > 0 ? this.DV - y : -y;\n}\n\nfunction bnEquals(a) {\n  return this.compareTo(a) == 0;\n} // (protected) r = this + a\n\n\nfunction bnpAddTo(a, r) {\n  var i = 0,\n      c = 0,\n      m = Math.min(a.t, this.t);\n\n  while (i < m) {\n    c += this[i] + a[i];\n    r[i++] = c & this.DM;\n    c >>= this.DB;\n  }\n\n  if (a.t < this.t) {\n    c += a.s;\n\n    while (i < this.t) {\n      c += this[i];\n      r[i++] = c & this.DM;\n      c >>= this.DB;\n    }\n\n    c += this.s;\n  } else {\n    c += this.s;\n\n    while (i < a.t) {\n      c += a[i];\n      r[i++] = c & this.DM;\n      c >>= this.DB;\n    }\n\n    c += a.s;\n  }\n\n  r.s = c < 0 ? -1 : 0;\n  if (c > 0) r[i++] = c;else if (c < -1) r[i++] = this.DV + c;\n  r.t = i;\n  r.clamp();\n} // (public) this + a\n\n\nfunction bnAdd(a) {\n  var r = nbi();\n  this.addTo(a, r);\n  return r;\n} // (public) this - a\n\n\nfunction bnSubtract(a) {\n  var r = nbi();\n  this.subTo(a, r);\n  return r;\n} // (public) this * a\n\n\nfunction bnMultiply(a) {\n  var r = nbi();\n  this.multiplyTo(a, r);\n  return r;\n} // (public) this / a\n\n\nfunction bnDivide(a) {\n  var r = nbi();\n  this.divRemTo(a, r, null);\n  return r;\n} // Montgomery reduction\n\n\nfunction Montgomery(m) {\n  this.m = m;\n  this.mp = m.invDigit();\n  this.mpl = this.mp & 0x7fff;\n  this.mph = this.mp >> 15;\n  this.um = (1 << m.DB - 15) - 1;\n  this.mt2 = 2 * m.t;\n} // xR mod m\n\n\nfunction montConvert(x) {\n  var r = nbi();\n  x.abs().dlShiftTo(this.m.t, r);\n  r.divRemTo(this.m, null, r);\n  if (x.s < 0 && r.compareTo(BigInteger.ZERO) > 0) this.m.subTo(r, r);\n  return r;\n} // x/R mod m\n\n\nfunction montRevert(x) {\n  var r = nbi();\n  x.copyTo(r);\n  this.reduce(r);\n  return r;\n} // x = x/R mod m (HAC 14.32)\n\n\nfunction montReduce(x) {\n  while (x.t <= this.mt2) {\n    // pad x so am has enough room later\n    x[x.t++] = 0;\n  }\n\n  for (var i = 0; i < this.m.t; ++i) {\n    // faster way of calculating u0 = x[i]*mp mod DV\n    var j = x[i] & 0x7fff;\n    var u0 = j * this.mpl + ((j * this.mph + (x[i] >> 15) * this.mpl & this.um) << 15) & x.DM; // use am to combine the multiply-shift-add into one call\n\n    j = i + this.m.t;\n    x[j] += this.m.am(0, u0, x, i, 0, this.m.t); // propagate carry\n\n    while (x[j] >= x.DV) {\n      x[j] -= x.DV;\n      x[++j]++;\n    }\n  }\n\n  x.clamp();\n  x.drShiftTo(this.m.t, x);\n  if (x.compareTo(this.m) >= 0) x.subTo(this.m, x);\n} // r = \"x^2/R mod m\"; x != r\n\n\nfunction montSqrTo(x, r) {\n  x.squareTo(r);\n  this.reduce(r);\n} // r = \"xy/R mod m\"; x,y != r\n\n\nfunction montMulTo(x, y, r) {\n  x.multiplyTo(y, r);\n  this.reduce(r);\n}\n\nMontgomery.prototype.convert = montConvert;\nMontgomery.prototype.revert = montRevert;\nMontgomery.prototype.reduce = montReduce;\nMontgomery.prototype.mulTo = montMulTo;\nMontgomery.prototype.sqrTo = montSqrTo; // (public) this^e % m (HAC 14.85)\n\nfunction bnModPow(e, m, callback) {\n  var i = e.bitLength(),\n      k,\n      r = nbv(1),\n      z = new Montgomery(m);\n  if (i <= 0) return r;else if (i < 18) k = 1;else if (i < 48) k = 3;else if (i < 144) k = 4;else if (i < 768) k = 5;else k = 6; // precomputation\n\n  var g = new Array(),\n      n = 3,\n      k1 = k - 1,\n      km = (1 << k) - 1;\n  g[1] = z.convert(this);\n\n  if (k > 1) {\n    var g2 = nbi();\n    z.sqrTo(g[1], g2);\n\n    while (n <= km) {\n      g[n] = nbi();\n      z.mulTo(g2, g[n - 2], g[n]);\n      n += 2;\n    }\n  }\n\n  var j = e.t - 1,\n      w,\n      is1 = true,\n      r2 = nbi(),\n      t;\n  i = nbits(e[j]) - 1;\n\n  while (j >= 0) {\n    if (i >= k1) w = e[j] >> i - k1 & km;else {\n      w = (e[j] & (1 << i + 1) - 1) << k1 - i;\n      if (j > 0) w |= e[j - 1] >> this.DB + i - k1;\n    }\n    n = k;\n\n    while ((w & 1) == 0) {\n      w >>= 1;\n      --n;\n    }\n\n    if ((i -= n) < 0) {\n      i += this.DB;\n      --j;\n    }\n\n    if (is1) {\n      // ret == 1, don't bother squaring or multiplying it\n      g[w].copyTo(r);\n      is1 = false;\n    } else {\n      while (n > 1) {\n        z.sqrTo(r, r2);\n        z.sqrTo(r2, r);\n        n -= 2;\n      }\n\n      if (n > 0) z.sqrTo(r, r2);else {\n        t = r;\n        r = r2;\n        r2 = t;\n      }\n      z.mulTo(r2, g[w], r);\n    }\n\n    while (j >= 0 && (e[j] & 1 << i) == 0) {\n      z.sqrTo(r, r2);\n      t = r;\n      r = r2;\n      r2 = t;\n\n      if (--i < 0) {\n        i = this.DB - 1;\n        --j;\n      }\n    }\n  }\n\n  var result = z.revert(r);\n  callback(null, result);\n  return result;\n} // protected\n\n\nBigInteger.prototype.copyTo = bnpCopyTo;\nBigInteger.prototype.fromInt = bnpFromInt;\nBigInteger.prototype.fromString = bnpFromString;\nBigInteger.prototype.clamp = bnpClamp;\nBigInteger.prototype.dlShiftTo = bnpDLShiftTo;\nBigInteger.prototype.drShiftTo = bnpDRShiftTo;\nBigInteger.prototype.lShiftTo = bnpLShiftTo;\nBigInteger.prototype.rShiftTo = bnpRShiftTo;\nBigInteger.prototype.subTo = bnpSubTo;\nBigInteger.prototype.multiplyTo = bnpMultiplyTo;\nBigInteger.prototype.squareTo = bnpSquareTo;\nBigInteger.prototype.divRemTo = bnpDivRemTo;\nBigInteger.prototype.invDigit = bnpInvDigit;\nBigInteger.prototype.addTo = bnpAddTo; // public\n\nBigInteger.prototype.toString = bnToString;\nBigInteger.prototype.negate = bnNegate;\nBigInteger.prototype.abs = bnAbs;\nBigInteger.prototype.compareTo = bnCompareTo;\nBigInteger.prototype.bitLength = bnBitLength;\nBigInteger.prototype.mod = bnMod;\nBigInteger.prototype.equals = bnEquals;\nBigInteger.prototype.add = bnAdd;\nBigInteger.prototype.subtract = bnSubtract;\nBigInteger.prototype.multiply = bnMultiply;\nBigInteger.prototype.divide = bnDivide;\nBigInteger.prototype.modPow = bnModPow; // \"constants\"\n\nBigInteger.ZERO = nbv(0);\nBigInteger.ONE = nbv(1);","/*!\n * Copyright 2016 Amazon.com,\n * Inc. or its affiliates. All Rights Reserved.\n *\n * Licensed under the Amazon Software License (the \"License\").\n * You may not use this file except in compliance with the\n * License. A copy of the License is located at\n *\n *     http://aws.amazon.com/asl/\n *\n * or in the \"license\" file accompanying this file. This file is\n * distributed on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR\n * CONDITIONS OF ANY KIND, express or implied. See the License\n * for the specific language governing permissions and\n * limitations under the License.\n */\nimport { Buffer } from 'buffer';\nimport CryptoJS from 'crypto-js/core';\nimport 'crypto-js/lib-typedarrays'; // necessary for crypto js\n\nimport SHA256 from 'crypto-js/sha256';\nimport HmacSHA256 from 'crypto-js/hmac-sha256';\nimport WordArray from './utils/WordArray';\n\nvar randomBytes = function randomBytes(nBytes) {\n  return Buffer.from(new WordArray().random(nBytes).toString(), 'hex');\n};\n\nimport BigInteger from './BigInteger';\nvar initN = 'FFFFFFFFFFFFFFFFC90FDAA22168C234C4C6628B80DC1CD1' + '29024E088A67CC74020BBEA63B139B22514A08798E3404DD' + 'EF9519B3CD3A431B302B0A6DF25F14374FE1356D6D51C245' + 'E485B576625E7EC6F44C42E9A637ED6B0BFF5CB6F406B7ED' + 'EE386BFB5A899FA5AE9F24117C4B1FE649286651ECE45B3D' + 'C2007CB8A163BF0598DA48361C55D39A69163FA8FD24CF5F' + '83655D23DCA3AD961C62F356208552BB9ED529077096966D' + '670C354E4ABC9804F1746C08CA18217C32905E462E36CE3B' + 'E39E772C180E86039B2783A2EC07A28FB5C55DF06F4C52C9' + 'DE2BCBF6955817183995497CEA956AE515D2261898FA0510' + '15728E5A8AAAC42DAD33170D04507A33A85521ABDF1CBA64' + 'ECFB850458DBEF0A8AEA71575D060C7DB3970F85A6E1E4C7' + 'ABF5AE8CDB0933D71E8C94E04A25619DCEE3D2261AD2EE6B' + 'F12FFA06D98A0864D87602733EC86A64521F2B18177B200C' + 'BBE117577A615D6C770988C0BAD946E208E24FA074E5AB31' + '43DB5BFCE0FD108E4B82D120A93AD2CAFFFFFFFFFFFFFFFF';\nvar newPasswordRequiredChallengeUserAttributePrefix = 'userAttributes.';\n/** @class */\n\nvar AuthenticationHelper = /*#__PURE__*/function () {\n  /**\n   * Constructs a new AuthenticationHelper object\n   * @param {string} PoolName Cognito user pool name.\n   */\n  function AuthenticationHelper(PoolName) {\n    this.N = new BigInteger(initN, 16);\n    this.g = new BigInteger('2', 16);\n    this.k = new BigInteger(this.hexHash(\"00\" + this.N.toString(16) + \"0\" + this.g.toString(16)), 16);\n    this.smallAValue = this.generateRandomSmallA();\n    this.getLargeAValue(function () {});\n    this.infoBits = Buffer.from('Caldera Derived Key', 'utf8');\n    this.poolName = PoolName;\n  }\n  /**\n   * @returns {BigInteger} small A, a random number\n   */\n\n\n  var _proto = AuthenticationHelper.prototype;\n\n  _proto.getSmallAValue = function getSmallAValue() {\n    return this.smallAValue;\n  }\n  /**\n   * @param {nodeCallback<BigInteger>} callback Called with (err, largeAValue)\n   * @returns {void}\n   */\n  ;\n\n  _proto.getLargeAValue = function getLargeAValue(callback) {\n    var _this = this;\n\n    if (this.largeAValue) {\n      callback(null, this.largeAValue);\n    } else {\n      this.calculateA(this.smallAValue, function (err, largeAValue) {\n        if (err) {\n          callback(err, null);\n        }\n\n        _this.largeAValue = largeAValue;\n        callback(null, _this.largeAValue);\n      });\n    }\n  }\n  /**\n   * helper function to generate a random big integer\n   * @returns {BigInteger} a random value.\n   * @private\n   */\n  ;\n\n  _proto.generateRandomSmallA = function generateRandomSmallA() {\n    var hexRandom = randomBytes(128).toString('hex');\n    var randomBigInt = new BigInteger(hexRandom, 16);\n    var smallABigInt = randomBigInt.mod(this.N);\n    return smallABigInt;\n  }\n  /**\n   * helper function to generate a random string\n   * @returns {string} a random value.\n   * @private\n   */\n  ;\n\n  _proto.generateRandomString = function generateRandomString() {\n    return randomBytes(40).toString('base64');\n  }\n  /**\n   * @returns {string} Generated random value included in password hash.\n   */\n  ;\n\n  _proto.getRandomPassword = function getRandomPassword() {\n    return this.randomPassword;\n  }\n  /**\n   * @returns {string} Generated random value included in devices hash.\n   */\n  ;\n\n  _proto.getSaltDevices = function getSaltDevices() {\n    return this.SaltToHashDevices;\n  }\n  /**\n   * @returns {string} Value used to verify devices.\n   */\n  ;\n\n  _proto.getVerifierDevices = function getVerifierDevices() {\n    return this.verifierDevices;\n  }\n  /**\n   * Generate salts and compute verifier.\n   * @param {string} deviceGroupKey Devices to generate verifier for.\n   * @param {string} username User to generate verifier for.\n   * @param {nodeCallback<null>} callback Called with (err, null)\n   * @returns {void}\n   */\n  ;\n\n  _proto.generateHashDevice = function generateHashDevice(deviceGroupKey, username, callback) {\n    var _this2 = this;\n\n    this.randomPassword = this.generateRandomString();\n    var combinedString = \"\" + deviceGroupKey + username + \":\" + this.randomPassword;\n    var hashedString = this.hash(combinedString);\n    var hexRandom = randomBytes(16).toString('hex');\n    this.SaltToHashDevices = this.padHex(new BigInteger(hexRandom, 16));\n    this.g.modPow(new BigInteger(this.hexHash(this.SaltToHashDevices + hashedString), 16), this.N, function (err, verifierDevicesNotPadded) {\n      if (err) {\n        callback(err, null);\n      }\n\n      _this2.verifierDevices = _this2.padHex(verifierDevicesNotPadded);\n      callback(null, null);\n    });\n  }\n  /**\n   * Calculate the client's public value A = g^a%N\n   * with the generated random number a\n   * @param {BigInteger} a Randomly generated small A.\n   * @param {nodeCallback<BigInteger>} callback Called with (err, largeAValue)\n   * @returns {void}\n   * @private\n   */\n  ;\n\n  _proto.calculateA = function calculateA(a, callback) {\n    var _this3 = this;\n\n    this.g.modPow(a, this.N, function (err, A) {\n      if (err) {\n        callback(err, null);\n      }\n\n      if (A.mod(_this3.N).equals(BigInteger.ZERO)) {\n        callback(new Error('Illegal paramater. A mod N cannot be 0.'), null);\n      }\n\n      callback(null, A);\n    });\n  }\n  /**\n   * Calculate the client's value U which is the hash of A and B\n   * @param {BigInteger} A Large A value.\n   * @param {BigInteger} B Server B value.\n   * @returns {BigInteger} Computed U value.\n   * @private\n   */\n  ;\n\n  _proto.calculateU = function calculateU(A, B) {\n    this.UHexHash = this.hexHash(this.padHex(A) + this.padHex(B));\n    var finalU = new BigInteger(this.UHexHash, 16);\n    return finalU;\n  }\n  /**\n   * Calculate a hash from a bitArray\n   * @param {Buffer} buf Value to hash.\n   * @returns {String} Hex-encoded hash.\n   * @private\n   */\n  ;\n\n  _proto.hash = function hash(buf) {\n    var str = buf instanceof Buffer ? CryptoJS.lib.WordArray.create(buf) : buf;\n    var hashHex = SHA256(str).toString();\n    return new Array(64 - hashHex.length).join('0') + hashHex;\n  }\n  /**\n   * Calculate a hash from a hex string\n   * @param {String} hexStr Value to hash.\n   * @returns {String} Hex-encoded hash.\n   * @private\n   */\n  ;\n\n  _proto.hexHash = function hexHash(hexStr) {\n    return this.hash(Buffer.from(hexStr, 'hex'));\n  }\n  /**\n   * Standard hkdf algorithm\n   * @param {Buffer} ikm Input key material.\n   * @param {Buffer} salt Salt value.\n   * @returns {Buffer} Strong key material.\n   * @private\n   */\n  ;\n\n  _proto.computehkdf = function computehkdf(ikm, salt) {\n    var infoBitsWordArray = CryptoJS.lib.WordArray.create(Buffer.concat([this.infoBits, Buffer.from(String.fromCharCode(1), 'utf8')]));\n    var ikmWordArray = ikm instanceof Buffer ? CryptoJS.lib.WordArray.create(ikm) : ikm;\n    var saltWordArray = salt instanceof Buffer ? CryptoJS.lib.WordArray.create(salt) : salt;\n    var prk = HmacSHA256(ikmWordArray, saltWordArray);\n    var hmac = HmacSHA256(infoBitsWordArray, prk);\n    return Buffer.from(hmac.toString(), 'hex').slice(0, 16);\n  }\n  /**\n   * Calculates the final hkdf based on computed S value, and computed U value and the key\n   * @param {String} username Username.\n   * @param {String} password Password.\n   * @param {BigInteger} serverBValue Server B value.\n   * @param {BigInteger} salt Generated salt.\n   * @param {nodeCallback<Buffer>} callback Called with (err, hkdfValue)\n   * @returns {void}\n   */\n  ;\n\n  _proto.getPasswordAuthenticationKey = function getPasswordAuthenticationKey(username, password, serverBValue, salt, callback) {\n    var _this4 = this;\n\n    if (serverBValue.mod(this.N).equals(BigInteger.ZERO)) {\n      throw new Error('B cannot be zero.');\n    }\n\n    this.UValue = this.calculateU(this.largeAValue, serverBValue);\n\n    if (this.UValue.equals(BigInteger.ZERO)) {\n      throw new Error('U cannot be zero.');\n    }\n\n    var usernamePassword = \"\" + this.poolName + username + \":\" + password;\n    var usernamePasswordHash = this.hash(usernamePassword);\n    var xValue = new BigInteger(this.hexHash(this.padHex(salt) + usernamePasswordHash), 16);\n    this.calculateS(xValue, serverBValue, function (err, sValue) {\n      if (err) {\n        callback(err, null);\n      }\n\n      var hkdf = _this4.computehkdf(Buffer.from(_this4.padHex(sValue), 'hex'), Buffer.from(_this4.padHex(_this4.UValue.toString(16)), 'hex'));\n\n      callback(null, hkdf);\n    });\n  }\n  /**\n   * Calculates the S value used in getPasswordAuthenticationKey\n   * @param {BigInteger} xValue Salted password hash value.\n   * @param {BigInteger} serverBValue Server B value.\n   * @param {nodeCallback<string>} callback Called on success or error.\n   * @returns {void}\n   */\n  ;\n\n  _proto.calculateS = function calculateS(xValue, serverBValue, callback) {\n    var _this5 = this;\n\n    this.g.modPow(xValue, this.N, function (err, gModPowXN) {\n      if (err) {\n        callback(err, null);\n      }\n\n      var intValue2 = serverBValue.subtract(_this5.k.multiply(gModPowXN));\n      intValue2.modPow(_this5.smallAValue.add(_this5.UValue.multiply(xValue)), _this5.N, function (err2, result) {\n        if (err2) {\n          callback(err2, null);\n        }\n\n        callback(null, result.mod(_this5.N));\n      });\n    });\n  }\n  /**\n   * Return constant newPasswordRequiredChallengeUserAttributePrefix\n   * @return {newPasswordRequiredChallengeUserAttributePrefix} constant prefix value\n   */\n  ;\n\n  _proto.getNewPasswordRequiredChallengeUserAttributePrefix = function getNewPasswordRequiredChallengeUserAttributePrefix() {\n    return newPasswordRequiredChallengeUserAttributePrefix;\n  }\n  /**\n   * Converts a BigInteger (or hex string) to hex format padded with zeroes for hashing\n   * @param {BigInteger|String} bigInt Number or string to pad.\n   * @returns {String} Padded hex string.\n   */\n  ;\n\n  _proto.padHex = function padHex(bigInt) {\n    var hashStr = bigInt.toString(16);\n\n    if (hashStr.length % 2 === 1) {\n      hashStr = \"0\" + hashStr;\n    } else if ('89ABCDEFabcdef'.indexOf(hashStr[0]) !== -1) {\n      hashStr = \"00\" + hashStr;\n    }\n\n    return hashStr;\n  };\n\n  return AuthenticationHelper;\n}();\n\nexport { AuthenticationHelper as default };","/*!\n * Copyright 2016 Amazon.com,\n * Inc. or its affiliates. All Rights Reserved.\n *\n * Licensed under the Amazon Software License (the \"License\").\n * You may not use this file except in compliance with the\n * License. A copy of the License is located at\n *\n *     http://aws.amazon.com/asl/\n *\n * or in the \"license\" file accompanying this file. This file is\n * distributed on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR\n * CONDITIONS OF ANY KIND, express or implied. See the License\n * for the specific language governing permissions and\n * limitations under the License.\n */\nimport { Buffer } from 'buffer';\n/** @class */\n\nvar CognitoJwtToken = /*#__PURE__*/function () {\n  /**\n   * Constructs a new CognitoJwtToken object\n   * @param {string=} token The JWT token.\n   */\n  function CognitoJwtToken(token) {\n    // Assign object\n    this.jwtToken = token || '';\n    this.payload = this.decodePayload();\n  }\n  /**\n   * @returns {string} the record's token.\n   */\n\n\n  var _proto = CognitoJwtToken.prototype;\n\n  _proto.getJwtToken = function getJwtToken() {\n    return this.jwtToken;\n  }\n  /**\n   * @returns {int} the token's expiration (exp member).\n   */\n  ;\n\n  _proto.getExpiration = function getExpiration() {\n    return this.payload.exp;\n  }\n  /**\n   * @returns {int} the token's \"issued at\" (iat member).\n   */\n  ;\n\n  _proto.getIssuedAt = function getIssuedAt() {\n    return this.payload.iat;\n  }\n  /**\n   * @returns {object} the token's payload.\n   */\n  ;\n\n  _proto.decodePayload = function decodePayload() {\n    var payload = this.jwtToken.split('.')[1];\n\n    try {\n      return JSON.parse(Buffer.from(payload, 'base64').toString('utf8'));\n    } catch (err) {\n      return {};\n    }\n  };\n\n  return CognitoJwtToken;\n}();\n\nexport { CognitoJwtToken as default };","function _inheritsLoose(subClass, superClass) {\n  subClass.prototype = Object.create(superClass.prototype);\n  subClass.prototype.constructor = subClass;\n  subClass.__proto__ = superClass;\n}\n/*\n * Copyright 2016 Amazon.com,\n * Inc. or its affiliates. All Rights Reserved.\n *\n * Licensed under the Amazon Software License (the \"License\").\n * You may not use this file except in compliance with the\n * License. A copy of the License is located at\n *\n *     http://aws.amazon.com/asl/\n *\n * or in the \"license\" file accompanying this file. This file is\n * distributed on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR\n * CONDITIONS OF ANY KIND, express or implied. See the License\n * for the specific language governing permissions and\n * limitations under the License.\n */\n\n\nimport CognitoJwtToken from './CognitoJwtToken';\n/** @class */\n\nvar CognitoAccessToken = /*#__PURE__*/function (_CognitoJwtToken) {\n  _inheritsLoose(CognitoAccessToken, _CognitoJwtToken);\n  /**\n   * Constructs a new CognitoAccessToken object\n   * @param {string=} AccessToken The JWT access token.\n   */\n\n\n  function CognitoAccessToken(_temp) {\n    var _ref = _temp === void 0 ? {} : _temp,\n        AccessToken = _ref.AccessToken;\n\n    return _CognitoJwtToken.call(this, AccessToken || '') || this;\n  }\n\n  return CognitoAccessToken;\n}(CognitoJwtToken);\n\nexport { CognitoAccessToken as default };","function _inheritsLoose(subClass, superClass) {\n  subClass.prototype = Object.create(superClass.prototype);\n  subClass.prototype.constructor = subClass;\n  subClass.__proto__ = superClass;\n}\n/*!\n * Copyright 2016 Amazon.com,\n * Inc. or its affiliates. All Rights Reserved.\n *\n * Licensed under the Amazon Software License (the \"License\").\n * You may not use this file except in compliance with the\n * License. A copy of the License is located at\n *\n *     http://aws.amazon.com/asl/\n *\n * or in the \"license\" file accompanying this file. This file is\n * distributed on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR\n * CONDITIONS OF ANY KIND, express or implied. See the License\n * for the specific language governing permissions and\n * limitations under the License.\n */\n\n\nimport CognitoJwtToken from './CognitoJwtToken';\n/** @class */\n\nvar CognitoIdToken = /*#__PURE__*/function (_CognitoJwtToken) {\n  _inheritsLoose(CognitoIdToken, _CognitoJwtToken);\n  /**\n   * Constructs a new CognitoIdToken object\n   * @param {string=} IdToken The JWT Id token\n   */\n\n\n  function CognitoIdToken(_temp) {\n    var _ref = _temp === void 0 ? {} : _temp,\n        IdToken = _ref.IdToken;\n\n    return _CognitoJwtToken.call(this, IdToken || '') || this;\n  }\n\n  return CognitoIdToken;\n}(CognitoJwtToken);\n\nexport { CognitoIdToken as default };","/*!\n * Copyright 2016 Amazon.com,\n * Inc. or its affiliates. All Rights Reserved.\n *\n * Licensed under the Amazon Software License (the \"License\").\n * You may not use this file except in compliance with the\n * License. A copy of the License is located at\n *\n *     http://aws.amazon.com/asl/\n *\n * or in the \"license\" file accompanying this file. This file is\n * distributed on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR\n * CONDITIONS OF ANY KIND, express or implied. See the License\n * for the specific language governing permissions and\n * limitations under the License.\n */\n\n/** @class */\nvar CognitoRefreshToken = /*#__PURE__*/function () {\n  /**\n   * Constructs a new CognitoRefreshToken object\n   * @param {string=} RefreshToken The JWT refresh token.\n   */\n  function CognitoRefreshToken(_temp) {\n    var _ref = _temp === void 0 ? {} : _temp,\n        RefreshToken = _ref.RefreshToken; // Assign object\n\n\n    this.token = RefreshToken || '';\n  }\n  /**\n   * @returns {string} the record's token.\n   */\n\n\n  var _proto = CognitoRefreshToken.prototype;\n\n  _proto.getToken = function getToken() {\n    return this.token;\n  };\n\n  return CognitoRefreshToken;\n}();\n\nexport { CognitoRefreshToken as default };","/*!\n * Copyright 2016 Amazon.com,\n * Inc. or its affiliates. All Rights Reserved.\n *\n * Licensed under the Amazon Software License (the \"License\").\n * You may not use this file except in compliance with the\n * License. A copy of the License is located at\n *\n *     http://aws.amazon.com/asl/\n *\n * or in the \"license\" file accompanying this file. This file is\n * distributed on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR\n * CONDITIONS OF ANY KIND, express or implied. See the License\n * for the specific language governing permissions and\n * limitations under the License.\n */\n\n/** @class */\nvar CognitoUserSession = /*#__PURE__*/function () {\n  /**\n   * Constructs a new CognitoUserSession object\n   * @param {CognitoIdToken} IdToken The session's Id token.\n   * @param {CognitoRefreshToken=} RefreshToken The session's refresh token.\n   * @param {CognitoAccessToken} AccessToken The session's access token.\n   * @param {int} ClockDrift The saved computer's clock drift or undefined to force calculation.\n   */\n  function CognitoUserSession(_temp) {\n    var _ref = _temp === void 0 ? {} : _temp,\n        IdToken = _ref.IdToken,\n        RefreshToken = _ref.RefreshToken,\n        AccessToken = _ref.AccessToken,\n        ClockDrift = _ref.ClockDrift;\n\n    if (AccessToken == null || IdToken == null) {\n      throw new Error('Id token and Access Token must be present.');\n    }\n\n    this.idToken = IdToken;\n    this.refreshToken = RefreshToken;\n    this.accessToken = AccessToken;\n    this.clockDrift = ClockDrift === undefined ? this.calculateClockDrift() : ClockDrift;\n  }\n  /**\n   * @returns {CognitoIdToken} the session's Id token\n   */\n\n\n  var _proto = CognitoUserSession.prototype;\n\n  _proto.getIdToken = function getIdToken() {\n    return this.idToken;\n  }\n  /**\n   * @returns {CognitoRefreshToken} the session's refresh token\n   */\n  ;\n\n  _proto.getRefreshToken = function getRefreshToken() {\n    return this.refreshToken;\n  }\n  /**\n   * @returns {CognitoAccessToken} the session's access token\n   */\n  ;\n\n  _proto.getAccessToken = function getAccessToken() {\n    return this.accessToken;\n  }\n  /**\n   * @returns {int} the session's clock drift\n   */\n  ;\n\n  _proto.getClockDrift = function getClockDrift() {\n    return this.clockDrift;\n  }\n  /**\n   * @returns {int} the computer's clock drift\n   */\n  ;\n\n  _proto.calculateClockDrift = function calculateClockDrift() {\n    var now = Math.floor(new Date() / 1000);\n    var iat = Math.min(this.accessToken.getIssuedAt(), this.idToken.getIssuedAt());\n    return now - iat;\n  }\n  /**\n   * Checks to see if the session is still valid based on session expiry information found\n   * in tokens and the current time (adjusted with clock drift)\n   * @returns {boolean} if the session is still valid\n   */\n  ;\n\n  _proto.isValid = function isValid() {\n    var now = Math.floor(new Date() / 1000);\n    var adjusted = now - this.clockDrift;\n    return adjusted < this.accessToken.getExpiration() && adjusted < this.idToken.getExpiration();\n  };\n\n  return CognitoUserSession;\n}();\n\nexport { CognitoUserSession as default };","/*!\n * Copyright 2016 Amazon.com,\n * Inc. or its affiliates. All Rights Reserved.\n *\n * Licensed under the Amazon Software License (the \"License\").\n * You may not use this file except in compliance with the\n * License. A copy of the License is located at\n *\n *     http://aws.amazon.com/asl/\n *\n * or in the \"license\" file accompanying this file. This file is\n * distributed on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR\n * CONDITIONS OF ANY KIND, express or implied. See the License\n * for the specific language governing permissions and\n * limitations under the License.\n */\nvar monthNames = ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'];\nvar weekNames = ['Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat'];\n/** @class */\n\nvar DateHelper = /*#__PURE__*/function () {\n  function DateHelper() {}\n\n  var _proto = DateHelper.prototype;\n  /**\n   * @returns {string} The current time in \"ddd MMM D HH:mm:ss UTC YYYY\" format.\n   */\n\n  _proto.getNowString = function getNowString() {\n    var now = new Date();\n    var weekDay = weekNames[now.getUTCDay()];\n    var month = monthNames[now.getUTCMonth()];\n    var day = now.getUTCDate();\n    var hours = now.getUTCHours();\n\n    if (hours < 10) {\n      hours = \"0\" + hours;\n    }\n\n    var minutes = now.getUTCMinutes();\n\n    if (minutes < 10) {\n      minutes = \"0\" + minutes;\n    }\n\n    var seconds = now.getUTCSeconds();\n\n    if (seconds < 10) {\n      seconds = \"0\" + seconds;\n    }\n\n    var year = now.getUTCFullYear(); // ddd MMM D HH:mm:ss UTC YYYY\n\n    var dateNow = weekDay + \" \" + month + \" \" + day + \" \" + hours + \":\" + minutes + \":\" + seconds + \" UTC \" + year;\n    return dateNow;\n  };\n\n  return DateHelper;\n}();\n\nexport { DateHelper as default };","/*!\n * Copyright 2016 Amazon.com,\n * Inc. or its affiliates. All Rights Reserved.\n *\n * Licensed under the Amazon Software License (the \"License\").\n * You may not use this file except in compliance with the\n * License. A copy of the License is located at\n *\n *     http://aws.amazon.com/asl/\n *\n * or in the \"license\" file accompanying this file. This file is\n * distributed on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR\n * CONDITIONS OF ANY KIND, express or implied. See the License\n * for the specific language governing permissions and\n * limitations under the License.\n */\n\n/** @class */\nvar CognitoUserAttribute = /*#__PURE__*/function () {\n  /**\n   * Constructs a new CognitoUserAttribute object\n   * @param {string=} Name The record's name\n   * @param {string=} Value The record's value\n   */\n  function CognitoUserAttribute(_temp) {\n    var _ref = _temp === void 0 ? {} : _temp,\n        Name = _ref.Name,\n        Value = _ref.Value;\n\n    this.Name = Name || '';\n    this.Value = Value || '';\n  }\n  /**\n   * @returns {string} the record's value.\n   */\n\n\n  var _proto = CognitoUserAttribute.prototype;\n\n  _proto.getValue = function getValue() {\n    return this.Value;\n  }\n  /**\n   * Sets the record's value.\n   * @param {string} value The new value.\n   * @returns {CognitoUserAttribute} The record for method chaining.\n   */\n  ;\n\n  _proto.setValue = function setValue(value) {\n    this.Value = value;\n    return this;\n  }\n  /**\n   * @returns {string} the record's name.\n   */\n  ;\n\n  _proto.getName = function getName() {\n    return this.Name;\n  }\n  /**\n   * Sets the record's name\n   * @param {string} name The new name.\n   * @returns {CognitoUserAttribute} The record for method chaining.\n   */\n  ;\n\n  _proto.setName = function setName(name) {\n    this.Name = name;\n    return this;\n  }\n  /**\n   * @returns {string} a string representation of the record.\n   */\n  ;\n\n  _proto.toString = function toString() {\n    return JSON.stringify(this);\n  }\n  /**\n   * @returns {object} a flat object representing the record.\n   */\n  ;\n\n  _proto.toJSON = function toJSON() {\n    return {\n      Name: this.Name,\n      Value: this.Value\n    };\n  };\n\n  return CognitoUserAttribute;\n}();\n\nexport { CognitoUserAttribute as default };","/*!\n * Copyright 2016 Amazon.com,\n * Inc. or its affiliates. All Rights Reserved.\n *\n * Licensed under the Amazon Software License (the \"License\").\n * You may not use this file except in compliance with the\n * License. A copy of the License is located at\n *\n *     http://aws.amazon.com/asl/\n *\n * or in the \"license\" file accompanying this file. This file is\n * distributed on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR\n * CONDITIONS OF ANY KIND, express or implied. See the License\n * for the specific language governing permissions and\n * limitations under the License.\n */\nvar dataMemory = {};\n/** @class */\n\nvar MemoryStorage = /*#__PURE__*/function () {\n  function MemoryStorage() {}\n  /**\n   * This is used to set a specific item in storage\n   * @param {string} key - the key for the item\n   * @param {object} value - the value\n   * @returns {string} value that was set\n   */\n\n\n  MemoryStorage.setItem = function setItem(key, value) {\n    dataMemory[key] = value;\n    return dataMemory[key];\n  }\n  /**\n   * This is used to get a specific key from storage\n   * @param {string} key - the key for the item\n   * This is used to clear the storage\n   * @returns {string} the data item\n   */\n  ;\n\n  MemoryStorage.getItem = function getItem(key) {\n    return Object.prototype.hasOwnProperty.call(dataMemory, key) ? dataMemory[key] : undefined;\n  }\n  /**\n   * This is used to remove an item from storage\n   * @param {string} key - the key being set\n   * @returns {string} value - value that was deleted\n   */\n  ;\n\n  MemoryStorage.removeItem = function removeItem(key) {\n    return delete dataMemory[key];\n  }\n  /**\n   * This is used to clear the storage\n   * @returns {string} nothing\n   */\n  ;\n\n  MemoryStorage.clear = function clear() {\n    dataMemory = {};\n    return dataMemory;\n  };\n\n  return MemoryStorage;\n}();\n/** @class */\n\n\nvar StorageHelper = /*#__PURE__*/function () {\n  /**\n   * This is used to get a storage object\n   * @returns {object} the storage\n   */\n  function StorageHelper() {\n    try {\n      this.storageWindow = window.localStorage;\n      this.storageWindow.setItem('aws.cognito.test-ls', 1);\n      this.storageWindow.removeItem('aws.cognito.test-ls');\n    } catch (exception) {\n      this.storageWindow = MemoryStorage;\n    }\n  }\n  /**\n   * This is used to return the storage\n   * @returns {object} the storage\n   */\n\n\n  var _proto = StorageHelper.prototype;\n\n  _proto.getStorage = function getStorage() {\n    return this.storageWindow;\n  };\n\n  return StorageHelper;\n}();\n\nexport { StorageHelper as default };","/*!\n * Copyright 2016 Amazon.com,\n * Inc. or its affiliates. All Rights Reserved.\n *\n * Licensed under the Amazon Software License (the \"License\").\n * You may not use this file except in compliance with the\n * License. A copy of the License is located at\n *\n *     http://aws.amazon.com/asl/\n *\n * or in the \"license\" file accompanying this file. This file is\n * distributed on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR\n * CONDITIONS OF ANY KIND, express or implied. See the License\n * for the specific language governing permissions and\n * limitations under the License.\n */\nimport { Buffer } from 'buffer';\nimport CryptoJS from 'crypto-js/core';\nimport TypedArrays from 'crypto-js/lib-typedarrays'; // necessary for crypto js\n\nimport Base64 from 'crypto-js/enc-base64';\nimport HmacSHA256 from 'crypto-js/hmac-sha256';\nimport BigInteger from './BigInteger';\nimport AuthenticationHelper from './AuthenticationHelper';\nimport CognitoAccessToken from './CognitoAccessToken';\nimport CognitoIdToken from './CognitoIdToken';\nimport CognitoRefreshToken from './CognitoRefreshToken';\nimport CognitoUserSession from './CognitoUserSession';\nimport DateHelper from './DateHelper';\nimport CognitoUserAttribute from './CognitoUserAttribute';\nimport StorageHelper from './StorageHelper';\n/**\n * @callback nodeCallback\n * @template T result\n * @param {*} err The operation failure reason, or null.\n * @param {T} result The operation result.\n */\n\n/**\n * @callback onFailure\n * @param {*} err Failure reason.\n */\n\n/**\n * @callback onSuccess\n * @template T result\n * @param {T} result The operation result.\n */\n\n/**\n * @callback mfaRequired\n * @param {*} details MFA challenge details.\n */\n\n/**\n * @callback customChallenge\n * @param {*} details Custom challenge details.\n */\n\n/**\n * @callback inputVerificationCode\n * @param {*} data Server response.\n */\n\n/**\n * @callback authSuccess\n * @param {CognitoUserSession} session The new session.\n * @param {bool=} userConfirmationNecessary User must be confirmed.\n */\n\nvar isBrowser = typeof navigator !== 'undefined';\nvar userAgent = isBrowser ? navigator.userAgent : 'nodejs';\n/** @class */\n\nvar CognitoUser = /*#__PURE__*/function () {\n  /**\n   * Constructs a new CognitoUser object\n   * @param {object} data Creation options\n   * @param {string} data.Username The user's username.\n   * @param {CognitoUserPool} data.Pool Pool containing the user.\n   * @param {object} data.Storage Optional storage object.\n   */\n  function CognitoUser(data) {\n    if (data == null || data.Username == null || data.Pool == null) {\n      throw new Error('Username and Pool information are required.');\n    }\n\n    this.username = data.Username || '';\n    this.pool = data.Pool;\n    this.Session = null;\n    this.client = data.Pool.client;\n    this.signInUserSession = null;\n    this.authenticationFlowType = 'USER_SRP_AUTH';\n    this.storage = data.Storage || new StorageHelper().getStorage();\n    this.keyPrefix = \"CognitoIdentityServiceProvider.\" + this.pool.getClientId();\n    this.userDataKey = this.keyPrefix + \".\" + this.username + \".userData\";\n  }\n  /**\n   * Sets the session for this user\n   * @param {CognitoUserSession} signInUserSession the session\n   * @returns {void}\n   */\n\n\n  var _proto = CognitoUser.prototype;\n\n  _proto.setSignInUserSession = function setSignInUserSession(signInUserSession) {\n    this.clearCachedUserData();\n    this.signInUserSession = signInUserSession;\n    this.cacheTokens();\n  }\n  /**\n   * @returns {CognitoUserSession} the current session for this user\n   */\n  ;\n\n  _proto.getSignInUserSession = function getSignInUserSession() {\n    return this.signInUserSession;\n  }\n  /**\n   * @returns {string} the user's username\n   */\n  ;\n\n  _proto.getUsername = function getUsername() {\n    return this.username;\n  }\n  /**\n   * @returns {String} the authentication flow type\n   */\n  ;\n\n  _proto.getAuthenticationFlowType = function getAuthenticationFlowType() {\n    return this.authenticationFlowType;\n  }\n  /**\n   * sets authentication flow type\n   * @param {string} authenticationFlowType New value.\n   * @returns {void}\n   */\n  ;\n\n  _proto.setAuthenticationFlowType = function setAuthenticationFlowType(authenticationFlowType) {\n    this.authenticationFlowType = authenticationFlowType;\n  }\n  /**\n   * This is used for authenticating the user through the custom authentication flow.\n   * @param {AuthenticationDetails} authDetails Contains the authentication data\n   * @param {object} callback Result callback map.\n   * @param {onFailure} callback.onFailure Called on any error.\n   * @param {customChallenge} callback.customChallenge Custom challenge\n   *        response required to continue.\n   * @param {authSuccess} callback.onSuccess Called on success with the new session.\n   * @returns {void}\n   */\n  ;\n\n  _proto.initiateAuth = function initiateAuth(authDetails, callback) {\n    var _this = this;\n\n    var authParameters = authDetails.getAuthParameters();\n    authParameters.USERNAME = this.username;\n    var clientMetaData = Object.keys(authDetails.getValidationData()).length !== 0 ? authDetails.getValidationData() : authDetails.getClientMetadata();\n    var jsonReq = {\n      AuthFlow: 'CUSTOM_AUTH',\n      ClientId: this.pool.getClientId(),\n      AuthParameters: authParameters,\n      ClientMetadata: clientMetaData\n    };\n\n    if (this.getUserContextData()) {\n      jsonReq.UserContextData = this.getUserContextData();\n    }\n\n    this.client.request('InitiateAuth', jsonReq, function (err, data) {\n      if (err) {\n        return callback.onFailure(err);\n      }\n\n      var challengeName = data.ChallengeName;\n      var challengeParameters = data.ChallengeParameters;\n\n      if (challengeName === 'CUSTOM_CHALLENGE') {\n        _this.Session = data.Session;\n        return callback.customChallenge(challengeParameters);\n      }\n\n      _this.signInUserSession = _this.getCognitoUserSession(data.AuthenticationResult);\n\n      _this.cacheTokens();\n\n      return callback.onSuccess(_this.signInUserSession);\n    });\n  }\n  /**\n   * This is used for authenticating the user.\n   * stuff\n   * @param {AuthenticationDetails} authDetails Contains the authentication data\n   * @param {object} callback Result callback map.\n   * @param {onFailure} callback.onFailure Called on any error.\n   * @param {newPasswordRequired} callback.newPasswordRequired new\n   *        password and any required attributes are required to continue\n   * @param {mfaRequired} callback.mfaRequired MFA code\n   *        required to continue.\n   * @param {customChallenge} callback.customChallenge Custom challenge\n   *        response required to continue.\n   * @param {authSuccess} callback.onSuccess Called on success with the new session.\n   * @returns {void}\n   */\n  ;\n\n  _proto.authenticateUser = function authenticateUser(authDetails, callback) {\n    if (this.authenticationFlowType === 'USER_PASSWORD_AUTH') {\n      return this.authenticateUserPlainUsernamePassword(authDetails, callback);\n    } else if (this.authenticationFlowType === 'USER_SRP_AUTH' || this.authenticationFlowType === 'CUSTOM_AUTH') {\n      return this.authenticateUserDefaultAuth(authDetails, callback);\n    }\n\n    return callback.onFailure(new Error('Authentication flow type is invalid.'));\n  }\n  /**\n   * PRIVATE ONLY: This is an internal only method and should not\n   * be directly called by the consumers.\n   * It calls the AuthenticationHelper for SRP related\n   * stuff\n   * @param {AuthenticationDetails} authDetails Contains the authentication data\n   * @param {object} callback Result callback map.\n   * @param {onFailure} callback.onFailure Called on any error.\n   * @param {newPasswordRequired} callback.newPasswordRequired new\n   *        password and any required attributes are required to continue\n   * @param {mfaRequired} callback.mfaRequired MFA code\n   *        required to continue.\n   * @param {customChallenge} callback.customChallenge Custom challenge\n   *        response required to continue.\n   * @param {authSuccess} callback.onSuccess Called on success with the new session.\n   * @returns {void}\n   */\n  ;\n\n  _proto.authenticateUserDefaultAuth = function authenticateUserDefaultAuth(authDetails, callback) {\n    var _this2 = this;\n\n    var authenticationHelper = new AuthenticationHelper(this.pool.getUserPoolId().split('_')[1]);\n    var dateHelper = new DateHelper();\n    var serverBValue;\n    var salt;\n    var authParameters = {};\n\n    if (this.deviceKey != null) {\n      authParameters.DEVICE_KEY = this.deviceKey;\n    }\n\n    authParameters.USERNAME = this.username;\n    authenticationHelper.getLargeAValue(function (errOnAValue, aValue) {\n      // getLargeAValue callback start\n      if (errOnAValue) {\n        callback.onFailure(errOnAValue);\n      }\n\n      authParameters.SRP_A = aValue.toString(16);\n\n      if (_this2.authenticationFlowType === 'CUSTOM_AUTH') {\n        authParameters.CHALLENGE_NAME = 'SRP_A';\n      }\n\n      var clientMetaData = Object.keys(authDetails.getValidationData()).length !== 0 ? authDetails.getValidationData() : authDetails.getClientMetadata();\n      var jsonReq = {\n        AuthFlow: _this2.authenticationFlowType,\n        ClientId: _this2.pool.getClientId(),\n        AuthParameters: authParameters,\n        ClientMetadata: clientMetaData\n      };\n\n      if (_this2.getUserContextData(_this2.username)) {\n        jsonReq.UserContextData = _this2.getUserContextData(_this2.username);\n      }\n\n      _this2.client.request('InitiateAuth', jsonReq, function (err, data) {\n        if (err) {\n          return callback.onFailure(err);\n        }\n\n        var challengeParameters = data.ChallengeParameters;\n        _this2.username = challengeParameters.USER_ID_FOR_SRP;\n        serverBValue = new BigInteger(challengeParameters.SRP_B, 16);\n        salt = new BigInteger(challengeParameters.SALT, 16);\n\n        _this2.getCachedDeviceKeyAndPassword();\n\n        authenticationHelper.getPasswordAuthenticationKey(_this2.username, authDetails.getPassword(), serverBValue, salt, function (errOnHkdf, hkdf) {\n          // getPasswordAuthenticationKey callback start\n          if (errOnHkdf) {\n            callback.onFailure(errOnHkdf);\n          }\n\n          var dateNow = dateHelper.getNowString();\n          var message = CryptoJS.lib.WordArray.create(Buffer.concat([Buffer.from(_this2.pool.getUserPoolId().split('_')[1], 'utf8'), Buffer.from(_this2.username, 'utf8'), Buffer.from(challengeParameters.SECRET_BLOCK, 'base64'), Buffer.from(dateNow, 'utf8')]));\n          var key = CryptoJS.lib.WordArray.create(hkdf);\n          var signatureString = Base64.stringify(HmacSHA256(message, key));\n          var challengeResponses = {};\n          challengeResponses.USERNAME = _this2.username;\n          challengeResponses.PASSWORD_CLAIM_SECRET_BLOCK = challengeParameters.SECRET_BLOCK;\n          challengeResponses.TIMESTAMP = dateNow;\n          challengeResponses.PASSWORD_CLAIM_SIGNATURE = signatureString;\n\n          if (_this2.deviceKey != null) {\n            challengeResponses.DEVICE_KEY = _this2.deviceKey;\n          }\n\n          var respondToAuthChallenge = function respondToAuthChallenge(challenge, challengeCallback) {\n            return _this2.client.request('RespondToAuthChallenge', challenge, function (errChallenge, dataChallenge) {\n              if (errChallenge && errChallenge.code === 'ResourceNotFoundException' && errChallenge.message.toLowerCase().indexOf('device') !== -1) {\n                challengeResponses.DEVICE_KEY = null;\n                _this2.deviceKey = null;\n                _this2.randomPassword = null;\n                _this2.deviceGroupKey = null;\n\n                _this2.clearCachedDeviceKeyAndPassword();\n\n                return respondToAuthChallenge(challenge, challengeCallback);\n              }\n\n              return challengeCallback(errChallenge, dataChallenge);\n            });\n          };\n\n          var jsonReqResp = {\n            ChallengeName: 'PASSWORD_VERIFIER',\n            ClientId: _this2.pool.getClientId(),\n            ChallengeResponses: challengeResponses,\n            Session: data.Session,\n            ClientMetadata: clientMetaData\n          };\n\n          if (_this2.getUserContextData()) {\n            jsonReqResp.UserContextData = _this2.getUserContextData();\n          }\n\n          respondToAuthChallenge(jsonReqResp, function (errAuthenticate, dataAuthenticate) {\n            if (errAuthenticate) {\n              return callback.onFailure(errAuthenticate);\n            }\n\n            return _this2.authenticateUserInternal(dataAuthenticate, authenticationHelper, callback);\n          });\n          return undefined; // getPasswordAuthenticationKey callback end\n        });\n        return undefined;\n      }); // getLargeAValue callback end\n\n    });\n  }\n  /**\n   * PRIVATE ONLY: This is an internal only method and should not\n   * be directly called by the consumers.\n   * @param {AuthenticationDetails} authDetails Contains the authentication data.\n   * @param {object} callback Result callback map.\n   * @param {onFailure} callback.onFailure Called on any error.\n   * @param {mfaRequired} callback.mfaRequired MFA code\n   *        required to continue.\n   * @param {authSuccess} callback.onSuccess Called on success with the new session.\n   * @returns {void}\n   */\n  ;\n\n  _proto.authenticateUserPlainUsernamePassword = function authenticateUserPlainUsernamePassword(authDetails, callback) {\n    var _this3 = this;\n\n    var authParameters = {};\n    authParameters.USERNAME = this.username;\n    authParameters.PASSWORD = authDetails.getPassword();\n\n    if (!authParameters.PASSWORD) {\n      callback.onFailure(new Error('PASSWORD parameter is required'));\n      return;\n    }\n\n    var authenticationHelper = new AuthenticationHelper(this.pool.getUserPoolId().split('_')[1]);\n    this.getCachedDeviceKeyAndPassword();\n\n    if (this.deviceKey != null) {\n      authParameters.DEVICE_KEY = this.deviceKey;\n    }\n\n    var clientMetaData = Object.keys(authDetails.getValidationData()).length !== 0 ? authDetails.getValidationData() : authDetails.getClientMetadata();\n    var jsonReq = {\n      AuthFlow: 'USER_PASSWORD_AUTH',\n      ClientId: this.pool.getClientId(),\n      AuthParameters: authParameters,\n      ClientMetadata: clientMetaData\n    };\n\n    if (this.getUserContextData(this.username)) {\n      jsonReq.UserContextData = this.getUserContextData(this.username);\n    } // USER_PASSWORD_AUTH happens in a single round-trip: client sends userName and password,\n    // Cognito UserPools verifies password and returns tokens.\n\n\n    this.client.request('InitiateAuth', jsonReq, function (err, authResult) {\n      if (err) {\n        return callback.onFailure(err);\n      }\n\n      return _this3.authenticateUserInternal(authResult, authenticationHelper, callback);\n    });\n  }\n  /**\n   * PRIVATE ONLY: This is an internal only method and should not\n   * be directly called by the consumers.\n   * @param {object} dataAuthenticate authentication data\n   * @param {object} authenticationHelper helper created\n   * @param {callback} callback passed on from caller\n   * @returns {void}\n   */\n  ;\n\n  _proto.authenticateUserInternal = function authenticateUserInternal(dataAuthenticate, authenticationHelper, callback) {\n    var _this4 = this;\n\n    var challengeName = dataAuthenticate.ChallengeName;\n    var challengeParameters = dataAuthenticate.ChallengeParameters;\n\n    if (challengeName === 'SMS_MFA') {\n      this.Session = dataAuthenticate.Session;\n      return callback.mfaRequired(challengeName, challengeParameters);\n    }\n\n    if (challengeName === 'SELECT_MFA_TYPE') {\n      this.Session = dataAuthenticate.Session;\n      return callback.selectMFAType(challengeName, challengeParameters);\n    }\n\n    if (challengeName === 'MFA_SETUP') {\n      this.Session = dataAuthenticate.Session;\n      return callback.mfaSetup(challengeName, challengeParameters);\n    }\n\n    if (challengeName === 'SOFTWARE_TOKEN_MFA') {\n      this.Session = dataAuthenticate.Session;\n      return callback.totpRequired(challengeName, challengeParameters);\n    }\n\n    if (challengeName === 'CUSTOM_CHALLENGE') {\n      this.Session = dataAuthenticate.Session;\n      return callback.customChallenge(challengeParameters);\n    }\n\n    if (challengeName === 'NEW_PASSWORD_REQUIRED') {\n      this.Session = dataAuthenticate.Session;\n      var userAttributes = null;\n      var rawRequiredAttributes = null;\n      var requiredAttributes = [];\n      var userAttributesPrefix = authenticationHelper.getNewPasswordRequiredChallengeUserAttributePrefix();\n\n      if (challengeParameters) {\n        userAttributes = JSON.parse(dataAuthenticate.ChallengeParameters.userAttributes);\n        rawRequiredAttributes = JSON.parse(dataAuthenticate.ChallengeParameters.requiredAttributes);\n      }\n\n      if (rawRequiredAttributes) {\n        for (var i = 0; i < rawRequiredAttributes.length; i++) {\n          requiredAttributes[i] = rawRequiredAttributes[i].substr(userAttributesPrefix.length);\n        }\n      }\n\n      return callback.newPasswordRequired(userAttributes, requiredAttributes);\n    }\n\n    if (challengeName === 'DEVICE_SRP_AUTH') {\n      this.getDeviceResponse(callback);\n      return undefined;\n    }\n\n    this.signInUserSession = this.getCognitoUserSession(dataAuthenticate.AuthenticationResult);\n    this.challengeName = challengeName;\n    this.cacheTokens();\n    var newDeviceMetadata = dataAuthenticate.AuthenticationResult.NewDeviceMetadata;\n\n    if (newDeviceMetadata == null) {\n      return callback.onSuccess(this.signInUserSession);\n    }\n\n    authenticationHelper.generateHashDevice(dataAuthenticate.AuthenticationResult.NewDeviceMetadata.DeviceGroupKey, dataAuthenticate.AuthenticationResult.NewDeviceMetadata.DeviceKey, function (errGenHash) {\n      if (errGenHash) {\n        return callback.onFailure(errGenHash);\n      }\n\n      var deviceSecretVerifierConfig = {\n        Salt: Buffer.from(authenticationHelper.getSaltDevices(), 'hex').toString('base64'),\n        PasswordVerifier: Buffer.from(authenticationHelper.getVerifierDevices(), 'hex').toString('base64')\n      };\n      _this4.verifierDevices = deviceSecretVerifierConfig.PasswordVerifier;\n      _this4.deviceGroupKey = newDeviceMetadata.DeviceGroupKey;\n      _this4.randomPassword = authenticationHelper.getRandomPassword();\n\n      _this4.client.request('ConfirmDevice', {\n        DeviceKey: newDeviceMetadata.DeviceKey,\n        AccessToken: _this4.signInUserSession.getAccessToken().getJwtToken(),\n        DeviceSecretVerifierConfig: deviceSecretVerifierConfig,\n        DeviceName: userAgent\n      }, function (errConfirm, dataConfirm) {\n        if (errConfirm) {\n          return callback.onFailure(errConfirm);\n        }\n\n        _this4.deviceKey = dataAuthenticate.AuthenticationResult.NewDeviceMetadata.DeviceKey;\n\n        _this4.cacheDeviceKeyAndPassword();\n\n        if (dataConfirm.UserConfirmationNecessary === true) {\n          return callback.onSuccess(_this4.signInUserSession, dataConfirm.UserConfirmationNecessary);\n        }\n\n        return callback.onSuccess(_this4.signInUserSession);\n      });\n\n      return undefined;\n    });\n    return undefined;\n  }\n  /**\n   * This method is user to complete the NEW_PASSWORD_REQUIRED challenge.\n   * Pass the new password with any new user attributes to be updated.\n   * User attribute keys must be of format userAttributes.<attribute_name>.\n   * @param {string} newPassword new password for this user\n   * @param {object} requiredAttributeData map with values for all required attributes\n   * @param {object} callback Result callback map.\n   * @param {onFailure} callback.onFailure Called on any error.\n   * @param {mfaRequired} callback.mfaRequired MFA code required to continue.\n   * @param {customChallenge} callback.customChallenge Custom challenge\n   *         response required to continue.\n   * @param {authSuccess} callback.onSuccess Called on success with the new session.\n   * @param {ClientMetadata} clientMetadata object which is passed from client to Cognito Lambda trigger\n   * @returns {void}\n   */\n  ;\n\n  _proto.completeNewPasswordChallenge = function completeNewPasswordChallenge(newPassword, requiredAttributeData, callback, clientMetadata) {\n    var _this5 = this;\n\n    if (!newPassword) {\n      return callback.onFailure(new Error('New password is required.'));\n    }\n\n    var authenticationHelper = new AuthenticationHelper(this.pool.getUserPoolId().split('_')[1]);\n    var userAttributesPrefix = authenticationHelper.getNewPasswordRequiredChallengeUserAttributePrefix();\n    var finalUserAttributes = {};\n\n    if (requiredAttributeData) {\n      Object.keys(requiredAttributeData).forEach(function (key) {\n        finalUserAttributes[userAttributesPrefix + key] = requiredAttributeData[key];\n      });\n    }\n\n    finalUserAttributes.NEW_PASSWORD = newPassword;\n    finalUserAttributes.USERNAME = this.username;\n    var jsonReq = {\n      ChallengeName: 'NEW_PASSWORD_REQUIRED',\n      ClientId: this.pool.getClientId(),\n      ChallengeResponses: finalUserAttributes,\n      Session: this.Session,\n      ClientMetadata: clientMetadata\n    };\n\n    if (this.getUserContextData()) {\n      jsonReq.UserContextData = this.getUserContextData();\n    }\n\n    this.client.request('RespondToAuthChallenge', jsonReq, function (errAuthenticate, dataAuthenticate) {\n      if (errAuthenticate) {\n        return callback.onFailure(errAuthenticate);\n      }\n\n      return _this5.authenticateUserInternal(dataAuthenticate, authenticationHelper, callback);\n    });\n    return undefined;\n  }\n  /**\n   * This is used to get a session using device authentication. It is called at the end of user\n   * authentication\n   *\n   * @param {object} callback Result callback map.\n   * @param {onFailure} callback.onFailure Called on any error.\n   * @param {authSuccess} callback.onSuccess Called on success with the new session.\n   * @param {ClientMetadata} clientMetadata object which is passed from client to Cognito Lambda trigger\n   * @returns {void}\n   * @private\n   */\n  ;\n\n  _proto.getDeviceResponse = function getDeviceResponse(callback, clientMetadata) {\n    var _this6 = this;\n\n    var authenticationHelper = new AuthenticationHelper(this.deviceGroupKey);\n    var dateHelper = new DateHelper();\n    var authParameters = {};\n    authParameters.USERNAME = this.username;\n    authParameters.DEVICE_KEY = this.deviceKey;\n    authenticationHelper.getLargeAValue(function (errAValue, aValue) {\n      // getLargeAValue callback start\n      if (errAValue) {\n        callback.onFailure(errAValue);\n      }\n\n      authParameters.SRP_A = aValue.toString(16);\n      var jsonReq = {\n        ChallengeName: 'DEVICE_SRP_AUTH',\n        ClientId: _this6.pool.getClientId(),\n        ChallengeResponses: authParameters,\n        ClientMetadata: clientMetadata\n      };\n\n      if (_this6.getUserContextData()) {\n        jsonReq.UserContextData = _this6.getUserContextData();\n      }\n\n      _this6.client.request('RespondToAuthChallenge', jsonReq, function (err, data) {\n        if (err) {\n          return callback.onFailure(err);\n        }\n\n        var challengeParameters = data.ChallengeParameters;\n        var serverBValue = new BigInteger(challengeParameters.SRP_B, 16);\n        var salt = new BigInteger(challengeParameters.SALT, 16);\n        authenticationHelper.getPasswordAuthenticationKey(_this6.deviceKey, _this6.randomPassword, serverBValue, salt, function (errHkdf, hkdf) {\n          // getPasswordAuthenticationKey callback start\n          if (errHkdf) {\n            return callback.onFailure(errHkdf);\n          }\n\n          var dateNow = dateHelper.getNowString();\n          var message = CryptoJS.lib.WordArray.create(Buffer.concat([Buffer.from(_this6.deviceGroupKey, 'utf8'), Buffer.from(_this6.deviceKey, 'utf8'), Buffer.from(challengeParameters.SECRET_BLOCK, 'base64'), Buffer.from(dateNow, 'utf8')]));\n          var key = CryptoJS.lib.WordArray.create(hkdf);\n          var signatureString = Base64.stringify(HmacSHA256(message, key));\n          var challengeResponses = {};\n          challengeResponses.USERNAME = _this6.username;\n          challengeResponses.PASSWORD_CLAIM_SECRET_BLOCK = challengeParameters.SECRET_BLOCK;\n          challengeResponses.TIMESTAMP = dateNow;\n          challengeResponses.PASSWORD_CLAIM_SIGNATURE = signatureString;\n          challengeResponses.DEVICE_KEY = _this6.deviceKey;\n          var jsonReqResp = {\n            ChallengeName: 'DEVICE_PASSWORD_VERIFIER',\n            ClientId: _this6.pool.getClientId(),\n            ChallengeResponses: challengeResponses,\n            Session: data.Session\n          };\n\n          if (_this6.getUserContextData()) {\n            jsonReqResp.UserContextData = _this6.getUserContextData();\n          }\n\n          _this6.client.request('RespondToAuthChallenge', jsonReqResp, function (errAuthenticate, dataAuthenticate) {\n            if (errAuthenticate) {\n              return callback.onFailure(errAuthenticate);\n            }\n\n            _this6.signInUserSession = _this6.getCognitoUserSession(dataAuthenticate.AuthenticationResult);\n\n            _this6.cacheTokens();\n\n            return callback.onSuccess(_this6.signInUserSession);\n          });\n\n          return undefined; // getPasswordAuthenticationKey callback end\n        });\n        return undefined;\n      }); // getLargeAValue callback end\n\n    });\n  }\n  /**\n   * This is used for a certain user to confirm the registration by using a confirmation code\n   * @param {string} confirmationCode Code entered by user.\n   * @param {bool} forceAliasCreation Allow migrating from an existing email / phone number.\n   * @param {nodeCallback<string>} callback Called on success or error.\n   * @param {ClientMetadata} clientMetadata object which is passed from client to Cognito Lambda trigger\n   * @returns {void}\n   */\n  ;\n\n  _proto.confirmRegistration = function confirmRegistration(confirmationCode, forceAliasCreation, callback, clientMetadata) {\n    var jsonReq = {\n      ClientId: this.pool.getClientId(),\n      ConfirmationCode: confirmationCode,\n      Username: this.username,\n      ForceAliasCreation: forceAliasCreation,\n      ClientMetadata: clientMetadata\n    };\n\n    if (this.getUserContextData()) {\n      jsonReq.UserContextData = this.getUserContextData();\n    }\n\n    this.client.request('ConfirmSignUp', jsonReq, function (err) {\n      if (err) {\n        return callback(err, null);\n      }\n\n      return callback(null, 'SUCCESS');\n    });\n  }\n  /**\n   * This is used by the user once he has the responses to a custom challenge\n   * @param {string} answerChallenge The custom challenge answer.\n   * @param {object} callback Result callback map.\n   * @param {onFailure} callback.onFailure Called on any error.\n   * @param {customChallenge} callback.customChallenge\n   *    Custom challenge response required to continue.\n   * @param {authSuccess} callback.onSuccess Called on success with the new session.\n   * @param {ClientMetadata} clientMetadata object which is passed from client to Cognito Lambda trigger\n   * @returns {void}\n   */\n  ;\n\n  _proto.sendCustomChallengeAnswer = function sendCustomChallengeAnswer(answerChallenge, callback, clientMetadata) {\n    var _this7 = this;\n\n    var challengeResponses = {};\n    challengeResponses.USERNAME = this.username;\n    challengeResponses.ANSWER = answerChallenge;\n    var authenticationHelper = new AuthenticationHelper(this.pool.getUserPoolId().split('_')[1]);\n    this.getCachedDeviceKeyAndPassword();\n\n    if (this.deviceKey != null) {\n      challengeResponses.DEVICE_KEY = this.deviceKey;\n    }\n\n    var jsonReq = {\n      ChallengeName: 'CUSTOM_CHALLENGE',\n      ChallengeResponses: challengeResponses,\n      ClientId: this.pool.getClientId(),\n      Session: this.Session,\n      ClientMetadata: clientMetadata\n    };\n\n    if (this.getUserContextData()) {\n      jsonReq.UserContextData = this.getUserContextData();\n    }\n\n    this.client.request('RespondToAuthChallenge', jsonReq, function (err, data) {\n      if (err) {\n        return callback.onFailure(err);\n      }\n\n      return _this7.authenticateUserInternal(data, authenticationHelper, callback);\n    });\n  }\n  /**\n   * This is used by the user once he has an MFA code\n   * @param {string} confirmationCode The MFA code entered by the user.\n   * @param {object} callback Result callback map.\n   * @param {string} mfaType The mfa we are replying to.\n   * @param {onFailure} callback.onFailure Called on any error.\n   * @param {authSuccess} callback.onSuccess Called on success with the new session.\n   * @param {ClientMetadata} clientMetadata object which is passed from client to Cognito Lambda trigger\n   * @returns {void}\n   */\n  ;\n\n  _proto.sendMFACode = function sendMFACode(confirmationCode, callback, mfaType, clientMetadata) {\n    var _this8 = this;\n\n    var challengeResponses = {};\n    challengeResponses.USERNAME = this.username;\n    challengeResponses.SMS_MFA_CODE = confirmationCode;\n    var mfaTypeSelection = mfaType || 'SMS_MFA';\n\n    if (mfaTypeSelection === 'SOFTWARE_TOKEN_MFA') {\n      challengeResponses.SOFTWARE_TOKEN_MFA_CODE = confirmationCode;\n    }\n\n    if (this.deviceKey != null) {\n      challengeResponses.DEVICE_KEY = this.deviceKey;\n    }\n\n    var jsonReq = {\n      ChallengeName: mfaTypeSelection,\n      ChallengeResponses: challengeResponses,\n      ClientId: this.pool.getClientId(),\n      Session: this.Session,\n      ClientMetadata: clientMetadata\n    };\n\n    if (this.getUserContextData()) {\n      jsonReq.UserContextData = this.getUserContextData();\n    }\n\n    this.client.request('RespondToAuthChallenge', jsonReq, function (err, dataAuthenticate) {\n      if (err) {\n        return callback.onFailure(err);\n      }\n\n      var challengeName = dataAuthenticate.ChallengeName;\n\n      if (challengeName === 'DEVICE_SRP_AUTH') {\n        _this8.getDeviceResponse(callback);\n\n        return undefined;\n      }\n\n      _this8.signInUserSession = _this8.getCognitoUserSession(dataAuthenticate.AuthenticationResult);\n\n      _this8.cacheTokens();\n\n      if (dataAuthenticate.AuthenticationResult.NewDeviceMetadata == null) {\n        return callback.onSuccess(_this8.signInUserSession);\n      }\n\n      var authenticationHelper = new AuthenticationHelper(_this8.pool.getUserPoolId().split('_')[1]);\n      authenticationHelper.generateHashDevice(dataAuthenticate.AuthenticationResult.NewDeviceMetadata.DeviceGroupKey, dataAuthenticate.AuthenticationResult.NewDeviceMetadata.DeviceKey, function (errGenHash) {\n        if (errGenHash) {\n          return callback.onFailure(errGenHash);\n        }\n\n        var deviceSecretVerifierConfig = {\n          Salt: Buffer.from(authenticationHelper.getSaltDevices(), 'hex').toString('base64'),\n          PasswordVerifier: Buffer.from(authenticationHelper.getVerifierDevices(), 'hex').toString('base64')\n        };\n        _this8.verifierDevices = deviceSecretVerifierConfig.PasswordVerifier;\n        _this8.deviceGroupKey = dataAuthenticate.AuthenticationResult.NewDeviceMetadata.DeviceGroupKey;\n        _this8.randomPassword = authenticationHelper.getRandomPassword();\n\n        _this8.client.request('ConfirmDevice', {\n          DeviceKey: dataAuthenticate.AuthenticationResult.NewDeviceMetadata.DeviceKey,\n          AccessToken: _this8.signInUserSession.getAccessToken().getJwtToken(),\n          DeviceSecretVerifierConfig: deviceSecretVerifierConfig,\n          DeviceName: userAgent\n        }, function (errConfirm, dataConfirm) {\n          if (errConfirm) {\n            return callback.onFailure(errConfirm);\n          }\n\n          _this8.deviceKey = dataAuthenticate.AuthenticationResult.NewDeviceMetadata.DeviceKey;\n\n          _this8.cacheDeviceKeyAndPassword();\n\n          if (dataConfirm.UserConfirmationNecessary === true) {\n            return callback.onSuccess(_this8.signInUserSession, dataConfirm.UserConfirmationNecessary);\n          }\n\n          return callback.onSuccess(_this8.signInUserSession);\n        });\n\n        return undefined;\n      });\n      return undefined;\n    });\n  }\n  /**\n   * This is used by an authenticated user to change the current password\n   * @param {string} oldUserPassword The current password.\n   * @param {string} newUserPassword The requested new password.\n   * @param {nodeCallback<string>} callback Called on success or error.\n   * @param {ClientMetadata} clientMetadata object which is passed from client to Cognito Lambda trigger\n   * @returns {void}\n   */\n  ;\n\n  _proto.changePassword = function changePassword(oldUserPassword, newUserPassword, callback, clientMetadata) {\n    if (!(this.signInUserSession != null && this.signInUserSession.isValid())) {\n      return callback(new Error('User is not authenticated'), null);\n    }\n\n    this.client.request('ChangePassword', {\n      PreviousPassword: oldUserPassword,\n      ProposedPassword: newUserPassword,\n      AccessToken: this.signInUserSession.getAccessToken().getJwtToken(),\n      ClientMetadata: clientMetadata\n    }, function (err) {\n      if (err) {\n        return callback(err, null);\n      }\n\n      return callback(null, 'SUCCESS');\n    });\n    return undefined;\n  }\n  /**\n   * This is used by an authenticated user to enable MFA for itself\n   * @deprecated\n   * @param {nodeCallback<string>} callback Called on success or error.\n   * @returns {void}\n   */\n  ;\n\n  _proto.enableMFA = function enableMFA(callback) {\n    if (this.signInUserSession == null || !this.signInUserSession.isValid()) {\n      return callback(new Error('User is not authenticated'), null);\n    }\n\n    var mfaOptions = [];\n    var mfaEnabled = {\n      DeliveryMedium: 'SMS',\n      AttributeName: 'phone_number'\n    };\n    mfaOptions.push(mfaEnabled);\n    this.client.request('SetUserSettings', {\n      MFAOptions: mfaOptions,\n      AccessToken: this.signInUserSession.getAccessToken().getJwtToken()\n    }, function (err) {\n      if (err) {\n        return callback(err, null);\n      }\n\n      return callback(null, 'SUCCESS');\n    });\n    return undefined;\n  }\n  /**\n   * This is used by an authenticated user to enable MFA for itself\n   * @param {IMfaSettings} smsMfaSettings the sms mfa settings\n   * @param {IMFASettings} softwareTokenMfaSettings the software token mfa settings\n   * @param {nodeCallback<string>} callback Called on success or error.\n   * @returns {void}\n   */\n  ;\n\n  _proto.setUserMfaPreference = function setUserMfaPreference(smsMfaSettings, softwareTokenMfaSettings, callback) {\n    if (this.signInUserSession == null || !this.signInUserSession.isValid()) {\n      return callback(new Error('User is not authenticated'), null);\n    }\n\n    this.client.request('SetUserMFAPreference', {\n      SMSMfaSettings: smsMfaSettings,\n      SoftwareTokenMfaSettings: softwareTokenMfaSettings,\n      AccessToken: this.signInUserSession.getAccessToken().getJwtToken()\n    }, function (err) {\n      if (err) {\n        return callback(err, null);\n      }\n\n      return callback(null, 'SUCCESS');\n    });\n    return undefined;\n  }\n  /**\n   * This is used by an authenticated user to disable MFA for itself\n   * @deprecated\n   * @param {nodeCallback<string>} callback Called on success or error.\n   * @returns {void}\n   */\n  ;\n\n  _proto.disableMFA = function disableMFA(callback) {\n    if (this.signInUserSession == null || !this.signInUserSession.isValid()) {\n      return callback(new Error('User is not authenticated'), null);\n    }\n\n    var mfaOptions = [];\n    this.client.request('SetUserSettings', {\n      MFAOptions: mfaOptions,\n      AccessToken: this.signInUserSession.getAccessToken().getJwtToken()\n    }, function (err) {\n      if (err) {\n        return callback(err, null);\n      }\n\n      return callback(null, 'SUCCESS');\n    });\n    return undefined;\n  }\n  /**\n   * This is used by an authenticated user to delete itself\n   * @param {nodeCallback<string>} callback Called on success or error.\n   * @param {ClientMetadata} clientMetadata object which is passed from client to Cognito Lambda trigger\n   * @returns {void}\n   */\n  ;\n\n  _proto.deleteUser = function deleteUser(callback, clientMetadata) {\n    var _this9 = this;\n\n    if (this.signInUserSession == null || !this.signInUserSession.isValid()) {\n      return callback(new Error('User is not authenticated'), null);\n    }\n\n    this.client.request('DeleteUser', {\n      AccessToken: this.signInUserSession.getAccessToken().getJwtToken(),\n      ClientMetadata: clientMetadata\n    }, function (err) {\n      if (err) {\n        return callback(err, null);\n      }\n\n      _this9.clearCachedUser();\n\n      return callback(null, 'SUCCESS');\n    });\n    return undefined;\n  }\n  /**\n   * @typedef {CognitoUserAttribute | { Name:string, Value:string }} AttributeArg\n   */\n\n  /**\n   * This is used by an authenticated user to change a list of attributes\n   * @param {AttributeArg[]} attributes A list of the new user attributes.\n   * @param {nodeCallback<string>} callback Called on success or error.\n   * @param {ClientMetadata} clientMetadata object which is passed from client to Cognito Lambda trigger\n   * @returns {void}\n   */\n  ;\n\n  _proto.updateAttributes = function updateAttributes(attributes, callback, clientMetadata) {\n    var _this10 = this;\n\n    if (this.signInUserSession == null || !this.signInUserSession.isValid()) {\n      return callback(new Error('User is not authenticated'), null);\n    }\n\n    this.client.request('UpdateUserAttributes', {\n      AccessToken: this.signInUserSession.getAccessToken().getJwtToken(),\n      UserAttributes: attributes,\n      ClientMetadata: clientMetadata\n    }, function (err) {\n      if (err) {\n        return callback(err, null);\n      } // update cached user\n\n\n      return _this10.getUserData(function () {\n        return callback(null, 'SUCCESS');\n      }, {\n        bypassCache: true\n      });\n    });\n    return undefined;\n  }\n  /**\n   * This is used by an authenticated user to get a list of attributes\n   * @param {nodeCallback<CognitoUserAttribute[]>} callback Called on success or error.\n   * @returns {void}\n   */\n  ;\n\n  _proto.getUserAttributes = function getUserAttributes(callback) {\n    if (!(this.signInUserSession != null && this.signInUserSession.isValid())) {\n      return callback(new Error('User is not authenticated'), null);\n    }\n\n    this.client.request('GetUser', {\n      AccessToken: this.signInUserSession.getAccessToken().getJwtToken()\n    }, function (err, userData) {\n      if (err) {\n        return callback(err, null);\n      }\n\n      var attributeList = [];\n\n      for (var i = 0; i < userData.UserAttributes.length; i++) {\n        var attribute = {\n          Name: userData.UserAttributes[i].Name,\n          Value: userData.UserAttributes[i].Value\n        };\n        var userAttribute = new CognitoUserAttribute(attribute);\n        attributeList.push(userAttribute);\n      }\n\n      return callback(null, attributeList);\n    });\n    return undefined;\n  }\n  /**\n   * This is used by an authenticated user to get the MFAOptions\n   * @param {nodeCallback<MFAOptions>} callback Called on success or error.\n   * @returns {void}\n   */\n  ;\n\n  _proto.getMFAOptions = function getMFAOptions(callback) {\n    if (!(this.signInUserSession != null && this.signInUserSession.isValid())) {\n      return callback(new Error('User is not authenticated'), null);\n    }\n\n    this.client.request('GetUser', {\n      AccessToken: this.signInUserSession.getAccessToken().getJwtToken()\n    }, function (err, userData) {\n      if (err) {\n        return callback(err, null);\n      }\n\n      return callback(null, userData.MFAOptions);\n    });\n    return undefined;\n  }\n  /**\n   * PRIVATE ONLY: This is an internal only method and should not\n   * be directly called by the consumers.\n   */\n  ;\n\n  _proto.createGetUserRequest = function createGetUserRequest() {\n    return this.client.promisifyRequest('GetUser', {\n      AccessToken: this.signInUserSession.getAccessToken().getJwtToken()\n    });\n  }\n  /**\n   * PRIVATE ONLY: This is an internal only method and should not\n   * be directly called by the consumers.\n   */\n  ;\n\n  _proto.refreshSessionIfPossible = function refreshSessionIfPossible() {\n    var _this11 = this; // best effort, if not possible\n\n\n    return new Promise(function (resolve) {\n      var refresh = _this11.signInUserSession.getRefreshToken();\n\n      if (refresh && refresh.getToken()) {\n        _this11.refreshSession(refresh, resolve);\n      } else {\n        resolve();\n      }\n    });\n  }\n  /**\n   * This is used by an authenticated users to get the userData\n   * @param {nodeCallback<UserData>} callback Called on success or error.\n   * @param {GetUserDataOptions} params\n   * @returns {void}\n   */\n  ;\n\n  _proto.getUserData = function getUserData(callback, params) {\n    var _this12 = this;\n\n    if (!(this.signInUserSession != null && this.signInUserSession.isValid())) {\n      this.clearCachedUserData();\n      return callback(new Error('User is not authenticated'), null);\n    }\n\n    var userData = this.getUserDataFromCache();\n\n    if (!userData) {\n      this.fetchUserData().then(function (data) {\n        callback(null, data);\n      })[\"catch\"](callback);\n      return;\n    }\n\n    if (this.isFetchUserDataAndTokenRequired(params)) {\n      this.fetchUserData().then(function (data) {\n        return _this12.refreshSessionIfPossible().then(function () {\n          return data;\n        });\n      }).then(function (data) {\n        return callback(null, data);\n      })[\"catch\"](callback);\n      return;\n    }\n\n    try {\n      callback(null, JSON.parse(userData));\n      return;\n    } catch (err) {\n      this.clearCachedUserData();\n      callback(err, null);\n      return;\n    }\n  }\n  /**\n   *\n   * PRIVATE ONLY: This is an internal only method and should not\n   * be directly called by the consumers.\n   */\n  ;\n\n  _proto.getUserDataFromCache = function getUserDataFromCache() {\n    var userData = this.storage.getItem(this.userDataKey);\n    return userData;\n  }\n  /**\n   *\n   * PRIVATE ONLY: This is an internal only method and should not\n   * be directly called by the consumers.\n   */\n  ;\n\n  _proto.isFetchUserDataAndTokenRequired = function isFetchUserDataAndTokenRequired(params) {\n    var _ref = params || {},\n        _ref$bypassCache = _ref.bypassCache,\n        bypassCache = _ref$bypassCache === void 0 ? false : _ref$bypassCache;\n\n    return bypassCache;\n  }\n  /**\n   *\n   * PRIVATE ONLY: This is an internal only method and should not\n   * be directly called by the consumers.\n   */\n  ;\n\n  _proto.fetchUserData = function fetchUserData() {\n    var _this13 = this;\n\n    return this.createGetUserRequest().then(function (data) {\n      _this13.cacheUserData(data);\n\n      return data;\n    });\n  }\n  /**\n   * This is used by an authenticated user to delete a list of attributes\n   * @param {string[]} attributeList Names of the attributes to delete.\n   * @param {nodeCallback<string>} callback Called on success or error.\n   * @returns {void}\n   */\n  ;\n\n  _proto.deleteAttributes = function deleteAttributes(attributeList, callback) {\n    if (!(this.signInUserSession != null && this.signInUserSession.isValid())) {\n      return callback(new Error('User is not authenticated'), null);\n    }\n\n    this.client.request('DeleteUserAttributes', {\n      UserAttributeNames: attributeList,\n      AccessToken: this.signInUserSession.getAccessToken().getJwtToken()\n    }, function (err) {\n      if (err) {\n        return callback(err, null);\n      }\n\n      return callback(null, 'SUCCESS');\n    });\n    return undefined;\n  }\n  /**\n   * This is used by a user to resend a confirmation code\n   * @param {nodeCallback<string>} callback Called on success or error.\n   * @param {ClientMetadata} clientMetadata object which is passed from client to Cognito Lambda trigger\n   * @returns {void}\n   */\n  ;\n\n  _proto.resendConfirmationCode = function resendConfirmationCode(callback, clientMetadata) {\n    var jsonReq = {\n      ClientId: this.pool.getClientId(),\n      Username: this.username,\n      ClientMetadata: clientMetadata\n    };\n    this.client.request('ResendConfirmationCode', jsonReq, function (err, result) {\n      if (err) {\n        return callback(err, null);\n      }\n\n      return callback(null, result);\n    });\n  }\n  /**\n   * This is used to get a session, either from the session object\n   * or from  the local storage, or by using a refresh token\n   *\n   * @param {nodeCallback<CognitoUserSession>} callback Called on success or error.\n   * @returns {void}\n   */\n  ;\n\n  _proto.getSession = function getSession(callback) {\n    if (this.username == null) {\n      return callback(new Error('Username is null. Cannot retrieve a new session'), null);\n    }\n\n    if (this.signInUserSession != null && this.signInUserSession.isValid()) {\n      return callback(null, this.signInUserSession);\n    }\n\n    var keyPrefix = \"CognitoIdentityServiceProvider.\" + this.pool.getClientId() + \".\" + this.username;\n    var idTokenKey = keyPrefix + \".idToken\";\n    var accessTokenKey = keyPrefix + \".accessToken\";\n    var refreshTokenKey = keyPrefix + \".refreshToken\";\n    var clockDriftKey = keyPrefix + \".clockDrift\";\n\n    if (this.storage.getItem(idTokenKey)) {\n      var idToken = new CognitoIdToken({\n        IdToken: this.storage.getItem(idTokenKey)\n      });\n      var accessToken = new CognitoAccessToken({\n        AccessToken: this.storage.getItem(accessTokenKey)\n      });\n      var refreshToken = new CognitoRefreshToken({\n        RefreshToken: this.storage.getItem(refreshTokenKey)\n      });\n      var clockDrift = parseInt(this.storage.getItem(clockDriftKey), 0) || 0;\n      var sessionData = {\n        IdToken: idToken,\n        AccessToken: accessToken,\n        RefreshToken: refreshToken,\n        ClockDrift: clockDrift\n      };\n      var cachedSession = new CognitoUserSession(sessionData);\n\n      if (cachedSession.isValid()) {\n        this.signInUserSession = cachedSession;\n        return callback(null, this.signInUserSession);\n      }\n\n      if (!refreshToken.getToken()) {\n        return callback(new Error('Cannot retrieve a new session. Please authenticate.'), null);\n      }\n\n      this.refreshSession(refreshToken, callback);\n    } else {\n      callback(new Error('Local storage is missing an ID Token, Please authenticate'), null);\n    }\n\n    return undefined;\n  }\n  /**\n   * This uses the refreshToken to retrieve a new session\n   * @param {CognitoRefreshToken} refreshToken A previous session's refresh token.\n   * @param {nodeCallback<CognitoUserSession>} callback Called on success or error.\n   * @param {ClientMetadata} clientMetadata object which is passed from client to Cognito Lambda trigger\n   * @returns {void}\n   */\n  ;\n\n  _proto.refreshSession = function refreshSession(refreshToken, callback, clientMetadata) {\n    var _this14 = this;\n\n    var wrappedCallback = this.pool.wrapRefreshSessionCallback ? this.pool.wrapRefreshSessionCallback(callback) : callback;\n    var authParameters = {};\n    authParameters.REFRESH_TOKEN = refreshToken.getToken();\n    var keyPrefix = \"CognitoIdentityServiceProvider.\" + this.pool.getClientId();\n    var lastUserKey = keyPrefix + \".LastAuthUser\";\n\n    if (this.storage.getItem(lastUserKey)) {\n      this.username = this.storage.getItem(lastUserKey);\n      var deviceKeyKey = keyPrefix + \".\" + this.username + \".deviceKey\";\n      this.deviceKey = this.storage.getItem(deviceKeyKey);\n      authParameters.DEVICE_KEY = this.deviceKey;\n    }\n\n    var jsonReq = {\n      ClientId: this.pool.getClientId(),\n      AuthFlow: 'REFRESH_TOKEN_AUTH',\n      AuthParameters: authParameters,\n      ClientMetadata: clientMetadata\n    };\n\n    if (this.getUserContextData()) {\n      jsonReq.UserContextData = this.getUserContextData();\n    }\n\n    this.client.request('InitiateAuth', jsonReq, function (err, authResult) {\n      if (err) {\n        if (err.code === 'NotAuthorizedException') {\n          _this14.clearCachedUser();\n        }\n\n        return wrappedCallback(err, null);\n      }\n\n      if (authResult) {\n        var authenticationResult = authResult.AuthenticationResult;\n\n        if (!Object.prototype.hasOwnProperty.call(authenticationResult, 'RefreshToken')) {\n          authenticationResult.RefreshToken = refreshToken.getToken();\n        }\n\n        _this14.signInUserSession = _this14.getCognitoUserSession(authenticationResult);\n\n        _this14.cacheTokens();\n\n        return wrappedCallback(null, _this14.signInUserSession);\n      }\n\n      return undefined;\n    });\n  }\n  /**\n   * This is used to save the session tokens to local storage\n   * @returns {void}\n   */\n  ;\n\n  _proto.cacheTokens = function cacheTokens() {\n    var keyPrefix = \"CognitoIdentityServiceProvider.\" + this.pool.getClientId();\n    var idTokenKey = keyPrefix + \".\" + this.username + \".idToken\";\n    var accessTokenKey = keyPrefix + \".\" + this.username + \".accessToken\";\n    var refreshTokenKey = keyPrefix + \".\" + this.username + \".refreshToken\";\n    var clockDriftKey = keyPrefix + \".\" + this.username + \".clockDrift\";\n    var lastUserKey = keyPrefix + \".LastAuthUser\";\n    this.storage.setItem(idTokenKey, this.signInUserSession.getIdToken().getJwtToken());\n    this.storage.setItem(accessTokenKey, this.signInUserSession.getAccessToken().getJwtToken());\n    this.storage.setItem(refreshTokenKey, this.signInUserSession.getRefreshToken().getToken());\n    this.storage.setItem(clockDriftKey, \"\" + this.signInUserSession.getClockDrift());\n    this.storage.setItem(lastUserKey, this.username);\n  }\n  /**\n   * This is to cache user data\n   */\n  ;\n\n  _proto.cacheUserData = function cacheUserData(userData) {\n    this.storage.setItem(this.userDataKey, JSON.stringify(userData));\n  }\n  /**\n   * This is to remove cached user data\n   */\n  ;\n\n  _proto.clearCachedUserData = function clearCachedUserData() {\n    this.storage.removeItem(this.userDataKey);\n  };\n\n  _proto.clearCachedUser = function clearCachedUser() {\n    this.clearCachedTokens();\n    this.clearCachedUserData();\n  }\n  /**\n   * This is used to cache the device key and device group and device password\n   * @returns {void}\n   */\n  ;\n\n  _proto.cacheDeviceKeyAndPassword = function cacheDeviceKeyAndPassword() {\n    var keyPrefix = \"CognitoIdentityServiceProvider.\" + this.pool.getClientId() + \".\" + this.username;\n    var deviceKeyKey = keyPrefix + \".deviceKey\";\n    var randomPasswordKey = keyPrefix + \".randomPasswordKey\";\n    var deviceGroupKeyKey = keyPrefix + \".deviceGroupKey\";\n    this.storage.setItem(deviceKeyKey, this.deviceKey);\n    this.storage.setItem(randomPasswordKey, this.randomPassword);\n    this.storage.setItem(deviceGroupKeyKey, this.deviceGroupKey);\n  }\n  /**\n   * This is used to get current device key and device group and device password\n   * @returns {void}\n   */\n  ;\n\n  _proto.getCachedDeviceKeyAndPassword = function getCachedDeviceKeyAndPassword() {\n    var keyPrefix = \"CognitoIdentityServiceProvider.\" + this.pool.getClientId() + \".\" + this.username;\n    var deviceKeyKey = keyPrefix + \".deviceKey\";\n    var randomPasswordKey = keyPrefix + \".randomPasswordKey\";\n    var deviceGroupKeyKey = keyPrefix + \".deviceGroupKey\";\n\n    if (this.storage.getItem(deviceKeyKey)) {\n      this.deviceKey = this.storage.getItem(deviceKeyKey);\n      this.randomPassword = this.storage.getItem(randomPasswordKey);\n      this.deviceGroupKey = this.storage.getItem(deviceGroupKeyKey);\n    }\n  }\n  /**\n   * This is used to clear the device key info from local storage\n   * @returns {void}\n   */\n  ;\n\n  _proto.clearCachedDeviceKeyAndPassword = function clearCachedDeviceKeyAndPassword() {\n    var keyPrefix = \"CognitoIdentityServiceProvider.\" + this.pool.getClientId() + \".\" + this.username;\n    var deviceKeyKey = keyPrefix + \".deviceKey\";\n    var randomPasswordKey = keyPrefix + \".randomPasswordKey\";\n    var deviceGroupKeyKey = keyPrefix + \".deviceGroupKey\";\n    this.storage.removeItem(deviceKeyKey);\n    this.storage.removeItem(randomPasswordKey);\n    this.storage.removeItem(deviceGroupKeyKey);\n  }\n  /**\n   * This is used to clear the session tokens from local storage\n   * @returns {void}\n   */\n  ;\n\n  _proto.clearCachedTokens = function clearCachedTokens() {\n    var keyPrefix = \"CognitoIdentityServiceProvider.\" + this.pool.getClientId();\n    var idTokenKey = keyPrefix + \".\" + this.username + \".idToken\";\n    var accessTokenKey = keyPrefix + \".\" + this.username + \".accessToken\";\n    var refreshTokenKey = keyPrefix + \".\" + this.username + \".refreshToken\";\n    var lastUserKey = keyPrefix + \".LastAuthUser\";\n    var clockDriftKey = keyPrefix + \".\" + this.username + \".clockDrift\";\n    this.storage.removeItem(idTokenKey);\n    this.storage.removeItem(accessTokenKey);\n    this.storage.removeItem(refreshTokenKey);\n    this.storage.removeItem(lastUserKey);\n    this.storage.removeItem(clockDriftKey);\n  }\n  /**\n   * This is used to build a user session from tokens retrieved in the authentication result\n   * @param {object} authResult Successful auth response from server.\n   * @returns {CognitoUserSession} The new user session.\n   * @private\n   */\n  ;\n\n  _proto.getCognitoUserSession = function getCognitoUserSession(authResult) {\n    var idToken = new CognitoIdToken(authResult);\n    var accessToken = new CognitoAccessToken(authResult);\n    var refreshToken = new CognitoRefreshToken(authResult);\n    var sessionData = {\n      IdToken: idToken,\n      AccessToken: accessToken,\n      RefreshToken: refreshToken\n    };\n    return new CognitoUserSession(sessionData);\n  }\n  /**\n   * This is used to initiate a forgot password request\n   * @param {object} callback Result callback map.\n   * @param {onFailure} callback.onFailure Called on any error.\n   * @param {inputVerificationCode?} callback.inputVerificationCode\n   *    Optional callback raised instead of onSuccess with response data.\n   * @param {onSuccess} callback.onSuccess Called on success.\n   * @param {ClientMetadata} clientMetadata object which is passed from client to Cognito Lambda trigger\n   * @returns {void}\n   */\n  ;\n\n  _proto.forgotPassword = function forgotPassword(callback, clientMetadata) {\n    var jsonReq = {\n      ClientId: this.pool.getClientId(),\n      Username: this.username,\n      ClientMetadata: clientMetadata\n    };\n\n    if (this.getUserContextData()) {\n      jsonReq.UserContextData = this.getUserContextData();\n    }\n\n    this.client.request('ForgotPassword', jsonReq, function (err, data) {\n      if (err) {\n        return callback.onFailure(err);\n      }\n\n      if (typeof callback.inputVerificationCode === 'function') {\n        return callback.inputVerificationCode(data);\n      }\n\n      return callback.onSuccess(data);\n    });\n  }\n  /**\n   * This is used to confirm a new password using a confirmationCode\n   * @param {string} confirmationCode Code entered by user.\n   * @param {string} newPassword Confirm new password.\n   * @param {object} callback Result callback map.\n   * @param {onFailure} callback.onFailure Called on any error.\n   * @param {onSuccess<void>} callback.onSuccess Called on success.\n   * @param {ClientMetadata} clientMetadata object which is passed from client to Cognito Lambda trigger\n   * @returns {void}\n   */\n  ;\n\n  _proto.confirmPassword = function confirmPassword(confirmationCode, newPassword, callback, clientMetadata) {\n    var jsonReq = {\n      ClientId: this.pool.getClientId(),\n      Username: this.username,\n      ConfirmationCode: confirmationCode,\n      Password: newPassword,\n      ClientMetadata: clientMetadata\n    };\n\n    if (this.getUserContextData()) {\n      jsonReq.UserContextData = this.getUserContextData();\n    }\n\n    this.client.request('ConfirmForgotPassword', jsonReq, function (err) {\n      if (err) {\n        return callback.onFailure(err);\n      }\n\n      return callback.onSuccess();\n    });\n  }\n  /**\n   * This is used to initiate an attribute confirmation request\n   * @param {string} attributeName User attribute that needs confirmation.\n   * @param {object} callback Result callback map.\n   * @param {onFailure} callback.onFailure Called on any error.\n   * @param {inputVerificationCode} callback.inputVerificationCode Called on success.\n   * @param {ClientMetadata} clientMetadata object which is passed from client to Cognito Lambda trigger\n   * @returns {void}\n   */\n  ;\n\n  _proto.getAttributeVerificationCode = function getAttributeVerificationCode(attributeName, callback, clientMetadata) {\n    if (this.signInUserSession == null || !this.signInUserSession.isValid()) {\n      return callback.onFailure(new Error('User is not authenticated'));\n    }\n\n    this.client.request('GetUserAttributeVerificationCode', {\n      AttributeName: attributeName,\n      AccessToken: this.signInUserSession.getAccessToken().getJwtToken(),\n      ClientMetadata: clientMetadata\n    }, function (err, data) {\n      if (err) {\n        return callback.onFailure(err);\n      }\n\n      if (typeof callback.inputVerificationCode === 'function') {\n        return callback.inputVerificationCode(data);\n      }\n\n      return callback.onSuccess();\n    });\n    return undefined;\n  }\n  /**\n   * This is used to confirm an attribute using a confirmation code\n   * @param {string} attributeName Attribute being confirmed.\n   * @param {string} confirmationCode Code entered by user.\n   * @param {object} callback Result callback map.\n   * @param {onFailure} callback.onFailure Called on any error.\n   * @param {onSuccess<string>} callback.onSuccess Called on success.\n   * @returns {void}\n   */\n  ;\n\n  _proto.verifyAttribute = function verifyAttribute(attributeName, confirmationCode, callback) {\n    if (this.signInUserSession == null || !this.signInUserSession.isValid()) {\n      return callback.onFailure(new Error('User is not authenticated'));\n    }\n\n    this.client.request('VerifyUserAttribute', {\n      AttributeName: attributeName,\n      Code: confirmationCode,\n      AccessToken: this.signInUserSession.getAccessToken().getJwtToken()\n    }, function (err) {\n      if (err) {\n        return callback.onFailure(err);\n      }\n\n      return callback.onSuccess('SUCCESS');\n    });\n    return undefined;\n  }\n  /**\n   * This is used to get the device information using the current device key\n   * @param {object} callback Result callback map.\n   * @param {onFailure} callback.onFailure Called on any error.\n   * @param {onSuccess<*>} callback.onSuccess Called on success with device data.\n   * @returns {void}\n   */\n  ;\n\n  _proto.getDevice = function getDevice(callback) {\n    if (this.signInUserSession == null || !this.signInUserSession.isValid()) {\n      return callback.onFailure(new Error('User is not authenticated'));\n    }\n\n    this.client.request('GetDevice', {\n      AccessToken: this.signInUserSession.getAccessToken().getJwtToken(),\n      DeviceKey: this.deviceKey\n    }, function (err, data) {\n      if (err) {\n        return callback.onFailure(err);\n      }\n\n      return callback.onSuccess(data);\n    });\n    return undefined;\n  }\n  /**\n   * This is used to forget a specific device\n   * @param {string} deviceKey Device key.\n   * @param {object} callback Result callback map.\n   * @param {onFailure} callback.onFailure Called on any error.\n   * @param {onSuccess<string>} callback.onSuccess Called on success.\n   * @returns {void}\n   */\n  ;\n\n  _proto.forgetSpecificDevice = function forgetSpecificDevice(deviceKey, callback) {\n    if (this.signInUserSession == null || !this.signInUserSession.isValid()) {\n      return callback.onFailure(new Error('User is not authenticated'));\n    }\n\n    this.client.request('ForgetDevice', {\n      AccessToken: this.signInUserSession.getAccessToken().getJwtToken(),\n      DeviceKey: deviceKey\n    }, function (err) {\n      if (err) {\n        return callback.onFailure(err);\n      }\n\n      return callback.onSuccess('SUCCESS');\n    });\n    return undefined;\n  }\n  /**\n   * This is used to forget the current device\n   * @param {object} callback Result callback map.\n   * @param {onFailure} callback.onFailure Called on any error.\n   * @param {onSuccess<string>} callback.onSuccess Called on success.\n   * @returns {void}\n   */\n  ;\n\n  _proto.forgetDevice = function forgetDevice(callback) {\n    var _this15 = this;\n\n    this.forgetSpecificDevice(this.deviceKey, {\n      onFailure: callback.onFailure,\n      onSuccess: function onSuccess(result) {\n        _this15.deviceKey = null;\n        _this15.deviceGroupKey = null;\n        _this15.randomPassword = null;\n\n        _this15.clearCachedDeviceKeyAndPassword();\n\n        return callback.onSuccess(result);\n      }\n    });\n  }\n  /**\n   * This is used to set the device status as remembered\n   * @param {object} callback Result callback map.\n   * @param {onFailure} callback.onFailure Called on any error.\n   * @param {onSuccess<string>} callback.onSuccess Called on success.\n   * @returns {void}\n   */\n  ;\n\n  _proto.setDeviceStatusRemembered = function setDeviceStatusRemembered(callback) {\n    if (this.signInUserSession == null || !this.signInUserSession.isValid()) {\n      return callback.onFailure(new Error('User is not authenticated'));\n    }\n\n    this.client.request('UpdateDeviceStatus', {\n      AccessToken: this.signInUserSession.getAccessToken().getJwtToken(),\n      DeviceKey: this.deviceKey,\n      DeviceRememberedStatus: 'remembered'\n    }, function (err) {\n      if (err) {\n        return callback.onFailure(err);\n      }\n\n      return callback.onSuccess('SUCCESS');\n    });\n    return undefined;\n  }\n  /**\n   * This is used to set the device status as not remembered\n   * @param {object} callback Result callback map.\n   * @param {onFailure} callback.onFailure Called on any error.\n   * @param {onSuccess<string>} callback.onSuccess Called on success.\n   * @returns {void}\n   */\n  ;\n\n  _proto.setDeviceStatusNotRemembered = function setDeviceStatusNotRemembered(callback) {\n    if (this.signInUserSession == null || !this.signInUserSession.isValid()) {\n      return callback.onFailure(new Error('User is not authenticated'));\n    }\n\n    this.client.request('UpdateDeviceStatus', {\n      AccessToken: this.signInUserSession.getAccessToken().getJwtToken(),\n      DeviceKey: this.deviceKey,\n      DeviceRememberedStatus: 'not_remembered'\n    }, function (err) {\n      if (err) {\n        return callback.onFailure(err);\n      }\n\n      return callback.onSuccess('SUCCESS');\n    });\n    return undefined;\n  }\n  /**\n   * This is used to list all devices for a user\n   *\n   * @param {int} limit the number of devices returned in a call\n   * @param {string | null} paginationToken the pagination token in case any was returned before\n   * @param {object} callback Result callback map.\n   * @param {onFailure} callback.onFailure Called on any error.\n   * @param {onSuccess<*>} callback.onSuccess Called on success with device list.\n   * @returns {void}\n   */\n  ;\n\n  _proto.listDevices = function listDevices(limit, paginationToken, callback) {\n    if (this.signInUserSession == null || !this.signInUserSession.isValid()) {\n      return callback.onFailure(new Error('User is not authenticated'));\n    }\n\n    var requestParams = {\n      AccessToken: this.signInUserSession.getAccessToken().getJwtToken(),\n      Limit: limit\n    };\n\n    if (paginationToken) {\n      requestParams.PaginationToken = paginationToken;\n    }\n\n    this.client.request('ListDevices', requestParams, function (err, data) {\n      if (err) {\n        return callback.onFailure(err);\n      }\n\n      return callback.onSuccess(data);\n    });\n    return undefined;\n  }\n  /**\n   * This is used to globally revoke all tokens issued to a user\n   * @param {object} callback Result callback map.\n   * @param {onFailure} callback.onFailure Called on any error.\n   * @param {onSuccess<string>} callback.onSuccess Called on success.\n   * @returns {void}\n   */\n  ;\n\n  _proto.globalSignOut = function globalSignOut(callback) {\n    var _this16 = this;\n\n    if (this.signInUserSession == null || !this.signInUserSession.isValid()) {\n      return callback.onFailure(new Error('User is not authenticated'));\n    }\n\n    this.client.request('GlobalSignOut', {\n      AccessToken: this.signInUserSession.getAccessToken().getJwtToken()\n    }, function (err) {\n      if (err) {\n        return callback.onFailure(err);\n      }\n\n      _this16.clearCachedUser();\n\n      return callback.onSuccess('SUCCESS');\n    });\n    return undefined;\n  }\n  /**\n   * This is used for the user to signOut of the application and clear the cached tokens.\n   * @returns {void}\n   */\n  ;\n\n  _proto.signOut = function signOut() {\n    this.signInUserSession = null;\n    this.clearCachedUser();\n  }\n  /**\n   * This is used by a user trying to select a given MFA\n   * @param {string} answerChallenge the mfa the user wants\n   * @param {nodeCallback<string>} callback Called on success or error.\n   * @returns {void}\n   */\n  ;\n\n  _proto.sendMFASelectionAnswer = function sendMFASelectionAnswer(answerChallenge, callback) {\n    var _this17 = this;\n\n    var challengeResponses = {};\n    challengeResponses.USERNAME = this.username;\n    challengeResponses.ANSWER = answerChallenge;\n    var jsonReq = {\n      ChallengeName: 'SELECT_MFA_TYPE',\n      ChallengeResponses: challengeResponses,\n      ClientId: this.pool.getClientId(),\n      Session: this.Session\n    };\n\n    if (this.getUserContextData()) {\n      jsonReq.UserContextData = this.getUserContextData();\n    }\n\n    this.client.request('RespondToAuthChallenge', jsonReq, function (err, data) {\n      if (err) {\n        return callback.onFailure(err);\n      }\n\n      _this17.Session = data.Session;\n\n      if (answerChallenge === 'SMS_MFA') {\n        return callback.mfaRequired(data.ChallengeName, data.ChallengeParameters);\n      }\n\n      if (answerChallenge === 'SOFTWARE_TOKEN_MFA') {\n        return callback.totpRequired(data.ChallengeName, data.ChallengeParameters);\n      }\n\n      return undefined;\n    });\n  }\n  /**\n   * This returns the user context data for advanced security feature.\n   * @returns {void}\n   */\n  ;\n\n  _proto.getUserContextData = function getUserContextData() {\n    var pool = this.pool;\n    return pool.getUserContextData(this.username);\n  }\n  /**\n   * This is used by an authenticated or a user trying to authenticate to associate a TOTP MFA\n   * @param {nodeCallback<string>} callback Called on success or error.\n   * @returns {void}\n   */\n  ;\n\n  _proto.associateSoftwareToken = function associateSoftwareToken(callback) {\n    var _this18 = this;\n\n    if (!(this.signInUserSession != null && this.signInUserSession.isValid())) {\n      this.client.request('AssociateSoftwareToken', {\n        Session: this.Session\n      }, function (err, data) {\n        if (err) {\n          return callback.onFailure(err);\n        }\n\n        _this18.Session = data.Session;\n        return callback.associateSecretCode(data.SecretCode);\n      });\n    } else {\n      this.client.request('AssociateSoftwareToken', {\n        AccessToken: this.signInUserSession.getAccessToken().getJwtToken()\n      }, function (err, data) {\n        if (err) {\n          return callback.onFailure(err);\n        }\n\n        return callback.associateSecretCode(data.SecretCode);\n      });\n    }\n  }\n  /**\n   * This is used by an authenticated or a user trying to authenticate to verify a TOTP MFA\n   * @param {string} totpCode The MFA code entered by the user.\n   * @param {string} friendlyDeviceName The device name we are assigning to the device.\n   * @param {nodeCallback<string>} callback Called on success or error.\n   * @returns {void}\n   */\n  ;\n\n  _proto.verifySoftwareToken = function verifySoftwareToken(totpCode, friendlyDeviceName, callback) {\n    var _this19 = this;\n\n    if (!(this.signInUserSession != null && this.signInUserSession.isValid())) {\n      this.client.request('VerifySoftwareToken', {\n        Session: this.Session,\n        UserCode: totpCode,\n        FriendlyDeviceName: friendlyDeviceName\n      }, function (err, data) {\n        if (err) {\n          return callback.onFailure(err);\n        }\n\n        _this19.Session = data.Session;\n        var challengeResponses = {};\n        challengeResponses.USERNAME = _this19.username;\n        var jsonReq = {\n          ChallengeName: 'MFA_SETUP',\n          ClientId: _this19.pool.getClientId(),\n          ChallengeResponses: challengeResponses,\n          Session: _this19.Session\n        };\n\n        if (_this19.getUserContextData()) {\n          jsonReq.UserContextData = _this19.getUserContextData();\n        }\n\n        _this19.client.request('RespondToAuthChallenge', jsonReq, function (errRespond, dataRespond) {\n          if (errRespond) {\n            return callback.onFailure(errRespond);\n          }\n\n          _this19.signInUserSession = _this19.getCognitoUserSession(dataRespond.AuthenticationResult);\n\n          _this19.cacheTokens();\n\n          return callback.onSuccess(_this19.signInUserSession);\n        });\n\n        return undefined;\n      });\n    } else {\n      this.client.request('VerifySoftwareToken', {\n        AccessToken: this.signInUserSession.getAccessToken().getJwtToken(),\n        UserCode: totpCode,\n        FriendlyDeviceName: friendlyDeviceName\n      }, function (err, data) {\n        if (err) {\n          return callback.onFailure(err);\n        }\n\n        return callback.onSuccess(data);\n      });\n    }\n  };\n\n  return CognitoUser;\n}();\n\nexport { CognitoUser as default };","// constructor\nfunction UserAgent() {} // public\n\n\nUserAgent.prototype.userAgent = 'aws-amplify/0.1.x js';\nexport var appendToCognitoUserAgent = function appendToCognitoUserAgent(content) {\n  if (!content) {\n    return;\n  }\n\n  if (UserAgent.prototype.userAgent && !UserAgent.prototype.userAgent.includes(content)) {\n    UserAgent.prototype.userAgent = UserAgent.prototype.userAgent.concat(' ', content);\n  }\n\n  if (!UserAgent.prototype.userAgent || UserAgent.prototype.userAgent === '') {\n    UserAgent.prototype.userAgent = content;\n  }\n}; // class for defining the amzn user-agent\n\nexport default UserAgent;","function _inheritsLoose(subClass, superClass) {\n  subClass.prototype = Object.create(superClass.prototype);\n  subClass.prototype.constructor = subClass;\n  subClass.__proto__ = superClass;\n}\n\nfunction _wrapNativeSuper(Class) {\n  var _cache = typeof Map === \"function\" ? new Map() : undefined;\n\n  _wrapNativeSuper = function _wrapNativeSuper(Class) {\n    if (Class === null || !_isNativeFunction(Class)) return Class;\n\n    if (typeof Class !== \"function\") {\n      throw new TypeError(\"Super expression must either be null or a function\");\n    }\n\n    if (typeof _cache !== \"undefined\") {\n      if (_cache.has(Class)) return _cache.get(Class);\n\n      _cache.set(Class, Wrapper);\n    }\n\n    function Wrapper() {\n      return _construct(Class, arguments, _getPrototypeOf(this).constructor);\n    }\n\n    Wrapper.prototype = Object.create(Class.prototype, {\n      constructor: {\n        value: Wrapper,\n        enumerable: false,\n        writable: true,\n        configurable: true\n      }\n    });\n    return _setPrototypeOf(Wrapper, Class);\n  };\n\n  return _wrapNativeSuper(Class);\n}\n\nfunction _construct(Parent, args, Class) {\n  if (_isNativeReflectConstruct()) {\n    _construct = Reflect.construct;\n  } else {\n    _construct = function _construct(Parent, args, Class) {\n      var a = [null];\n      a.push.apply(a, args);\n      var Constructor = Function.bind.apply(Parent, a);\n      var instance = new Constructor();\n      if (Class) _setPrototypeOf(instance, Class.prototype);\n      return instance;\n    };\n  }\n\n  return _construct.apply(null, arguments);\n}\n\nfunction _isNativeReflectConstruct() {\n  if (typeof Reflect === \"undefined\" || !Reflect.construct) return false;\n  if (Reflect.construct.sham) return false;\n  if (typeof Proxy === \"function\") return true;\n\n  try {\n    Date.prototype.toString.call(Reflect.construct(Date, [], function () {}));\n    return true;\n  } catch (e) {\n    return false;\n  }\n}\n\nfunction _isNativeFunction(fn) {\n  return Function.toString.call(fn).indexOf(\"[native code]\") !== -1;\n}\n\nfunction _setPrototypeOf(o, p) {\n  _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) {\n    o.__proto__ = p;\n    return o;\n  };\n\n  return _setPrototypeOf(o, p);\n}\n\nfunction _getPrototypeOf(o) {\n  _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) {\n    return o.__proto__ || Object.getPrototypeOf(o);\n  };\n  return _getPrototypeOf(o);\n}\n\nimport 'isomorphic-unfetch';\nimport UserAgent from './UserAgent';\n\nvar CognitoError = /*#__PURE__*/function (_Error) {\n  _inheritsLoose(CognitoError, _Error);\n\n  function CognitoError(message, code, name, statusCode) {\n    var _this;\n\n    _this = _Error.call(this, message) || this;\n    _this.code = code;\n    _this.name = name;\n    _this.statusCode = statusCode;\n    return _this;\n  }\n\n  return CognitoError;\n}( /*#__PURE__*/_wrapNativeSuper(Error));\n/** @class */\n\n\nvar Client = /*#__PURE__*/function () {\n  /**\n   * Constructs a new AWS Cognito Identity Provider client object\n   * @param {string} region AWS region\n   * @param {string} endpoint endpoint\n   * @param {object} fetchOptions options for fetch API (only credentials is supported)\n   */\n  function Client(region, endpoint, fetchOptions) {\n    this.endpoint = endpoint || \"https://cognito-idp.\" + region + \".amazonaws.com/\";\n\n    var _ref = fetchOptions || {},\n        credentials = _ref.credentials;\n\n    this.fetchOptions = credentials ? {\n      credentials: credentials\n    } : {};\n  }\n  /**\n   * Makes an unauthenticated request on AWS Cognito Identity Provider API\n   * using fetch\n   * @param {string} operation API operation\n   * @param {object} params Input parameters\n   * @returns Promise<object>\n   */\n\n\n  var _proto = Client.prototype;\n\n  _proto.promisifyRequest = function promisifyRequest(operation, params) {\n    var _this2 = this;\n\n    return new Promise(function (resolve, reject) {\n      _this2.request(operation, params, function (err, data) {\n        if (err) {\n          reject(new CognitoError(err.message, err.code, err.name, err.statusCode));\n        } else {\n          resolve(data);\n        }\n      });\n    });\n  }\n  /**\n   * Makes an unauthenticated request on AWS Cognito Identity Provider API\n   * using fetch\n   * @param {string} operation API operation\n   * @param {object} params Input parameters\n   * @param {function} callback Callback called when a response is returned\n   * @returns {void}\n   */\n  ;\n\n  _proto.request = function request(operation, params, callback) {\n    var headers = {\n      'Content-Type': 'application/x-amz-json-1.1',\n      'X-Amz-Target': \"AWSCognitoIdentityProviderService.\" + operation,\n      'X-Amz-User-Agent': UserAgent.prototype.userAgent\n    };\n    var options = Object.assign({}, this.fetchOptions, {\n      headers: headers,\n      method: 'POST',\n      mode: 'cors',\n      cache: 'no-cache',\n      body: JSON.stringify(params)\n    });\n    var response;\n    var responseJsonData;\n    fetch(this.endpoint, options).then(function (resp) {\n      response = resp;\n      return resp;\n    }, function (err) {\n      // If error happens here, the request failed\n      // if it is TypeError throw network error\n      if (err instanceof TypeError) {\n        throw new Error('Network error');\n      }\n\n      throw err;\n    }).then(function (resp) {\n      return resp.json()[\"catch\"](function () {\n        return {};\n      });\n    }).then(function (data) {\n      // return parsed body stream\n      if (response.ok) return callback(null, data);\n      responseJsonData = data; // Taken from aws-sdk-js/lib/protocol/json.js\n      // eslint-disable-next-line no-underscore-dangle\n\n      var code = (data.__type || data.code).split('#').pop();\n      var error = {\n        code: code,\n        name: code,\n        message: data.message || data.Message || null\n      };\n      return callback(error);\n    })[\"catch\"](function (err) {\n      // first check if we have a service error\n      if (response && response.headers && response.headers.get('x-amzn-errortype')) {\n        try {\n          var code = response.headers.get('x-amzn-errortype').split(':')[0];\n          var error = {\n            code: code,\n            name: code,\n            statusCode: response.status,\n            message: response.status ? response.status.toString() : null\n          };\n          return callback(error);\n        } catch (ex) {\n          return callback(err);\n        } // otherwise check if error is Network error\n\n      } else if (err instanceof Error && err.message === 'Network error') {\n        var _error = {\n          code: 'NetworkError',\n          name: err.name,\n          message: err.message\n        };\n        return callback(_error);\n      } else {\n        return callback(err);\n      }\n    });\n  };\n\n  return Client;\n}();\n\nexport { Client as default };","/*!\n * Copyright 2016 Amazon.com,\n * Inc. or its affiliates. All Rights Reserved.\n *\n * Licensed under the Amazon Software License (the \"License\").\n * You may not use this file except in compliance with the\n * License. A copy of the License is located at\n *\n *     http://aws.amazon.com/asl/\n *\n * or in the \"license\" file accompanying this file. This file is\n * distributed on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR\n * CONDITIONS OF ANY KIND, express or implied. See the License\n * for the specific language governing permissions and\n * limitations under the License.\n */\nimport Client from './Client';\nimport CognitoUser from './CognitoUser';\nimport StorageHelper from './StorageHelper';\n/** @class */\n\nvar CognitoUserPool = /*#__PURE__*/function () {\n  /**\n   * Constructs a new CognitoUserPool object\n   * @param {object} data Creation options.\n   * @param {string} data.UserPoolId Cognito user pool id.\n   * @param {string} data.ClientId User pool application client id.\n   * @param {string} data.endpoint Optional custom service endpoint.\n   * @param {object} data.fetchOptions Optional options for fetch API.\n   *        (only credentials option is supported)\n   * @param {object} data.Storage Optional storage object.\n   * @param {boolean} data.AdvancedSecurityDataCollectionFlag Optional:\n   *        boolean flag indicating if the data collection is enabled\n   *        to support cognito advanced security features. By default, this\n   *        flag is set to true.\n   */\n  function CognitoUserPool(data, wrapRefreshSessionCallback) {\n    var _ref = data || {},\n        UserPoolId = _ref.UserPoolId,\n        ClientId = _ref.ClientId,\n        endpoint = _ref.endpoint,\n        fetchOptions = _ref.fetchOptions,\n        AdvancedSecurityDataCollectionFlag = _ref.AdvancedSecurityDataCollectionFlag;\n\n    if (!UserPoolId || !ClientId) {\n      throw new Error('Both UserPoolId and ClientId are required.');\n    }\n\n    if (!/^[\\w-]+_.+$/.test(UserPoolId)) {\n      throw new Error('Invalid UserPoolId format.');\n    }\n\n    var region = UserPoolId.split('_')[0];\n    this.userPoolId = UserPoolId;\n    this.clientId = ClientId;\n    this.client = new Client(region, endpoint, fetchOptions);\n    /**\n     * By default, AdvancedSecurityDataCollectionFlag is set to true,\n     * if no input value is provided.\n     */\n\n    this.advancedSecurityDataCollectionFlag = AdvancedSecurityDataCollectionFlag !== false;\n    this.storage = data.Storage || new StorageHelper().getStorage();\n\n    if (wrapRefreshSessionCallback) {\n      this.wrapRefreshSessionCallback = wrapRefreshSessionCallback;\n    }\n  }\n  /**\n   * @returns {string} the user pool id\n   */\n\n\n  var _proto = CognitoUserPool.prototype;\n\n  _proto.getUserPoolId = function getUserPoolId() {\n    return this.userPoolId;\n  }\n  /**\n   * @returns {string} the client id\n   */\n  ;\n\n  _proto.getClientId = function getClientId() {\n    return this.clientId;\n  }\n  /**\n   * @typedef {object} SignUpResult\n   * @property {CognitoUser} user New user.\n   * @property {bool} userConfirmed If the user is already confirmed.\n   */\n\n  /**\n   * method for signing up a user\n   * @param {string} username User's username.\n   * @param {string} password Plain-text initial password entered by user.\n   * @param {(AttributeArg[])=} userAttributes New user attributes.\n   * @param {(AttributeArg[])=} validationData Application metadata.\n   * @param {(AttributeArg[])=} clientMetadata Client metadata.\n   * @param {nodeCallback<SignUpResult>} callback Called on error or with the new user.\n   * @param {ClientMetadata} clientMetadata object which is passed from client to Cognito Lambda trigger\n   * @returns {void}\n   */\n  ;\n\n  _proto.signUp = function signUp(username, password, userAttributes, validationData, callback, clientMetadata) {\n    var _this = this;\n\n    var jsonReq = {\n      ClientId: this.clientId,\n      Username: username,\n      Password: password,\n      UserAttributes: userAttributes,\n      ValidationData: validationData,\n      ClientMetadata: clientMetadata\n    };\n\n    if (this.getUserContextData(username)) {\n      jsonReq.UserContextData = this.getUserContextData(username);\n    }\n\n    this.client.request('SignUp', jsonReq, function (err, data) {\n      if (err) {\n        return callback(err, null);\n      }\n\n      var cognitoUser = {\n        Username: username,\n        Pool: _this,\n        Storage: _this.storage\n      };\n      var returnData = {\n        user: new CognitoUser(cognitoUser),\n        userConfirmed: data.UserConfirmed,\n        userSub: data.UserSub,\n        codeDeliveryDetails: data.CodeDeliveryDetails\n      };\n      return callback(null, returnData);\n    });\n  }\n  /**\n   * method for getting the current user of the application from the local storage\n   *\n   * @returns {CognitoUser} the user retrieved from storage\n   */\n  ;\n\n  _proto.getCurrentUser = function getCurrentUser() {\n    var lastUserKey = \"CognitoIdentityServiceProvider.\" + this.clientId + \".LastAuthUser\";\n    var lastAuthUser = this.storage.getItem(lastUserKey);\n\n    if (lastAuthUser) {\n      var cognitoUser = {\n        Username: lastAuthUser,\n        Pool: this,\n        Storage: this.storage\n      };\n      return new CognitoUser(cognitoUser);\n    }\n\n    return null;\n  }\n  /**\n   * This method returns the encoded data string used for cognito advanced security feature.\n   * This would be generated only when developer has included the JS used for collecting the\n   * data on their client. Please refer to documentation to know more about using AdvancedSecurity\n   * features\n   * @param {string} username the username for the context data\n   * @returns {string} the user context data\n   **/\n  ;\n\n  _proto.getUserContextData = function getUserContextData(username) {\n    if (typeof AmazonCognitoAdvancedSecurityData === 'undefined') {\n      return undefined;\n    }\n    /* eslint-disable */\n\n\n    var amazonCognitoAdvancedSecurityDataConst = AmazonCognitoAdvancedSecurityData;\n    /* eslint-enable */\n\n    if (this.advancedSecurityDataCollectionFlag) {\n      var advancedSecurityData = amazonCognitoAdvancedSecurityDataConst.getData(username, this.userPoolId, this.clientId);\n\n      if (advancedSecurityData) {\n        var userContextData = {\n          EncodedData: advancedSecurityData\n        };\n        return userContextData;\n      }\n    }\n\n    return {};\n  };\n\n  return CognitoUserPool;\n}();\n\nexport { CognitoUserPool as default };","import * as Cookies from 'js-cookie';\n/** @class */\n\nvar CookieStorage = /*#__PURE__*/function () {\n  /**\n   * Constructs a new CookieStorage object\n   * @param {object} data Creation options.\n   * @param {string} data.domain Cookies domain (mandatory).\n   * @param {string} data.path Cookies path (default: '/')\n   * @param {integer} data.expires Cookie expiration (in days, default: 365)\n   * @param {boolean} data.secure Cookie secure flag (default: true)\n   * @param {string} data.sameSite Cookie request behaviour (default: null)\n   */\n  function CookieStorage(data) {\n    if (data.domain) {\n      this.domain = data.domain;\n    } else {\n      throw new Error('The domain of cookieStorage can not be undefined.');\n    }\n\n    if (data.path) {\n      this.path = data.path;\n    } else {\n      this.path = '/';\n    }\n\n    if (Object.prototype.hasOwnProperty.call(data, 'expires')) {\n      this.expires = data.expires;\n    } else {\n      this.expires = 365;\n    }\n\n    if (Object.prototype.hasOwnProperty.call(data, 'secure')) {\n      this.secure = data.secure;\n    } else {\n      this.secure = true;\n    }\n\n    if (Object.prototype.hasOwnProperty.call(data, 'sameSite')) {\n      if (!['strict', 'lax', 'none'].includes(data.sameSite)) {\n        throw new Error('The sameSite value of cookieStorage must be \"lax\", \"strict\" or \"none\".');\n      }\n\n      if (data.sameSite === 'none' && !this.secure) {\n        throw new Error('sameSite = None requires the Secure attribute in latest browser versions.');\n      }\n\n      this.sameSite = data.sameSite;\n    } else {\n      this.sameSite = null;\n    }\n  }\n  /**\n   * This is used to set a specific item in storage\n   * @param {string} key - the key for the item\n   * @param {object} value - the value\n   * @returns {string} value that was set\n   */\n\n\n  var _proto = CookieStorage.prototype;\n\n  _proto.setItem = function setItem(key, value) {\n    var options = {\n      path: this.path,\n      expires: this.expires,\n      domain: this.domain,\n      secure: this.secure\n    };\n\n    if (this.sameSite) {\n      options.sameSite = this.sameSite;\n    }\n\n    Cookies.set(key, value, options);\n    return Cookies.get(key);\n  }\n  /**\n   * This is used to get a specific key from storage\n   * @param {string} key - the key for the item\n   * This is used to clear the storage\n   * @returns {string} the data item\n   */\n  ;\n\n  _proto.getItem = function getItem(key) {\n    return Cookies.get(key);\n  }\n  /**\n   * This is used to remove an item from storage\n   * @param {string} key - the key being set\n   * @returns {string} value - value that was deleted\n   */\n  ;\n\n  _proto.removeItem = function removeItem(key) {\n    var options = {\n      path: this.path,\n      expires: this.expires,\n      domain: this.domain,\n      secure: this.secure\n    };\n\n    if (this.sameSite) {\n      options.sameSite = this.sameSite;\n    }\n\n    return Cookies.remove(key, options);\n  }\n  /**\n   * This is used to clear the storage\n   * @returns {string} nothing\n   */\n  ;\n\n  _proto.clear = function clear() {\n    var cookies = Cookies.get();\n    var index;\n\n    for (index = 0; index < cookies.length; ++index) {\n      Cookies.remove(cookies[index]);\n    }\n\n    return {};\n  };\n\n  return CookieStorage;\n}();\n\nexport { CookieStorage as default };"],"sourceRoot":""}